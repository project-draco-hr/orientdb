{
  if (p.getType() instanceof Class<?>) {
    final Type genericType=p.getGenericType();
    if (genericType != null && genericType instanceof ParameterizedType) {
      final ParameterizedType pt=(ParameterizedType)genericType;
      if (pt.getActualTypeArguments() != null && pt.getActualTypeArguments().length > 0) {
        if (((Class<?>)pt.getRawType()).isAssignableFrom(Map.class)) {
          if (pt.getActualTypeArguments()[1] instanceof Class<?>)           return (Class<?>)pt.getActualTypeArguments()[1];
        }
 else         if (pt.getActualTypeArguments()[0] instanceof Class<?>)         return (Class<?>)pt.getActualTypeArguments()[0];
      }
    }
  }
  return null;
}
