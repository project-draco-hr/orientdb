{
  NavigableMap<PagedKey,PageGroup> subMap=writePages.tailMap(lastPageKey,false);
  if (!subMap.isEmpty()) {
    flushedPages=iterateBySubRing(subMap,writePagesToFlush,0,forceFlush);
    if (flushedPages < writePagesToFlush) {
      if (!subMap.isEmpty()) {
        subMap=writePages.headMap(subMap.firstKey(),false);
        flushedPages=iterateBySubRing(subMap,writePagesToFlush,flushedPages,forceFlush);
      }
    }
  }
 else   flushedPages=iterateBySubRing(writePages,writePagesToFlush,flushedPages,forceFlush);
  return flushedPages;
}
