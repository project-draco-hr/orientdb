{
  acquireExclusiveLock();
  try {
    if (!active)     return;
    OLogManager.instance().debug(this,"Orient Engine is shutting down...");
    ODatabaseFactory.shutdown();
    final List<OStorage> storagesCopy=new ArrayList<OStorage>(storages.values());
    for (    OStorage stg : storagesCopy) {
      OLogManager.instance().debug(this,"Shutting down storage: " + stg.getName() + "...");
      stg.close(true);
    }
    OMMapManager.shutdown();
    active=false;
    threadGroup.interrupt();
    listeners.clear();
    OLogManager.instance().debug(this,"Orient Engine shutdown complete");
  }
  finally {
    releaseExclusiveLock();
  }
}
