{
  if (iParent != parent) {
    OMVRBTreeEntryPersistent<K,V> newParent=(OMVRBTreeEntryPersistent<K,V>)iParent;
    ORID newParentId=iParent == null ? ORecordId.EMPTY_RECORD_ID : newParent.dataEntry.getIdentity();
    parent=newParent;
    if (dataEntry.setParent(newParentId))     markDirty();
    if (parent != null) {
      ORID thisRid=dataEntry.getIdentity();
      if (parent.left == this && !parent.dataEntry.getLeft().equals(thisRid))       if (parent.dataEntry.setLeft(thisRid))       parent.markDirty();
      if (parent.left != this && parent.dataEntry.getLeft().isValid() && parent.dataEntry.getLeft().equals(thisRid))       parent.left=this;
      if (parent.right == this && !parent.dataEntry.getRight().equals(thisRid))       if (parent.dataEntry.setRight(thisRid))       parent.markDirty();
      if (parent.right != this && parent.dataEntry.getRight().isValid() && parent.dataEntry.getRight().equals(thisRid))       parent.right=this;
    }
  }
  return iParent;
}
