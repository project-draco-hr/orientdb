{
  if (iSize > BYTEBUFFER_POOLABLE_SIZE) {
    try {
      OProfiler.getInstance().updateStat("MMap.extraBufferSize",iSize);
      return ByteBuffer.allocate(iSize);
    }
 catch (    OutOfMemoryError e) {
      OLogManager.instance().error(this,"Error on allocating direct buffer of size %d bytes",e,iSize);
      throw e;
    }
  }
  ByteBuffer buffer=bufferPool.poll();
  if (buffer != null)   OProfiler.getInstance().updateCounter("system.file.mmap.pooledBuffers",-1);
 else {
    buffer=ByteBuffer.allocateDirect(BYTEBUFFER_POOLABLE_SIZE);
    OProfiler.getInstance().updateStat("system.file.mmap.pooledBufferSize",BYTEBUFFER_POOLABLE_SIZE);
  }
  buffer.limit(iSize);
  return buffer;
}
