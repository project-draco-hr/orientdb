{
  int entryPosition=getIntValue(POSITIONS_ARRAY_OFFSET + entryIndex * OIntegerSerializer.INT_SIZE);
  int entrySize=keySerializer.getObjectSizeInDirectMemory(directMemory,pagePointer + entryPosition);
  if (isLeaf) {
    if (valueSerializer.isFixedLength())     entrySize+=valueSerializer.getFixedLength();
 else     entrySize+=valueSerializer.getObjectSizeInDirectMemory(directMemory,pagePointer + entryPosition + entrySize);
  }
 else {
    throw new IllegalStateException("Remove is applies to leaf buckets only");
  }
  int size=size();
  if (entryIndex < size - 1) {
    copyData(POSITIONS_ARRAY_OFFSET + (entryIndex + 1) * OIntegerSerializer.INT_SIZE,POSITIONS_ARRAY_OFFSET + entryIndex * OIntegerSerializer.INT_SIZE,(size - entryIndex - 1) * OIntegerSerializer.INT_SIZE);
  }
  size--;
  setIntValue(SIZE_OFFSET,size);
  if (size > 0) {
    int freePointer=getIntValue(FREE_POINTER_OFFSET);
    if (entryPosition > freePointer) {
      copyData(freePointer,freePointer + entrySize,entryPosition - freePointer);
    }
    setIntValue(FREE_POINTER_OFFSET,freePointer + entrySize);
  }
  int currentPositionOffset=POSITIONS_ARRAY_OFFSET;
  for (int i=0; i < size; i++) {
    int currentEntryPosition=getIntValue(currentPositionOffset);
    if (currentEntryPosition < entryPosition)     setIntValue(currentPositionOffset,currentEntryPosition + entrySize);
    currentPositionOffset+=OIntegerSerializer.INT_SIZE;
  }
}
