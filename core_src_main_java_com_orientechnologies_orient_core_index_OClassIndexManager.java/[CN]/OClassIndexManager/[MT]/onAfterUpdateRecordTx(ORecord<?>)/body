{
  if (!(iRecord instanceof ODocument))   return;
  ODocument doc=(ODocument)iRecord;
  doc=checkForLoading(doc);
  final OClass cls=doc.getSchemaClass();
  if (cls == null)   return;
  final Collection<OIndex<?>> indexes=cls.getIndexes();
  if (!indexes.isEmpty()) {
    final Set<String> dirtyFields=new HashSet<String>(Arrays.asList(doc.getDirtyFields()));
    if (!dirtyFields.isEmpty()) {
      for (      final OIndex<?> index : indexes) {
        if (index.getDefinition() instanceof OCompositeIndexDefinition)         processCompositeIndexUpdate(index,dirtyFields,doc);
 else         processSingleIndexUpdate(index,dirtyFields,doc);
      }
    }
  }
  if (doc.isTrackingChanges()) {
    doc.setTrackingChanges(false);
    doc.setTrackingChanges(true);
  }
}
