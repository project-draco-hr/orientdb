{
  final long timer=OProfiler.getInstance().startChrono();
  lock.acquireExclusiveLock();
  try {
    lockManager.acquireLock(Thread.currentThread(),iRid,LOCK.EXCLUSIVE);
    try {
      final OPhysicalPosition ppos=iClusterSegment.getPhysicalPosition(new OPhysicalPosition(iRid.clusterPosition));
      if (!checkForRecordValidity(ppos))       return null;
      if (iVersion > -1 && ppos.recordVersion != iVersion)       throw new OConcurrentModificationException("Cannot delete the record " + iRid + " in storage '"+ name+ "' because the version is not the latest. Probably you are deleting an old record or it has been modified by another user (db=v"+ ppos.recordVersion+ " your=v"+ iVersion+ ")",iRid,ppos.recordVersion,iVersion);
      if (ppos.dataSegmentPos > -1)       getDataSegmentById(ppos.dataSegmentId).deleteRecord(ppos.dataSegmentPos);
      iClusterSegment.removePhysicalPosition(iRid.clusterPosition);
      return ppos;
    }
  finally {
      lockManager.releaseLock(Thread.currentThread(),iRid,LOCK.EXCLUSIVE);
    }
  }
 catch (  IOException e) {
    OLogManager.instance().error(this,"Error on deleting record " + iRid + "( cluster: "+ iClusterSegment+ ")",e);
  }
 finally {
    lock.releaseExclusiveLock();
    OProfiler.getInstance().stopChrono(PROFILER_DELETE_RECORD,timer);
  }
  return null;
}
