{
  setDataCommandInfo("Add cluster");
  checkDatabase();
  final String type=channel.readString();
  final String name=channel.readString();
  final String location;
  if (connection.data.protocolVersion >= 10 || type.equalsIgnoreCase("PHYSICAL"))   location=channel.readString();
 else   location=null;
  final int dataSegmentId;
  if (connection.data.protocolVersion >= 10)   dataSegmentId=channel.readInt();
 else {
    channel.readInt();
    dataSegmentId=0;
  }
  Object[] params=null;
  final int num=connection.database.addCluster(type,name,location,dataSegmentId,params);
  beginResponse();
  try {
    sendOk(clientTxId);
    channel.writeShort((short)num);
  }
  finally {
    endResponse();
  }
}
