{
  final LinkedList<Long> result=new LinkedList<Long>();
  long[] localOperationId=getLastOperationId();
  lock.acquireExclusiveLock();
  try {
    long fileOffset=file.getFilledUpTo();
    while ((localOperationId[0] > iRemoteLastOperationId[0]) || (localOperationId[0] == iRemoteLastOperationId[0] && localOperationId[1] > iRemoteLastOperationId[1])) {
      result.add(fileOffset);
      final long prevOffset=getPreviousOperation(fileOffset);
      localOperationId=getOperationId(prevOffset);
      fileOffset=prevOffset;
    }
    return result.descendingIterator();
  }
  finally {
    lock.releaseExclusiveLock();
  }
}
