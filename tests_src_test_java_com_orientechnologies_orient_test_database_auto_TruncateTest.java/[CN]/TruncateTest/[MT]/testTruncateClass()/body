{
  OSchema schema=database.getMetadata().getSchema();
  OClass testClass;
  if (schema.existsClass("test_class")) {
    testClass=schema.getClass("test_class");
  }
 else {
    testClass=schema.createClass("test_class");
  }
  database.command(new OCommandSQL("truncate class test_class")).execute();
  database.save(new ODocument(testClass).field("name","x").field("data",Arrays.asList(1,2)));
  database.save(new ODocument(testClass).field("name","y").field("data",Arrays.asList(3,1)));
  database.command(new OCommandSQL("truncate class test_class")).execute();
  database.save(new ODocument(testClass).field("name","x").field("data",Arrays.asList(5,6,7)));
  database.save(new ODocument(testClass).field("name","y").field("data",Arrays.asList(8,9,0)));
  List<ODocument> result=database.query(new OSQLSynchQuery<ODocument>("select from test_class"));
  Assert.assertEquals(result.size(),2);
  Set<Integer> set=new HashSet<Integer>();
  for (  ODocument document : result) {
    set.addAll((Collection<Integer>)document.field("data"));
  }
  Assert.assertTrue(set.containsAll(Arrays.asList(5,6,7,8,9,0)));
  schema.dropClass("test_class");
}
