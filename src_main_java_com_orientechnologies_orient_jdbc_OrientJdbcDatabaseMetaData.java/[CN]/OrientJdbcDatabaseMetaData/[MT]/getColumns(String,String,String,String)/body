{
  final List<ODocument> records=new ArrayList<ODocument>();
  final OClass clazz=database.getMetadata().getSchema().getClass(tableNamePattern);
  if (clazz != null) {
    final Map<String,OProperty> propertiesMap=clazz.propertiesMap();
    for (    OProperty prop : propertiesMap.values()) {
      if (columnNamePattern == null || columnNamePattern.equals("%") || columnNamePattern.equalsIgnoreCase(prop.getName())) {
        records.add((ODocument)new ODocument().field("TABLE_CAT",database.getName()).field("TABLE_NAME",clazz.getName()).field("COLUMN_NAME",prop.getName()).field("DATA_TYPE",OrientJdbcResultSetMetaData.getSqlType(prop.getType())).field("COLUMN_SIZE",1).field("NULLABLE",!prop.isNotNull()).field("IS_NULLABLE",prop.isNotNull() ? "NO" : "YES"));
      }
    }
  }
  return new OrientJdbcResultSet(new OrientJdbcStatement(connection),records,ResultSet.TYPE_FORWARD_ONLY,ResultSet.CONCUR_READ_ONLY,ResultSet.HOLD_CURSORS_OVER_COMMIT);
}
