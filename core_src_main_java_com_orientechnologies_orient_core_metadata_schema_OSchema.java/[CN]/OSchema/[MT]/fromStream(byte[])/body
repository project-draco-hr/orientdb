{
  super.fromStream(iBuffer);
  int schemaVersion=((Long)field("schemaVersion")).intValue();
  if (schemaVersion != CURRENT_VERSION_NUMBER) {
    throw new OConfigurationException("Database schema is different. Please export your old database with the previous verison of OrientDB and reimport it using the current one.");
  }
  OClass cls;
  List<ODocument> storedClasses=field("classes");
  for (  ODocument c : storedClasses) {
    c.setDatabase(database);
    cls=new OClass(this).fromDocument(c);
    classes.put(cls.getName().toLowerCase(),cls);
  }
  String superClassName;
  OClass superClass;
  for (  ODocument c : storedClasses) {
    superClassName=c.field("superClass");
    if (superClassName != null) {
      cls=classes.get(((String)c.field("name")).toLowerCase());
      superClass=classes.get(superClassName.toLowerCase());
      if (superClass == null)       throw new OConfigurationException("Super class '" + superClassName + "' was declared in class '"+ cls.getName()+ "' but was not found in schema. Remove the dependency or create the class to continue.");
      cls.setSuperClass(superClass);
    }
  }
  return this;
}
