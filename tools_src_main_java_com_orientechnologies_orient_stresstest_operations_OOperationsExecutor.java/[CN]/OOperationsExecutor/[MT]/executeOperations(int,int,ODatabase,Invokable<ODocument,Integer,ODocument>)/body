{
  List<ODocument> insertedDocs=new ArrayList<ODocument>();
  int txCounter=1;
  if (operationsInTx > 0) {
    database.begin();
  }
  for (int j=0; j < number; j++) {
    if (operationsInTx > 0 && txCounter % operationsInTx == 0) {
      database.commit();
      database.begin();
    }
    ODocument doc=operationToExecute.invoke(j,null);
    if (doc != null) {
      insertedDocs.add(doc);
    }
  }
  if (operationsInTx > 0) {
    database.commit();
  }
  return insertedDocs;
}
