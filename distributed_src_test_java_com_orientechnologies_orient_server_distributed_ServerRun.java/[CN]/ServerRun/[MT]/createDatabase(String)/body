{
  OGlobalConfiguration.STORAGE_KEEP_OPEN.setValue(false);
  String dbPath=getDatabasePath(iName);
  new File(dbPath).mkdirs();
  final ODatabaseDocumentTx database=new ODatabaseDocumentTx("local:" + dbPath);
  if (database.exists()) {
    System.out.println("Dropping previous database '" + iName + "' under: "+ dbPath+ "...");
    OFileUtils.deleteRecursively(new File(dbPath));
  }
  System.out.println("Creating database '" + iName + "' under: "+ dbPath+ "...");
  database.create();
  System.out.println("Creating database schema...");
  OClass personClass=database.getMetadata().getSchema().createClass("Person");
  personClass.createProperty("id",OType.STRING);
  personClass.createProperty("firstName",OType.STRING);
  personClass.createProperty("lastName",OType.STRING);
  personClass.createProperty("birthday",OType.DATE);
  personClass.createProperty("children",OType.INTEGER);
  database.close();
  return database;
}
