{
  long totalRecords=0;
  for (  String clusterName : iClusters) {
    long recordTot=database.countClusterElements(clusterName);
    listener.onMessage("\n- Exporting cluster '" + clusterName + "' (records="+ recordTot+ ") -> ");
    writer.beginObject(iLevel,true,"cluster");
    writer.writeAttribute(iLevel + 1,true,"name",clusterName);
    writer.writeAttribute(0,false,"id",database.getClusterIdByName(clusterName));
    writer.writeAttribute(0,false,"type",database.getClusterType(clusterName));
    if (recordTot > 0) {
      writer.beginCollection(iLevel + 1,true,"records");
      long recordNum=0;
      for (      ORecord<?> rec : database.browseCluster(clusterName))       exportRecord(recordTot,recordNum,rec);
      writer.endCollection(iLevel + 1,true);
    }
    listener.onMessage("OK");
    totalRecords+=recordTot;
    writer.endObject(iLevel,true);
  }
  listener.onMessage("\n\nDone. Exported " + totalRecords + " records\n");
  return totalRecords;
}
