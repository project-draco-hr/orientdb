{
  log("Migration completion notification from " + nodeId);
  while (state == NodeState.JOIN) {
    log("Wait till node will be joined.");
    try {
      Thread.sleep(100);
    }
 catch (    InterruptedException e) {
      e.printStackTrace();
    }
  }
  if (nodeId == migrationId) {
    state=NodeState.STABLE;
    log("State was changed to " + state);
    Long nodeToNotifyId=notificationQueue.poll();
    while (nodeToNotifyId != null) {
      final ODHTNode node=nodeLookup.findById(nodeToNotifyId);
      node.notifyMigrationEnd(id);
      nodeToNotifyId=notificationQueue.poll();
    }
  }
}
