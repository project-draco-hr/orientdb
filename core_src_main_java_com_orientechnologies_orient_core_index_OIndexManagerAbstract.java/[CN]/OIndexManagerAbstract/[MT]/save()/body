{
  OScenarioThreadLocal.executeAsDistributed(new Callable<Object>(){
    @Override public Object call() throws Exception {
      acquireExclusiveLock();
      try {
        for (int retry=0; retry < 10; retry++)         try {
          toStream();
          document.save();
          getDatabase().getStorage().synch();
          break;
        }
 catch (        OConcurrentModificationException e) {
          reload(null,true);
        }
        document.save();
        getDatabase().getStorage().synch();
        return null;
      }
  finally {
        releaseExclusiveLock();
      }
    }
  }
);
  return (RET)this;
}
