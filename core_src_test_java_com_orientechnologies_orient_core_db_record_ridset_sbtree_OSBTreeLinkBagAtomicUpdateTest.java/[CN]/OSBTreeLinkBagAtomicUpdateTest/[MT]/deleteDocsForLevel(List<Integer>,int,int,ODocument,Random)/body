{
  OSBTreeRidBag ridBag=rootDoc.field("ridBag");
  for (  OIdentifiable identifiable : ridBag) {
    ODocument doc=identifiable.getRecord();
    if (level + 1 < levels)     deleteDocsForLevel(amountOfDeletedDocsPerLevel,level + 1,levels,doc,rnd);
  }
  int docs=amountOfDeletedDocsPerLevel.get(level);
  int k=0;
  Iterator<OIdentifiable> iterator=ridBag.iterator();
  while (k < docs) {
    iterator.next();
    if (rnd.nextBoolean()) {
      iterator.remove();
      k++;
    }
    if (!iterator.hasNext())     iterator=ridBag.iterator();
  }
  rootDoc.save();
}
