{
  for (int i=0; i < entriesLength; i++) {
    final Object entry=entries[i];
    if (entry instanceof OIdentifiable) {
      final OIdentifiable identifiable=(OIdentifiable)entry;
      if (identifiable instanceof ORecord) {
        final ORecord record=(ORecord)identifiable;
        if (record.getIdentity().isNew()) {
          record.save();
        }
      }
    }
  }
  if (!deserialized) {
    System.arraycopy(serializedContent,0,stream,offset,serializedContent.length);
    if (contentWasChanged) {
      OIntegerSerializer.INSTANCE.serializeLiteral(size,stream,offset);
      offset+=serializedContent.length;
    }
 else {
      offset+=serializedContent.length;
      return offset;
    }
  }
 else {
    OIntegerSerializer.INSTANCE.serializeLiteral(size,stream,offset);
    offset+=OIntegerSerializer.INT_SIZE;
  }
  for (  Object entry : entries) {
    if (entry instanceof OIdentifiable) {
      OLinkSerializer.INSTANCE.serialize((OIdentifiable)entry,stream,offset);
      offset+=OLinkSerializer.RID_SIZE;
    }
  }
  return offset;
}
