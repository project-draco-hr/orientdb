{
  configuration.setValue(OGlobalConfiguration.NETWORK_SOCKET_TIMEOUT,iTimeout);
  channel=new OChannelBinaryClient(networkAddress,networkPort,configuration,OClusterProtocol.CURRENT_PROTOCOL_VERSION);
  logger.log(this,Level.WARNING,TYPE.CLUSTER,DIRECTION.IN,"received joining request from peer node. Checking authorizations...");
  channel.writeByte(OClusterProtocol.REQUEST_LEADER2PEER_CONNECT);
  channel.writeInt(sessionId);
  final ODocument doc=new ODocument();
  doc.field("clusterName",iClusterName);
  doc.field("clusterKey",iSecurityKey.getEncoded());
  doc.field("leaderNodeAddress",leader.getManager().getId());
  doc.field("leaderNodeRunningSince",leader.getManager().getRunningSince());
  channel.writeBytes(doc.toStream());
  channel.flush();
  final ODocument cfg;
  beginResponse();
  try {
    final byte connectedAsPeer=channel.readByte();
    if (connectedAsPeer == 0) {
      logger.log(this,Level.WARNING,TYPE.CLUSTER,DIRECTION.IN,"remote server node has refused the connection because it's the new Leader. Switching to be a Peer Node...");
      leader.getManager().becomePeer(null);
      disconnect();
      return false;
    }
    logger.log(this,Level.INFO,TYPE.CLUSTER,DIRECTION.IN,"joined peer node");
    cfg=new ODocument().fromStream(channel.readBytes());
  }
  finally {
    endResponse();
  }
  final ODocument answer=leader.updatePeerDatabases(id,cfg);
  channel.writeBytes(answer.toStream());
  channel.flush();
  setStatus(STATUS.CONNECTED);
  serviceThread=new OAsynchChannelServiceThread(new ODistributedRemoteAsynchEventListener(leader.getManager(),null,id),channel,"OrientDB <- Asynch Node/" + id);
  return true;
}
