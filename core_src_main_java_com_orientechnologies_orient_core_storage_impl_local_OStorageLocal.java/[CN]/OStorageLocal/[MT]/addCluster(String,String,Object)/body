{
  checkOpeness();
  final boolean locked=acquireExclusiveLock();
  try {
    iClusterName=iClusterName.toLowerCase();
    if (OStorage.TYPE_PHYSICAL.equalsIgnoreCase(iClusterType)) {
      final String clusterFileName=(String)(iParameters.length < 1 ? storagePath + "/" + iClusterName : iParameters[0]);
      final int startSize=(iParameters.length < 2 ? -1 : (Integer)iParameters[1]);
      return addPhysicalCluster(iClusterName,clusterFileName,startSize);
    }
 else     if (OStorage.TYPE_LOGICAL.equalsIgnoreCase(iClusterType)) {
      final int physicalClusterId=(iParameters.length < 1 ? -1 : (Integer)iParameters[0]);
      return addLogicalCluster(iClusterName,physicalClusterId);
    }
 else     OLogManager.instance().exception("Cluster type '" + iClusterType + "' is not supported. Supported types are: "+ Arrays.toString(TYPES),null,OStorageException.class);
  }
 catch (  Exception e) {
    OLogManager.instance().exception("Error in creation of new cluster '" + iClusterName + "' of type: "+ iClusterType,e,OStorageException.class);
  }
 finally {
    releaseExclusiveLock(locked);
  }
  return -1;
}
