{
  Object value=null;
switch (type) {
case INTEGER:
    value=OVarIntSerializer.readAsInteger(bytes);
  break;
case LONG:
value=OVarIntSerializer.readAsLong(bytes);
break;
case SHORT:
value=OVarIntSerializer.readAsShort(bytes);
break;
case STRING:
value=readString(bytes);
break;
case DOUBLE:
value=Double.longBitsToDouble(readLong(bytes));
break;
case FLOAT:
value=Float.intBitsToFloat(readInteger(bytes));
break;
case BYTE:
value=readByte(bytes);
break;
case BOOLEAN:
value=readByte(bytes) == 1 ? true : false;
break;
case DATETIME:
value=new Date(OVarIntSerializer.readAsLong(bytes));
break;
case DATE:
value=new Date((OVarIntSerializer.readAsLong(bytes) * MILLISEC_PER_DAY) - ONE_HOUR);
break;
case EMBEDDED:
value=new ODocument();
deserialize((ODocument)value,bytes);
if (((ODocument)value).containsField(ODocumentSerializable.CLASS_NAME)) {
String className=((ODocument)value).field(ODocumentSerializable.CLASS_NAME);
try {
Class<?> clazz=Class.forName(className);
ODocumentSerializable newValue=(ODocumentSerializable)clazz.newInstance();
newValue.fromDocument((ODocument)value);
value=newValue;
}
 catch (Exception e) {
throw new RuntimeException(e);
}
}
break;
case EMBEDDEDSET:
value=readEmbeddedCollection(bytes,new OTrackedSet<Object>(document),document);
break;
case EMBEDDEDLIST:
value=readEmbeddedCollection(bytes,new OTrackedList<Object>(document),document);
break;
case LINKSET:
value=readLinkCollection(bytes,new OMVRBTreeRIDSet(document));
break;
case LINKLIST:
value=readLinkCollection(bytes,new ORecordLazyList(document));
break;
case BINARY:
value=readBinary(bytes);
break;
case LINK:
value=readOptimizedLink(bytes);
break;
case LINKMAP:
value=readLinkMap(bytes,document);
break;
case EMBEDDEDMAP:
value=readEmbeddedMap(bytes,document);
break;
case DECIMAL:
value=ODecimalSerializer.INSTANCE.deserialize(bytes.bytes,bytes.offset);
bytes.skip(ODecimalSerializer.INSTANCE.getObjectSize(bytes.bytes,bytes.offset));
break;
case LINKBAG:
ORidBag bag=new ORidBag();
bag.fromStream(bytes);
value=bag;
break;
case TRANSIENT:
break;
case CUSTOM:
try {
String className=readString(bytes);
Class<?> clazz=Class.forName(className);
OSerializableStream stream=(OSerializableStream)clazz.newInstance();
stream.fromStream(readBinary(bytes));
value=stream;
}
 catch (Exception e) {
throw new RuntimeException(e);
}
break;
case ANY:
break;
}
return value;
}
