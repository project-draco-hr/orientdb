{
  acquireExclusiveLock();
  try {
    final BucketInfo bucketInfo=findBucket(iPosition);
    if (!bucketInfo.bucket.isOverflowBucket()) {
      final int idOffset=OClusterLocalLHPEBucket.getDataSegmentIdOffset(bucketInfo.index);
      final long filePos=bucketInfo.bucket.getFilePosition() + idOffset;
      final byte[] serializedDataSegment=OClusterLocalLHPEBucket.serializeDataSegmentId(iDataSegmentId);
      final byte[] serializedDataPosition=OClusterLocalLHPEBucket.serializeDataPosition(iDataPosition);
      fileSegment.writeContinuously(filePos,serializedDataSegment);
      fileSegment.writeContinuously(filePos + serializedDataSegment.length,serializedDataPosition);
    }
 else     overflowSegment.updateDataSegmentPosition(bucketInfo.bucket,bucketInfo.index,iDataSegmentId,iDataPosition);
  }
  finally {
    clearCache();
    releaseExclusiveLock();
  }
}
