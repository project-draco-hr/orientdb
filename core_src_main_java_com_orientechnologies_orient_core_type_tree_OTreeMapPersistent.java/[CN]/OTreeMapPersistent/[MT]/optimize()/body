{
  final long timer=OProfiler.getInstance().startChrono();
  lock.acquireExclusiveLock();
  try {
    if (root == null)     return;
    final int maxDepthLevel=getMaxDepth();
    if (maxDepthLevel <= 5)     return;
    final int cutLevel=(int)(maxDepthLevel * optimizeFactor);
    for (OTreeMapEntryPersistent<K,V> e=(OTreeMapEntryPersistent<K,V>)getFirstEntry(); e != null; e=e.nextInMemory()) {
      if (e.getDepth() > cutLevel)       e.clear();
    }
  }
  finally {
    lock.releaseExclusiveLock();
    OProfiler.getInstance().stopChrono("OTreeMapPersistent.optimize",timer);
  }
}
