{
  boolean updated=false;
  if (!removeEntries.isEmpty()) {
    for (    OPair<String,Object> entry : removeEntries) {
      Object value=extractValue(record,entry);
      if (value == EMPTY_VALUE) {
        record.removeField(entry.getKey());
        updated=true;
      }
 else {
        final Object fieldValue=record.field(entry.getKey());
        if (fieldValue instanceof Collection<?>) {
          if (((Collection<?>)fieldValue).remove(value))           updated=true;
        }
 else         if (fieldValue instanceof Map<?,?>) {
          if (((Map<?,?>)fieldValue).remove(value) != null)           updated=true;
        }
 else         if (fieldValue instanceof ORidBag) {
          final ORidBag bag=(ORidBag)fieldValue;
          if (!(value instanceof OIdentifiable))           throw new OCommandExecutionException("Only links or records can be removed from LINKBAG");
          bag.remove((OIdentifiable)value);
          if (record.isDirty())           updated=true;
        }
      }
    }
  }
  return updated;
}
