{
  engineLock.writeLock().lock();
  try {
    final List<OStorage> storagesCopy=new ArrayList<OStorage>(storages.values());
    for (    OStorage stg : storagesCopy) {
      try {
        OLogManager.instance().info(this,"- closing storage: " + stg.getName() + "...");
        stg.close(true,false);
      }
 catch (      Throwable e) {
        OLogManager.instance().warn(this,"-- error on closing storage",e);
      }
    }
    storages.clear();
  }
  finally {
    engineLock.writeLock().unlock();
  }
}
