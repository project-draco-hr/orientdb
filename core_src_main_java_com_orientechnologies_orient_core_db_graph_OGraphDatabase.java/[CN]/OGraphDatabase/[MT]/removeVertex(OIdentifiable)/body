{
  if (iVertex == null)   return false;
  final ODocument vertex=(ODocument)iVertex.getRecord();
  if (vertex == null)   return false;
  final boolean safeMode=beginBlock();
  try {
    ODocument otherVertex;
    Set<ODocument> otherEdges;
    acquireWriteLock(vertex);
    try {
      Set<ODocument> edges=vertex.field(VERTEX_FIELD_OUT);
      if (edges != null) {
        for (        ODocument edge : edges) {
          if (edge != null) {
            otherVertex=edge.field(EDGE_FIELD_IN);
            if (otherVertex != null) {
              otherEdges=otherVertex.field(VERTEX_FIELD_IN);
              if (otherEdges != null && otherEdges.remove(edge))               save(otherVertex);
            }
            delete(edge);
          }
        }
      }
      edges=vertex.field(VERTEX_FIELD_IN);
      if (edges != null) {
        for (        ODocument edge : edges) {
          if (edge != null) {
            otherVertex=edge.field(EDGE_FIELD_OUT);
            if (otherVertex != null) {
              otherEdges=otherVertex.field(VERTEX_FIELD_OUT);
              if (otherEdges != null && otherEdges.remove(edge))               save(otherVertex);
            }
            delete(edge);
          }
        }
      }
      delete(vertex);
    }
  finally {
      releaseWriteLock(vertex);
    }
    commitBlock(safeMode);
    return true;
  }
 catch (  RuntimeException e) {
    rollbackBlock(safeMode);
    throw e;
  }
}
