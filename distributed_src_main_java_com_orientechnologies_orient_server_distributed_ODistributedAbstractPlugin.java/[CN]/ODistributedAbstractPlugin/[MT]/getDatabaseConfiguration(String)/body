{
synchronized (cachedDatabaseConfiguration) {
    ODocument cfg=cachedDatabaseConfiguration.get(iDatabaseName);
    if (cfg == null) {
      final File specificDatabaseConfiguration=getDistributedConfigFile(iDatabaseName);
      cfg=loadDatabaseConfiguration(iDatabaseName,specificDatabaseConfiguration);
      if (cfg == null) {
        cfg=loadDatabaseConfiguration(iDatabaseName,defaultDatabaseConfigFile);
        if (cfg == null)         throw new OConfigurationException("Cannot load default distributed database config file: " + defaultDatabaseConfigFile);
      }
      cachedDatabaseConfiguration.put(iDatabaseName,cfg);
    }
    return new ODistributedConfiguration(cfg);
  }
}
