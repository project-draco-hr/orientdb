{
  if (fileDocument != null) {
    if (fileRID != null) {
      if (fileDocument.contains("$now")) {
        fileDocument=fileDocument.replace("$now",String.valueOf(now));
      }
      if (fileDocument.contains("$fileName")) {
        fileDocument=fileDocument.replace("$fileName",fileName);
      }
      if (fileDocument.contains("$fileType")) {
        fileDocument=fileDocument.replace("$fileType",fileType);
      }
      if (fileDocument.contains("$file")) {
        fileDocument=fileDocument.replace("$file",fileRID.toString());
      }
      ODocument doc=new ODocument();
      doc.fromJSON(fileDocument);
      doc.save();
      writer.beginObject("updatedDocument");
      writer.writeAttribute(1,true,"rid",doc.getIdentity().toString());
      writer.endObject();
      writer.endObject();
    }
 else {
      sendTextContent(iRequest,OHttpUtils.STATUS_INVALIDMETHOD_CODE,"File cannot be null",null,OHttpUtils.CONTENT_TEXT_PLAIN,"File cannot be null");
    }
    fileDocument=null;
  }
 else {
    if (fileRID != null) {
      ORecordBytes file=new ORecordBytes(fileRID);
      database.delete(file);
    }
    sendTextContent(iRequest,OHttpUtils.STATUS_INVALIDMETHOD_CODE,"Document template cannot be null",null,OHttpUtils.CONTENT_TEXT_PLAIN,"Document template cannot be null");
  }
}
