{
  final Map<String,Byte> result=new HashMap<String,Byte>();
  for (  ORule rule : rules.values()) {
    if (rule.getAccess() != null) {
      result.put(rule.getResourceGeneric().name(),rule.getAccess());
    }
    for (    Map.Entry<String,Byte> specificResource : rule.getSpecificResources().entrySet()) {
      result.put(rule.getResourceGeneric().name() + "." + specificResource.getKey(),specificResource.getValue());
    }
  }
  return result;
}
