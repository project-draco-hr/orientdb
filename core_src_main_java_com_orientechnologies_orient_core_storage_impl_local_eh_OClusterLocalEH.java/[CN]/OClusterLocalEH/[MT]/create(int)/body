{
  acquireExclusiveLock();
  try {
    for (int i=0; i < files.length; i++) {
      final OEHFileMetadata metadata=new OEHFileMetadata();
      final OFile bucketFile=new OFileMMap();
      bucketFile.init(name + i + OEHFileMetadata.DEF_EXTENSION,storage.getMode());
      bucketFile.create(bucketBufferSize * maxLevelSize);
      bucketFile.setIncrementSize(-100);
      metadata.setFile(bucketFile);
      files[i]=metadata;
    }
    initHashTreeState();
  }
  finally {
    releaseExclusiveLock();
  }
}
