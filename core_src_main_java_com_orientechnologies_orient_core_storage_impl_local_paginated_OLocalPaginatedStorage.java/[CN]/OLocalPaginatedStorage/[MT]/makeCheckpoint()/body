{
  if (writeAheadLog == null)   return;
  lock.acquireExclusiveLock();
  try {
    writeAheadLog.logCheckpointStart();
    for (    OLocalPaginatedCluster cluster : clusters)     if (cluster != null)     cluster.logClusterState();
    diskCache.flushBuffer();
    writeAheadLog.logCheckpointEnd();
  }
 catch (  IOException ioe) {
    throw new OStorageException("Error during checkpoint creation for storage " + name,ioe);
  }
 finally {
    lock.releaseExclusiveLock();
  }
}
