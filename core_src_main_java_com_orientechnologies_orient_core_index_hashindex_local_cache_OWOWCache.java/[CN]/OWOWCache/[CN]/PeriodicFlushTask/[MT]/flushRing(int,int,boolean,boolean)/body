{
  NavigableMap<PagedKey,PageGroup> subMap=null;
  NavigableSet<PagedKey> writePagesSubset=null;
  if (iterateByWritePagesFirst) {
    writePagesSubset=writePages.tailSet(lastWritePageKey,false);
  }
 else {
    subMap=cachePages.tailMap(lastPageKey,false);
  }
  flushedPages=iterateBySubRing(subMap,writePagesSubset,writePagesToFlush,flushedPages,forceFlush,iterateByWritePagesFirst);
  if (flushedPages < writePagesToFlush) {
    flushedPages=iterateBySubRing(cachePages,writePages,writePagesToFlush,flushedPages,forceFlush,iterateByWritePagesFirst);
  }
  return flushedPages;
}
