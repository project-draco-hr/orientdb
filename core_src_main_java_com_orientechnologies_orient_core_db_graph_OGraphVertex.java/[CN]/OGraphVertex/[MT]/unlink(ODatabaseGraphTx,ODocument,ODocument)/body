{
  if (iTargetVertex == null)   throw new IllegalArgumentException("Missed the target vertex");
  if (iDatabase.existsUserObjectByRID(iSourceVertex.getIdentity())) {
    final OGraphVertex vertex=(OGraphVertex)iDatabase.getUserObjectByRecord(iSourceVertex,null);
    if (vertex.outEdges != null && vertex.outEdges.get() != null) {
      for (      OGraphEdge e : vertex.outEdges.get())       if (e.getIn().getDocument().equals(iTargetVertex))       vertex.outEdges.get().remove(e);
    }
  }
  if (iDatabase.existsUserObjectByRID(iTargetVertex.getIdentity())) {
    final OGraphVertex vertex=(OGraphVertex)iDatabase.getUserObjectByRecord(iTargetVertex,null);
    if (vertex.inEdges != null && vertex.inEdges.get() != null) {
      for (      OGraphEdge e : vertex.inEdges.get())       if (e.getOut().getDocument().equals(iSourceVertex))       vertex.inEdges.get().remove(e);
    }
  }
  final List<ODocument> edges2Remove=new ArrayList<ODocument>();
  ODocument edge=null;
  Set<ODocument> docs=iSourceVertex.field(OGraphDatabase.VERTEX_FIELD_OUT);
  if (docs != null) {
    for (    ODocument d : docs)     if (d.<ODocument>field(OGraphDatabase.EDGE_FIELD_IN).equals(iTargetVertex)) {
      edges2Remove.add(d);
      edge=d;
    }
    for (    ODocument d : edges2Remove)     docs.remove(d);
  }
  if (edge == null)   throw new OGraphException("Edge not found between the ougoing edges");
  iSourceVertex.setDirty();
  iSourceVertex.save();
  docs=iTargetVertex.field(OGraphDatabase.VERTEX_FIELD_IN);
  if (docs != null) {
    edges2Remove.clear();
    for (    ODocument d : docs)     if (d.<ODocument>field(OGraphDatabase.EDGE_FIELD_IN).equals(iTargetVertex))     edges2Remove.add(d);
    for (    ODocument d : edges2Remove)     docs.remove(d);
  }
  iTargetVertex.setDirty();
  iTargetVertex.save();
  edge.delete();
}
