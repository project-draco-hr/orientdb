{
  if (tokenFromNetwork == null || tokenFromNetwork.length == 0) {
  }
 else {
    if (tokenBytes != null && tokenBytes.length > 0) {
      if (tokenBytes.equals(tokenFromNetwork))       return;
    }
    OToken token=null;
    try {
      if (tokenFromNetwork != null)       token=handler.parseBinaryToken(tokenFromNetwork);
    }
 catch (    Exception e) {
      throw OException.wrapException(new OSystemException("error on token parse"),e);
    }
    if (token == null || !token.getIsVerified()) {
      throw new OTokenSecurityException("The token provided is not a valid token, signature does not match");
    }
    if (!handler.validateBinaryToken(token)) {
      throw new OTokenSecurityException("The token provided is expired");
    }
    if (tokenBased == null) {
      tokenBased=Boolean.TRUE;
    }
    this.tokenBytes=tokenFromNetwork;
    this.token=token;
  }
}
