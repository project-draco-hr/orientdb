{
  if (holeSegment.getHoles() == 0)   return null;
  final int defragHoleDistance;
  if (defragMaxHoleDistance > 0)   defragHoleDistance=defragMaxHoleDistance;
 else {
    final long size=getSize();
    defragHoleDistance=Math.max(32768 * (int)(size / 10000000),32768);
  }
  final int[] fileRanges;
  if (pos[0] == 0)   fileRanges=new int[]{0,file.getFilledUpTo()};
 else {
    final int size=(int)(files[0].getFileSize() * pos[0]);
    fileRanges=new int[]{size,size + file.getFilledUpTo()};
  }
  return holeSegment.getCloserHole(iRecordOffset,iRecordSize,Math.max(iRecordOffset - defragHoleDistance,fileRanges[0]),Math.min(iRecordOffset + iRecordSize + defragHoleDistance,fileRanges[1]));
}
