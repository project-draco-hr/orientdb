{
  OGraphDatabase db=new OGraphDatabase(url);
  db.open("admin","admin");
  try {
    db.begin();
    ODocument v1=db.createVertex();
    v1.field("purpose","testQueryIsolation");
    v1.save();
    if (!url.startsWith("remote")) {
      List<OIdentifiable> result=db.query(new OSQLSynchQuery<Object>("select from V where purpose = 'testQueryIsolation'"));
      Assert.assertEquals(result.size(),1);
    }
    db.commit();
    List<OIdentifiable> result=db.query(new OSQLSynchQuery<Object>("select from V where purpose = 'testQueryIsolation'"));
    Assert.assertEquals(result.size(),1);
  }
  finally {
    db.close();
  }
}
