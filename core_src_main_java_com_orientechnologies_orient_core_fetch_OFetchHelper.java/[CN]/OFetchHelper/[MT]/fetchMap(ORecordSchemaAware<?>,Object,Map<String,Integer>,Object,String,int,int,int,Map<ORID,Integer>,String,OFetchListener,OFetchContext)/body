{
  final Map<String,ODocument> linked=(Map<String,ODocument>)fieldValue;
  iContext.onBeforeMap(iRootRecord,fieldName,iUserObject);
  for (  String key : (linked).keySet()) {
    ODocument d=linked.get(key);
    final Integer fieldDepthLevel=parsedRecords.get(d.getIdentity());
    if (!d.getIdentity().isValid() || (fieldDepthLevel != null && fieldDepthLevel.intValue() == iLevelFromRoot)) {
      removeParsedFromMap(parsedRecords,d);
      iContext.onBeforeDocument(d,key,iUserObject);
      final Object userObject=iListener.fetchLinkedMapEntry(iRootRecord,iUserObject,fieldName,key,d,iContext);
      processRecord(d,userObject,iFetchPlan,iCurrentLevel,iLevelFromRoot,iFieldDepthLevel,parsedRecords,iFieldPathFromRoot,iListener,iContext);
      iContext.onAfterDocument(d,key,iUserObject);
    }
 else {
      iListener.parseLinked(iRootRecord,d,iUserObject,key,iContext);
    }
  }
  iContext.onAfterMap(iRootRecord,fieldName,iUserObject);
}
