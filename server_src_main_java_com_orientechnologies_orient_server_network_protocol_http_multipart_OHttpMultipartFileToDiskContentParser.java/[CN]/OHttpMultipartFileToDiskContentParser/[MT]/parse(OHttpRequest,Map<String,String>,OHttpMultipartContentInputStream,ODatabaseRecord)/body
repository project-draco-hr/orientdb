{
  final StringWriter buffer=new StringWriter();
  final OJSONWriter json=new OJSONWriter(buffer);
  json.beginObject();
  String fileName=headers.get(OHttpUtils.MULTIPART_CONTENT_FILENAME);
  int fileSize=0;
  if (fileName.charAt(0) == '"') {
    fileName=new String(fileName.substring(1));
  }
  if (fileName.charAt(fileName.length() - 1) == '"') {
    fileName=new String(fileName.substring(0,fileName.length() - 1));
  }
  final OutputStream out=new BufferedOutputStream(new FileOutputStream(path + fileName.toString()));
  try {
    int b;
    while ((b=in.read()) > 0) {
      out.write(b);
      fileSize++;
    }
  }
  finally {
    out.flush();
    out.close();
  }
  json.writeAttribute(1,true,"name",fileName);
  json.writeAttribute(1,true,"type",headers.get(OHttpUtils.MULTIPART_CONTENT_TYPE));
  json.writeAttribute(1,true,"size",fileSize);
  json.endObject();
  return new ByteArrayInputStream(buffer.toString().getBytes());
}
