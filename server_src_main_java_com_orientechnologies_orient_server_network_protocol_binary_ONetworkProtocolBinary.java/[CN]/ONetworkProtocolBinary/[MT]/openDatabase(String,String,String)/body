{
  final String path=OServerMain.server().getStoragePath(iDbUrl);
  connection.database=new ODatabaseDocumentTx(path);
  if (connection.database.isClosed())   if (connection.database.getStorage() instanceof OStorageMemory)   connection.database.create();
 else {
    try {
      connection.database.open(iUser,iPassword);
    }
 catch (    OSecurityException e) {
      try {
        serverLogin(iUser,iPassword,"database.passthrough");
      }
 catch (      OSecurityException ex) {
        throw e;
      }
      connection.database.setProperty(ODatabase.OPTIONS.SECURITY.toString(),Boolean.FALSE);
      connection.database.open(iUser,iPassword);
    }
  }
  connection.rawDatabase=((ODatabaseRaw)((ODatabaseComplex<?>)connection.database.getUnderlying()).getUnderlying());
  return connection.database;
}
