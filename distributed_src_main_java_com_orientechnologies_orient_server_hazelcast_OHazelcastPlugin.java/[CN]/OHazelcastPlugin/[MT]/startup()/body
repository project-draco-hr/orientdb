{
  if (!enabled)   return;
  super.startup();
  status=NODE_STATUS.STARTING;
  OLogManager.instance().info(this,"Starting distributed server '%s'...",getLocalNodeName());
  activeNodes.clear();
  try {
    hazelcastInstance=configureHazelcast();
    nodeId=hazelcastInstance.getCluster().getLocalMember().getUuid();
    timeOffset=System.currentTimeMillis() - hazelcastInstance.getCluster().getClusterTime();
    activeNodes.put(getLocalNodeName(),hazelcastInstance.getCluster().getLocalMember());
    membershipListenerRegistration=hazelcastInstance.getCluster().addMembershipListener(this);
    OServer.registerServerInstance(getLocalNodeName(),serverInstance);
    final IMap<String,Object> configurationMap=getConfigurationMap();
    configurationMap.addEntryListener(this,true);
    for (    Member m : hazelcastInstance.getCluster().getMembers()) {
      final String memberName=getNodeName(m);
      if (memberName != null)       activeNodes.put(memberName,m);
 else       if (!m.equals(hazelcastInstance.getCluster().getLocalMember()))       ODistributedServerLog.warn(this,getLocalNodeName(),null,DIRECTION.NONE,"Cannot find configuration for member: %s",m);
    }
    messageService=new OHazelcastDistributedMessageService(this);
    configurationMap.put(CONFIG_NODE_PREFIX + getLocalNodeId(),getLocalNodeConfiguration());
    installNewDatabases(true);
    loadDistributedDatabases();
    setNodeStatus(NODE_STATUS.ONLINE);
  }
 catch (  FileNotFoundException e) {
    throw new OConfigurationException("Error on creating Hazelcast instance",e);
  }
}
