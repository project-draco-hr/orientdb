{
  ORecordInternal<?> recordInternal=database.load(rid);
  if (recordInternal != null)   recordInternal.delete();
  String clusterName=database.getClusterNameById(record.getIdentity().getClusterId());
  record.setIdentity(-1,ORecordId.CLUSTER_POS_INVALID);
  if (record instanceof ODocument)   record.save(clusterName);
 else   ((ODatabaseRecord)database.getUnderlying()).save(record,clusterName);
  if (!record.getIdentity().equals(rid))   database.getStorage().changeRecordIdentity(record.getIdentity(),rid);
  record.setIdentity(rid);
}
