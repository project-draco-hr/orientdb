{
  final File importDir=new File(testPath + "/" + NEW_DB_PATH);
  if (importDir.exists())   for (  File f : importDir.listFiles())   f.delete();
 else   importDir.mkdir();
  ODatabaseDocumentTx database=new ODatabaseDocumentTx("plocal:" + testPath + "/"+ NEW_DB_URL);
  database.create();
  ODatabaseImport dbImport=new ODatabaseImport(database,testPath + "/" + EXPORT_FILE_PATH,this);
  for (  ORecordHook hook : new ArrayList<ORecordHook>(database.getHooks().keySet())) {
    database.unregisterHook(hook);
  }
  if (url.startsWith("local:") || url.startsWith("memory:"))   dbImport.setPreserveClusterIDs(false);
  dbImport.setPreserveRids(true);
  dbImport.setDeleteRIDMapping(false);
  dbImport.importDatabase();
  dbImport.close();
  database.close();
}
