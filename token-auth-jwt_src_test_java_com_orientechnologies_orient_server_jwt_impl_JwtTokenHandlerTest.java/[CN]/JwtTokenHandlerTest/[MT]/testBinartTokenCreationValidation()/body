{
  ODatabaseDocumentTx db=new ODatabaseDocumentTx("memory:" + JwtTokenHandlerTest.class.getSimpleName());
  db.create();
  try {
    OSecurityUser original=db.getUser();
    JwtTokenHandler handler=new JwtTokenHandler();
    handler.config(null,I_PARAMS);
    byte[] token=handler.getSignedBinaryToken(db,original);
    OToken tok=handler.parseBinaryToken(token);
    assertNotNull(tok);
    assertTrue(tok.getIsVerified());
    OUser user=tok.getUser(db);
    assertEquals(user.getName(),original.getName());
    boolean boole=handler.validateToken(tok,"open",db.getName());
    assertTrue(boole);
    assertTrue(tok.getIsValid());
  }
  finally {
    db.drop();
  }
}
