{
  if (this.isClosed())   throw new ODatabaseException("Cannot copy a closed db");
  ODatabaseDocumentTx db=new ODatabaseDocumentTx(this.url);
  db.user=this.user;
  db.properties.putAll(this.properties);
  db.serializer=this.serializer;
  db.metadata=new OMetadataDefault();
  db.initialized=true;
  db.storage=storage;
  if (storage instanceof OStorageProxy)   ((OStorageProxy)db.storage).addUser();
  db.setStatus(STATUS.OPEN);
  db.activateOnCurrentThread();
  db.metadata.load();
  return db;
}
