{
  final String[] urlParts=checkSyntax(iRequest.url,2,"Syntax error: backup/<database>");
  iRequest.data.commandInfo="Database backup";
  try {
    iRequest.databaseName=urlParts[1];
    final ODatabaseRecord database=getProfiledDatabaseInstance(iRequest);
    try {
      iResponse.writeStatus(OHttpUtils.STATUS_OK_CODE,OHttpUtils.STATUS_OK_DESCRIPTION);
      iResponse.writeHeaders(OHttpUtils.CONTENT_GZIP);
      iResponse.writeLine("Content-Disposition: attachment; filename=" + database.getName() + ".gz");
      iResponse.writeLine("Date: " + new Date());
      iResponse.writeLine(null);
      database.backup(iResponse.getOutputStream(),null,null);
      try {
        iResponse.flush();
      }
 catch (      SocketException e) {
      }
    }
  finally {
      if (database != null)       database.close();
    }
  }
 catch (  Exception e) {
    iResponse.sendStream(404,"File not found",null,null,0);
  }
  return false;
}
