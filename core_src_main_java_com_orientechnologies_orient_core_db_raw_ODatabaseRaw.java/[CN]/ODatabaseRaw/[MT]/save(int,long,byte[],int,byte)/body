{
  try {
    if (iPosition == ORID.CLUSTER_POS_INVALID) {
      iPosition=storage.createRecord(iClusterId,iContent,iRecordType);
      if (useCache)       getCache().pushRecord(ORecordId.generateString(iClusterId,iPosition),new ORawBuffer(iContent,0,iRecordType));
      return iPosition;
    }
 else {
      int newVersion=storage.updateRecord(id,iClusterId,iPosition,iContent,iVersion,iRecordType);
      if (useCache)       getCache().pushRecord(ORecordId.generateString(iClusterId,iPosition),new ORawBuffer(iContent,newVersion,iRecordType));
      return newVersion;
    }
  }
 catch (  Throwable t) {
    throw new ODatabaseException("Error on saving record in cluster id: " + iClusterId + ", position: "+ iPosition,t);
  }
}
