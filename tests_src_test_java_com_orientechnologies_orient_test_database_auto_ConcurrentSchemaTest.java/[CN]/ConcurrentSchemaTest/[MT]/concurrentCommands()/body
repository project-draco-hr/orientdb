{
  System.out.println("Create classes, spanning " + THREADS + " threads...");
  ConcurrentTestHelper.test(THREADS,new ConcurrentTestHelper.TestFactory<Void>(){
    @Override public Callable<Void> createWorker(){
      return new CreateClassCommandExecutor(url);
    }
  }
);
  System.out.println("Create classes, checking...");
  for (int id=0; id < THREADS; ++id) {
    for (int i=0; i < CYCLES; ++i) {
      final String clsName="ConcurrentClassTest-" + id + "-"+ i;
      Assert.assertTrue(database.getMetadata().getSchema().existsClass(clsName));
    }
  }
  System.out.println("Dropping classes, spanning " + THREADS + " threads...");
  ConcurrentTestHelper.test(THREADS,new ConcurrentTestHelper.TestFactory<Void>(){
    @Override public Callable<Void> createWorker(){
      return new DropClassCommandExecutor(url);
    }
  }
);
  System.out.println("Done!");
  Assert.assertEquals(counter.get(),0);
}
