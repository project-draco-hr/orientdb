{
  OStorage stg=Orient.instance().getStorage(databaseName);
  if (stg == null) {
    final String url=OServerMain.server().getStorageURL(databaseName);
    if (url == null) {
      OLogManager.instance().error(this,"DISTRIBUTED <- database '%s' is not configured on this server. Copy the database here to enable the replication",rid,databaseName);
      return null;
    }
    stg=Orient.instance().loadStorage(url);
  }
  if (stg.isClosed())   stg.open(null,null,null);
  Object result=null;
  if (operation == ORecordOperation.CREATED) {
    OLogManager.instance().debug(this,"DISTRIBUTED <- creating record %s v.%d size=%s",rid,version,OFileUtils.getSizeAsString(content.length));
    result=stg.createRecord(0,rid,content,version,recordType,0,null);
  }
 else   if (operation == ORecordOperation.LOADED) {
    OLogManager.instance().debug(this,"DISTRIBUTED <- reading record %s v.%d size=%s",rid,version,OFileUtils.getSizeAsString(content.length));
    result=stg.readRecord(rid,null,false,null);
  }
 else   if (operation == ORecordOperation.UPDATED) {
    OLogManager.instance().debug(this,"DISTRIBUTED <- updating record %s v.%d size=%s",rid,version,OFileUtils.getSizeAsString(content.length));
    result=stg.updateRecord(rid,content,version,recordType,0,null);
  }
 else   if (operation == ORecordOperation.DELETED) {
    OLogManager.instance().debug(this,"DISTRIBUTED <- deleting record %s v.%d size=%s",rid,version,OFileUtils.getSizeAsString(content.length));
    result=stg.deleteRecord(rid,version,0,null);
  }
 else   OLogManager.instance().error(this,"DISTRIBUTED <- received invalid operation code %d",operation);
  if (mode != EXECUTION_MODE.FIRE_AND_FORGET)   return result;
  return null;
}
