{
  OEHFileMetadata fileMetadata=filesMetadata[fileLevel];
  if (fileMetadata == null) {
    fileMetadata=createFileMetadata(fileLevel);
    filesMetadata[fileLevel]=fileMetadata;
  }
  final OMultiFileSegment bucketFile=fileMetadata.getFile();
  bucket.toStream();
  final long[] pos=bucketFile.getRelativePosition(filePosition);
  final OFile file=bucketFile.getFile((int)pos[0]);
  file.write(pos[1],bucket.getDataBuffer());
}
