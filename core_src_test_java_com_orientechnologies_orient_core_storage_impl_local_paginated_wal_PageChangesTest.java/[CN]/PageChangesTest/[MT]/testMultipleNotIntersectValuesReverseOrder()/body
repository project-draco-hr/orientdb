{
  OPageChanges pageChanges=new OPageChanges();
  for (byte i=17; i >= 0; i--) {
    pageChanges.addChanges(i * 10,new byte[]{i,(byte)(i + 1),(byte)(i + 2),(byte)(i + 3)},new byte[]{(byte)(i + 3),(byte)(i + 2),(byte)(i + 1),i});
  }
  ODirectMemory directMemory=ODirectMemoryFactory.INSTANCE.directMemory();
  long pointer=directMemory.allocate(1024);
  pageChanges.applyChanges(pointer);
  for (byte i=0; i < 17; i++) {
    Assert.assertEquals(directMemory.get(pointer + i * 10,4),new byte[]{i,(byte)(i + 1),(byte)(i + 2),(byte)(i + 3)});
  }
  pageChanges.revertChanges(pointer);
  for (byte i=0; i < 17; i++) {
    Assert.assertEquals(directMemory.get(pointer + i * 10,4),new byte[]{(byte)(i + 3),(byte)(i + 2),(byte)(i + 1),i});
  }
  directMemory.free(pointer);
}
