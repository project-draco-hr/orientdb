{
  if (roles == null || roles.isEmpty())   throw new OSecurityAccessException("User '" + name + "' has no role defined");
  final ORole role=checkIfAllowed(iResource,iOperation);
  if (role == null)   throw new OSecurityAccessException("User '" + name + "' has no the permission to execute the operation '"+ iOperation+ "' against the resource: "+ iResource);
  return role;
}
