{
  try {
    ((OWOWCache)writeCache).unregisterMBean();
  }
 catch (  Exception e) {
    OLogManager.instance().error(this,"MBean for write cache can not unregistered",e);
  }
  try {
    if (writeAheadLog != null) {
      checkpointExecutor.shutdown();
      if (!checkpointExecutor.awaitTermination(OGlobalConfiguration.WAL_FULL_CHECKPOINT_SHUTDOWN_TIMEOUT.getValueAsInteger(),TimeUnit.SECONDS))       throw new OStorageException("Can not terminate full checkpoint task");
    }
  }
 catch (  InterruptedException e) {
    Thread.interrupted();
    throw new OStorageException("Error on closing of storage '" + name,e);
  }
}
