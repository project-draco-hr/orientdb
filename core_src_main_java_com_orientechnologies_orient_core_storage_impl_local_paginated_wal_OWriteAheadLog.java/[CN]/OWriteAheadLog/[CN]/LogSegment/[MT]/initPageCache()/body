{
  long pagesCount=rndFile.length() / OWALPage.PAGE_SIZE;
  if (pagesCount == 0)   return;
  rndFile.seek((pagesCount - 1) * OWALPage.PAGE_SIZE);
  byte[] content=new byte[OWALPage.PAGE_SIZE];
  rndFile.readFully(content);
  long pointer=directMemory.allocate(content);
  OWALPage walPage=new OWALPage(pointer,false);
  if (walPage.getFreeSpace() >= OWALPage.MIN_RECORD_SIZE) {
    pages.add(walPage);
    walPage.setFirstLsn(new OLogSequenceNumber(order,(pagesCount - 1) * OWALPage.PAGE_SIZE + OWALPage.RECORDS_OFFSET));
    filledUpTo=(pagesCount - 1) * OWALPage.PAGE_SIZE + (OWALPage.PAGE_SIZE - walPage.getFreeSpace());
    lastFlushedPosition=(pagesCount - 1) * OWALPage.PAGE_SIZE;
  }
 else {
    directMemory.free(pointer);
    filledUpTo=rndFile.length();
    lastFlushedPosition=filledUpTo;
  }
}
