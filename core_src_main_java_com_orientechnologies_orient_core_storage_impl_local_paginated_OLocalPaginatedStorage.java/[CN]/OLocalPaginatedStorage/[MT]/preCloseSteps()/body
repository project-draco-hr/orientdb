{
  try {
    if (writeAheadLog != null) {
      fuzzyCheckpointExecutor.shutdown();
      if (!fuzzyCheckpointExecutor.awaitTermination(OGlobalConfiguration.WAL_FUZZY_CHECKPOINT_SHUTDOWN_TIMEOUT.getValueAsInteger(),TimeUnit.SECONDS))       throw new OStorageException("Can not terminate fuzzy checkpoint task");
      checkpointExecutor.shutdown();
      if (!checkpointExecutor.awaitTermination(OGlobalConfiguration.WAL_FULL_CHECKPOINT_SHUTDOWN_TIMEOUT.getValueAsInteger(),TimeUnit.SECONDS))       throw new OStorageException("Can not terminate full checkpoint task");
    }
  }
 catch (  InterruptedException e) {
    Thread.interrupted();
    throw new OStorageException("Error on closing of storage '" + name,e);
  }
}
