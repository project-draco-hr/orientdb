{
  String buildDirectory=System.getProperty("buildDirectory",".");
  if (buildDirectory == null)   buildDirectory=".";
  if (remote) {
    try {
      final String finalBuildDirectory=buildDirectory;
      Future<Boolean> iServer=pool.submit(new Callable<Boolean>(){
        @Override public Boolean call() throws Exception {
          System.setProperty("ORIENTDB_HOME",finalBuildDirectory);
          server=OServerMain.create();
          server.startup(ClassLoader.getSystemResourceAsStream("orientdb-server-config.xml"));
          server.activate();
          serverDatabase=Orient.instance().getDatabaseFactory().createDatabase("graph",getStoragePath(getDatabaseName(),"plocal"));
          if (serverDatabase.exists()) {
            serverDatabase.open("admin","admin");
            serverDatabase.drop();
          }
          serverDatabase.create();
          return true;
        }
      }
);
      iServer.get();
      url="remote:localhost/" + getDatabaseName();
      databaseDocumentTx=new ODatabaseDocumentTx(url);
      databaseDocumentTx.open("admin","admin");
    }
 catch (    Exception e) {
      e.printStackTrace();
    }
  }
 else {
    url="plocal:" + buildDirectory + "/"+ getDatabaseName();
    databaseDocumentTx=new ODatabaseDocumentTx(url);
    if (!databaseDocumentTx.exists()) {
      databaseDocumentTx=Orient.instance().getDatabaseFactory().createDatabase("graph",url);
      databaseDocumentTx.create();
    }
 else {
      databaseDocumentTx.open("admin","admin");
    }
  }
}
