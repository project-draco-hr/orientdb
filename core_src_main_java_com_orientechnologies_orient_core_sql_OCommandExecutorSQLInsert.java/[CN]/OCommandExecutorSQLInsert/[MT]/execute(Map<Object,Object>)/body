{
  if (fields == null)   throw new OCommandExecutionException("Can't execute the command because it hasn't been parsed yet");
  if (indexName != null) {
    final OIndex index=database.getMetadata().getIndexManager().getIndex(indexName);
    if (index == null)     throw new OCommandExecutionException("Target index '" + indexName + "' not found");
    index.put(fields.get(KEYWORD_KEY),(OIdentifiable)fields.get(KEYWORD_RID));
    return null;
  }
 else {
    ODocument doc=className != null ? new ODocument(database,className) : new ODocument(database);
    OSQLHelper.bindParameters(doc,fields,iArgs);
    if (clusterName != null)     doc.save(clusterName);
 else     doc.save();
    return doc;
  }
}
