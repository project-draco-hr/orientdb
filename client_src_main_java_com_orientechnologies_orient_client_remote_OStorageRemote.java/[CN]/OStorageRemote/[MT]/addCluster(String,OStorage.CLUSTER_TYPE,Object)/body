{
  checkConnection();
  do {
    try {
      final OChannelBinaryClient network=beginRequest(OChannelBinaryProtocol.REQUEST_DATACLUSTER_ADD);
      try {
        network.writeString(iClusterType.toString());
        network.writeString(iClusterName);
switch (iClusterType) {
case PHYSICAL:
          network.writeString(iArguments.length > 0 ? (String)iArguments[0] : "").writeInt(iArguments.length > 0 ? (Integer)iArguments[1] : -1);
        break;
case LOGICAL:
      network.writeInt(iArguments.length > 0 ? (Integer)iArguments[0] : -1);
    break;
}
}
  finally {
endRequest(network);
}
try {
beginResponse(network);
final int clusterId=network.readShort();
clustersIds.put(iClusterName.toLowerCase(),clusterId);
clustersTypes.put(iClusterName.toLowerCase(),iClusterType.toString());
return clusterId;
}
  finally {
endResponse(network);
}
}
 catch (Exception e) {
handleException("Error on add new cluster",e);
}
}
 while (true);
}
