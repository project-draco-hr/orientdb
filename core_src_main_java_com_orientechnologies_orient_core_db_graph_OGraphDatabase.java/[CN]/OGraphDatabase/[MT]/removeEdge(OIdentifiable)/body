{
  if (iEdge == null)   return false;
  final ODocument edge=iEdge.getRecord();
  if (edge == null)   return false;
  final boolean safeMode=beginBlock();
  try {
    final ODocument outVertex=edge.field(EDGE_FIELD_OUT);
    acquireWriteLock(outVertex);
    try {
      if (outVertex != null) {
        final Set<ODocument> out=((Set<ODocument>)outVertex.field(VERTEX_FIELD_OUT));
        if (out != null)         out.remove(edge);
        save(outVertex);
      }
    }
  finally {
      releaseWriteLock(outVertex);
    }
    final ODocument inVertex=edge.field(EDGE_FIELD_IN);
    acquireWriteLock(inVertex);
    try {
      if (inVertex != null) {
        final Set<ODocument> in=((Set<ODocument>)inVertex.field(VERTEX_FIELD_IN));
        if (in != null)         in.remove(edge);
        save(inVertex);
      }
    }
  finally {
      releaseWriteLock(inVertex);
    }
    delete(edge);
    commitBlock(safeMode);
  }
 catch (  RuntimeException e) {
    rollbackBlock(safeMode);
    throw e;
  }
  return true;
}
