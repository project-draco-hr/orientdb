{
  Mac mac=threadLocalMac.get();
  try {
    mac.init(getKeyProvider().getKey(header));
    return mac.doFinal(unsignedToken);
  }
 catch (  Exception ex) {
    throw new OException("Error on token parsing",ex);
  }
 finally {
    mac.reset();
  }
}
