{
  final ODistributedConfiguration cfg=iManager.getDatabaseConfiguration(iDatabaseName);
  final List<List<String>> partitions=cfg.getPartitions(iClusterName);
  AtomicLong lastPos=lastPartition.get(iDatabaseName);
  if (lastPos == null) {
    lastPos=new AtomicLong(-1l);
    lastPartition.putIfAbsent(iDatabaseName,lastPos);
  }
  final long newPos=lastPos.incrementAndGet();
  final List<String> partition=partitions.get((int)(newPos % partitions.size()));
  return iManager.newPartition(partition);
}
