{
  acquireExclusiveLock();
  try {
    if (!removed.isEmpty()) {
      final OPhysicalPosition recycledPosition=removed.remove(removed.size() - 1);
      iPPosition.clusterPosition=recycledPosition.clusterPosition;
      iPPosition.recordVersion=recycledPosition.recordVersion.copy();
      iPPosition.recordVersion.increment();
      int positionToStore=recycledPosition.clusterPosition.intValue();
      entries.set(positionToStore,iPPosition);
    }
 else {
      iPPosition.clusterPosition=allocateRecord(iPPosition);
      iPPosition.recordVersion.reset();
      entries.add(iPPosition);
    }
  }
  finally {
    releaseExclusiveLock();
  }
  return true;
}
