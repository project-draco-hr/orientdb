{
  long pageIndex;
  if (continuousWrite.get()) {
    pageIndex=pageCounters.getAndIncrement(fileNumber);
  }
 else {
    pageIndex=pagesQueue.get(fileNumber).remove(new Random().nextInt(pagesQueue.get(fileNumber).size()));
  }
  return pageIndex;
}
