{
  final OIndexDefinition indexDefinition=index.getDefinition();
  final OIndexInternal<?> internalIndex=index.getInternal();
  if (!internalIndex.canBeUsedInEqualityOperators())   return null;
  if (indexDefinition.getParamCount() == 1) {
    final Object key;
    if (indexDefinition instanceof OIndexDefinitionMultiValue)     key=((OIndexDefinitionMultiValue)indexDefinition).createSingleValue(keyParams.get(0));
 else     key=indexDefinition.createValue(keyParams);
    if (key == null)     return null;
    final Object indexResult=index.get(key);
    if (indexResult instanceof Collection)     return (Collection<OIdentifiable>)indexResult;
    if (indexResult == null)     return Collections.emptyList();
    return Collections.singletonList((OIdentifiable)indexResult);
  }
 else {
    final OCompositeIndexDefinition compositeIndexDefinition=(OCompositeIndexDefinition)indexDefinition;
    final Object keyOne=compositeIndexDefinition.createSingleValue(keyParams);
    if (keyOne == null)     return null;
    final Object keyTwo=compositeIndexDefinition.createSingleValue(keyParams);
    final Collection<OIdentifiable> result;
    if (fetchLimit > -1)     result=index.getValuesBetween(keyOne,true,keyTwo,true,fetchLimit);
 else     result=index.getValuesBetween(keyOne,true,keyTwo,true);
    if (OProfiler.getInstance().isRecording()) {
      OProfiler.getInstance().updateCounter("Query.compositeIndexUsage",1);
      OProfiler.getInstance().updateCounter("Query.compositeIndexUsage." + indexDefinition.getParamCount(),1);
      OProfiler.getInstance().updateCounter("Query.compositeIndexUsage." + indexDefinition.getParamCount() + '.'+ keyParams.size(),1);
    }
    return result;
  }
}
