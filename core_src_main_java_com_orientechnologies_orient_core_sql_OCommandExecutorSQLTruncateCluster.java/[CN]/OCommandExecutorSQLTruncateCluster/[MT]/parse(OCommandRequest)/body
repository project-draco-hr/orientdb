{
  final ODatabaseRecord database=getDatabase();
  database.checkSecurity(ODatabaseSecurityResources.COMMAND,ORole.PERMISSION_READ);
  init(((OCommandRequestText)iRequest).getText());
  StringBuilder word=new StringBuilder();
  int oldPos=0;
  int pos=nextWord(text,textUpperCase,oldPos,word,true);
  if (pos == -1 || !word.toString().equals(KEYWORD_TRUNCATE))   throw new OCommandSQLParsingException("Keyword " + KEYWORD_TRUNCATE + " not found. Use "+ getSyntax(),text,oldPos);
  oldPos=pos;
  pos=nextWord(text,textUpperCase,oldPos,word,true);
  if (pos == -1 || !word.toString().equals(KEYWORD_CLUSTER))   throw new OCommandSQLParsingException("Keyword " + KEYWORD_CLUSTER + " not found. Use "+ getSyntax(),text,oldPos);
  oldPos=pos;
  pos=nextWord(text,text,oldPos,word,true);
  if (pos == -1)   throw new OCommandSQLParsingException("Expected cluster name. Use " + getSyntax(),text,oldPos);
  clusterName=word.toString();
  if (database.getClusterIdByName(clusterName) == -1)   throw new OCommandSQLParsingException("Cluster '" + clusterName + "' not found",text,oldPos);
  return this;
}
