{
  checkOpeness();
  modificationLock.requestModificationLock();
  try {
    lock.acquireExclusiveLock();
    try {
      if (transaction == null)       return;
      if (writeAheadLog == null)       throw new OStorageException("WAL mode is not active. Transactions are not supported in given mode");
      if (transaction.getClientTx().getId() != clientTx.getId())       throw new OStorageException("Passed in and active transaction are different transactions. Passed in transaction can not be rolled back.");
      rollbackStorageTx();
      OTransactionAbstract.updateCacheFromEntries(clientTx,clientTx.getAllRecordEntries(),false);
    }
 catch (    IOException e) {
      throw new OStorageException("Error during transaction rollback.",e);
    }
 finally {
      transaction=null;
      lock.releaseExclusiveLock();
    }
  }
  finally {
    modificationLock.releaseModificationLock();
  }
}
