{
  database.open("admin","admin");
  OSQLEngine.getInstance().registerFunction("bigger",new OSQLFunctionAbstract("bigger",2,2){
    public String getSyntax(){
      return "bigger(<first>, <second>)";
    }
    public Object execute(    ORecord<?> iCurrentRecord,    final Object[] iParameters,    OCommandExecutor iRequester){
      if (iParameters[0] == null || iParameters[1] == null)       return null;
      if (!(iParameters[0] instanceof Number) || !(iParameters[1] instanceof Number))       return null;
      final double v1=((Number)iParameters[0]).doubleValue();
      final double v2=((Number)iParameters[1]).doubleValue();
      return Math.max(v1,v2);
    }
  }
);
  List<ODocument> result=database.command(new OSQLSynchQuery<ODocument>("select from Account where bigger(id,1000) = 1000")).execute();
  Assert.assertTrue(result.size() != 0);
  for (  ODocument d : result) {
    Assert.assertTrue((Integer)d.field("id") <= 1000);
  }
  OSQLEngine.getInstance().unregisterInlineFunction("bigger");
  database.close();
}
