{
  setDataCommandInfo("Shutdowning");
  OLogManager.instance().info(this,"Received shutdown command from the remote client %s:%d",channel.socket.getInetAddress(),channel.socket.getPort());
  final String user=channel.readString();
  final String passwd=channel.readString();
  if (server.authenticate(user,passwd,"shutdown")) {
    OLogManager.instance().info(this,"Remote client %s:%d authenticated. Starting shutdown of server...",channel.socket.getInetAddress(),channel.socket.getPort());
    beginResponse();
    try {
      sendOk(clientTxId);
    }
  finally {
      endResponse();
    }
    runShutdownInNonDaemonThread();
  }
  OLogManager.instance().error(this,"Authentication error of remote client %s:%d: shutdown is aborted.",channel.socket.getInetAddress(),channel.socket.getPort());
  sendError(clientTxId,new OSecurityAccessException("Invalid user/password to shutdown the server"));
  try {
    Thread.sleep(1000);
  }
 catch (  InterruptedException e) {
  }
  channel.close();
}
