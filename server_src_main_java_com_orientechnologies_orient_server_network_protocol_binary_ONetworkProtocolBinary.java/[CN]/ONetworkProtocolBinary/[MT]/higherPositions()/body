{
  setDataCommandInfo("Retrieve higher positions");
  final int clusterId=channel.readInt();
  final OClusterPosition clusterPosition=channel.readClusterPosition();
  beginResponse();
  try {
    sendOk(clientTxId);
    OPhysicalPosition[] nextPositions=connection.database.getStorage().higherPhysicalPositions(clusterId,new OPhysicalPosition(clusterPosition));
    if (nextPositions != null) {
      channel.writeInt(nextPositions.length);
      for (      final OPhysicalPosition physicalPosition : nextPositions) {
        channel.writeClusterPosition(physicalPosition.clusterPosition);
        channel.writeInt(physicalPosition.dataSegmentId);
        channel.writeLong(physicalPosition.dataSegmentPos);
        channel.writeInt(physicalPosition.recordSize);
        channel.writeVersion(physicalPosition.recordVersion);
      }
    }
 else {
      channel.writeInt(0);
    }
  }
  finally {
    endResponse();
  }
}
