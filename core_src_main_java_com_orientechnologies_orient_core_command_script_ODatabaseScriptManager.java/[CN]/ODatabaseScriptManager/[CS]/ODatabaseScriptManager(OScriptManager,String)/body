{
  scriptManager=iScriptManager;
  name=iDatabaseName;
  pooledEngines=new OResourcePool<String,ScriptEngine>(OGlobalConfiguration.SCRIPT_POOL.getValueAsInteger(),new OResourcePoolListener<String,ScriptEngine>(){
    @Override public ScriptEngine createNewResource(    final String iLanguage,    final Object... iAdditionalArgs){
      final ScriptEngine scriptEngine=scriptManager.getEngine(iLanguage);
      final String library=scriptManager.getLibrary(ODatabaseRecordThreadLocal.INSTANCE.get(),iLanguage);
      if (library != null)       try {
        scriptEngine.eval(library);
      }
 catch (      ScriptException e) {
        scriptManager.throwErrorMessage(e,library);
      }
      return scriptEngine;
    }
    @Override public boolean reuseResource(    final String iKey,    final Object[] iAdditionalArgs,    final ScriptEngine iValue){
      if (iKey.equals("sql")) {
        if (!iKey.equals(iValue.getFactory().getLanguageName()))         return false;
      }
 else {
        if ((iValue.getFactory().getLanguageName()).equals("sql"))         return false;
      }
      return true;
    }
  }
);
}
