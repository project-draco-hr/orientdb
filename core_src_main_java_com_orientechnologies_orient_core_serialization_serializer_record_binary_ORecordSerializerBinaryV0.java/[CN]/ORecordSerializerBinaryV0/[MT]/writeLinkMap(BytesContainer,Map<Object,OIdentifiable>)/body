{
  short fullPos=OVarIntSerializer.write(bytes,map.size());
  for (  Entry<Object,OIdentifiable> entry : map.entrySet()) {
    OType type=getTypeFromValue(entry.getKey(),true);
    writeOType(bytes,bytes.alloc((short)1),type);
    writeSingleValue(bytes,entry.getKey(),type);
    writeOptimizedLink(bytes,entry.getValue());
  }
  return fullPos;
}
