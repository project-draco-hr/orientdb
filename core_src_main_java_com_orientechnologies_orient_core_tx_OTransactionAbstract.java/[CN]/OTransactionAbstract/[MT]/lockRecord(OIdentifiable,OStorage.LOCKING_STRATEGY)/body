{
  final OStorage stg=database.getStorage();
  if (!(stg.getUnderlying() instanceof OAbstractPaginatedStorage))   throw new OLockException("Cannot lock record across remote connections");
  final ORID rid=iRecord.getIdentity();
  if (iLockingStrategy == OStorage.LOCKING_STRATEGY.KEEP_EXCLUSIVE_LOCK)   ((OAbstractPaginatedStorage)stg.getUnderlying()).acquireWriteLock(rid);
 else   ((OAbstractPaginatedStorage)stg.getUnderlying()).acquireReadLock(rid);
  locks.put(rid,iLockingStrategy);
  return this;
}
