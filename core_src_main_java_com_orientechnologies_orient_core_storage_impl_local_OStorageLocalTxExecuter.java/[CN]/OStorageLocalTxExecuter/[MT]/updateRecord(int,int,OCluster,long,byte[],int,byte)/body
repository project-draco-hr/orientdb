{
  try {
    final ORawBuffer buffer=storage.readRecord(iRequesterId,iClusterSegment,iPosition,true);
    final long dataOffset;
    if (buffer.buffer != null) {
      dataOffset=storage.getDataSegment(storage.getDataSegmentForRecord(iClusterSegment,buffer.buffer)).addRecord(-1,-1,buffer.buffer);
    }
 else     dataOffset=-1;
    txSegment.addLog(OTxSegment.OPERATION_UPDATE,iRequesterId,iTxId,iClusterSegment.getId(),iPosition,dataOffset);
    return storage.updateRecord(iRequesterId,iClusterSegment,iPosition,iContent,iVersion,iRecordType);
  }
 catch (  IOException e) {
    OLogManager.instance().error(this,"Error on updating entry #" + iPosition + " in log segment: "+ iClusterSegment,e,OTransactionException.class);
  }
  return -1;
}
