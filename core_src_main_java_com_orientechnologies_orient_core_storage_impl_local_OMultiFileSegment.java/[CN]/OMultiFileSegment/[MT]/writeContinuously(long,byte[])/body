{
  readWriteLock.writeLock().lock();
  try {
    long[] pos=getRelativePosition(iPosition);
    OFile file;
    int remainingSize=iData.length;
    long offset=pos[1];
    for (int i=(int)pos[0]; remainingSize > 0; ++i) {
      file=files[i];
      if (remainingSize > file.getFilledUpTo() - offset) {
        if (file.getFilledUpTo() < offset) {
          throw new ODatabaseException("range check! " + file.getFilledUpTo() + " "+ offset);
        }
        file.write(offset,iData,(int)(file.getFilledUpTo() - offset),iData.length - remainingSize);
        remainingSize-=(file.getFilledUpTo() - offset);
      }
 else {
        file.write(offset,iData,remainingSize,iData.length - remainingSize);
        remainingSize=0;
      }
      offset=0;
    }
  }
  finally {
    readWriteLock.writeLock().unlock();
  }
}
