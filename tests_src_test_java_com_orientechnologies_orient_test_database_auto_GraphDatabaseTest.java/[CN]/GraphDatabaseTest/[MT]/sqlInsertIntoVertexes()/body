{
  List<OIdentifiable> vertices=database.command(new OCommandSQL("select from V limit 2")).execute();
  Assert.assertEquals(vertices.size(),2);
  OIdentifiable v1=((ODocument)vertices.get(0)).reload();
  OIdentifiable v2=((ODocument)vertices.get(1)).reload();
  final int v1Edges=database.getOutEdges(v1).size();
  final int v2Edges=database.getInEdges(v2).size();
  ODocument e=(ODocument)database.command(new OCommandSQL("insert into E SET out = ?, in = ?")).execute(v1,v2);
  database.command(new OCommandSQL("update " + v1.getIdentity() + " ADD out = "+ e.getIdentity())).execute();
  database.command(new OCommandSQL("update " + v2.getIdentity() + " ADD in = "+ e.getIdentity())).execute();
  ODocument doc1=((ODocument)v1.getRecord().reload());
  ODocument doc2=((ODocument)v2.getRecord().reload());
  Assert.assertEquals(database.getOutEdges(doc1).size(),v1Edges + 1);
  Assert.assertEquals(database.getInEdges(doc2).size(),v2Edges + 1);
}
