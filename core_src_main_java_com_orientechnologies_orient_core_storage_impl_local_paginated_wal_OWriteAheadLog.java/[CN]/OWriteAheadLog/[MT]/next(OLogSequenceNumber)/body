{
synchronized (syncObject) {
    int order=lsn.getSegment();
    int index=order - logSegments.get(0).getOrder();
    if (index < 0 || index >= logSegments.size())     return null;
    LogSegment logSegment=logSegments.get(index);
    OLogSequenceNumber nextLSN=logSegment.getNextLSN(lsn);
    if (nextLSN == null) {
      order++;
      index++;
      if (index >= logSegments.size())       return null;
      nextLSN=new OLogSequenceNumber(order,0);
    }
    return nextLSN;
  }
}
