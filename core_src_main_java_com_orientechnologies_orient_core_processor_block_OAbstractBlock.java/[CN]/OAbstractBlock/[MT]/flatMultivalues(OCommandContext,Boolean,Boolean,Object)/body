{
  if (OMultiValue.isMultiValue(value) && flatMultivalues != null && flatMultivalues) {
    Collection<Object> newColl;
    if (value instanceof Set<?>)     newColl=new HashSet<Object>();
 else     newColl=new ArrayList<Object>();
    for (    Object entry : OMultiValue.getMultiValueIterable(value)) {
      if (entry instanceof ODocument) {
        for (        String fieldName : ((ODocument)entry).fieldNames())         newColl.add(((ODocument)entry).field(fieldName));
      }
 else       OMultiValue.add(newColl,resolveValue(iContext,getValue(entry,copy),false));
    }
    return newColl;
  }
  return value;
}
