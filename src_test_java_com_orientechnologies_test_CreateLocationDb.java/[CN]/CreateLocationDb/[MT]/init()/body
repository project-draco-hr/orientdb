{
  String buildDirectory=System.getProperty("buildDirectory",".");
  if (buildDirectory == null)   buildDirectory=".";
  databaseDocumentTx=new ODatabaseDocumentTx("local:" + buildDirectory + "/location");
  if (databaseDocumentTx.exists()) {
    databaseDocumentTx.open("admin","admin");
    databaseDocumentTx.drop();
  }
  databaseDocumentTx.create();
  OSchema schema=databaseDocumentTx.getMetadata().getSchema();
  OClass oClass=schema.createClass("City");
  oClass.createProperty("latitude",OType.DOUBLE);
  oClass.createProperty("longitude",OType.DOUBLE);
  oClass.createProperty("name",OType.STRING);
  oClass.createIndex("City.latitude_longitude","SPATIAL",null,null,"LUCENE",new String[]{"latitude","longitude"});
  ZipFile zipFile=new ZipFile("files/location.csv.zip");
  Enumeration<? extends ZipEntry> entries=zipFile.entries();
  while (entries.hasMoreElements()) {
    ZipEntry entry=entries.nextElement();
    if (entry.getName().equals("location.csv")) {
      InputStream stream=zipFile.getInputStream(entry);
      reader=new CSVReader(new InputStreamReader(stream),',');
    }
  }
}
