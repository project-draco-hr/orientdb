{
  if (!enabled)   return;
  OLogManager.instance().warn(this,"Shutting down node %s...",getLocalNodeName());
  setNodeStatus(NODE_STATUS.SHUTDOWNING);
  if (messageService != null)   messageService.shutdown();
  super.shutdown();
  activeNodes.clear();
  if (membershipListenerRegistration != null) {
    hazelcastInstance.getCluster().removeMembershipListener(membershipListenerRegistration);
  }
  if (hazelcastInstance != null)   try {
    hazelcastInstance.shutdown();
  }
 catch (  Exception e) {
    OLogManager.instance().error(this,"Error on shutting down Hazelcast instance",e);
  }
 finally {
    hazelcastInstance=null;
  }
  setNodeStatus(NODE_STATUS.OFFLINE);
}
