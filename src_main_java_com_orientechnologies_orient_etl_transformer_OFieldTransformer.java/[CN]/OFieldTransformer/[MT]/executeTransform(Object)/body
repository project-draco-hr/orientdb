{
  if (input instanceof ODocument) {
    if (setOperation) {
      if (sqlFilter == null)       sqlFilter=new OSQLFilter(expression,context,null);
      final Object newValue=sqlFilter.evaluate((ODocument)input,null,context);
      ((ODocument)input).field(fieldName,newValue);
      log(OETLProcessor.LOG_LEVELS.DEBUG,"set %s=%s in document=%s",fieldName,newValue,input);
    }
 else {
      final Object prev=((ODocument)input).removeField(fieldName);
      log(OETLProcessor.LOG_LEVELS.DEBUG,"removed %s (value=%s) from document=%s",fieldName,prev,input);
    }
  }
  return input;
}
