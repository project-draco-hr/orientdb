{
  if (isClosed())   return;
  objects2Records.clear();
  records2Objects.clear();
  rid2Records.clear();
  checkOpeness();
  rollback();
  getMetadata().close();
  ((ODatabaseRaw)((ODatabaseRecord)underlying.getUnderlying()).getUnderlying()).callOnCloseListeners();
  getLevel1Cache().clear();
  final ODatabaseObjectPool pool=ownerPool;
  ownerPool=null;
  pool.release(this);
}
