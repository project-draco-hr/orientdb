{
  filesLock.acquireWriteLock();
  try {
    removeCachedPages(fileId);
    files.get(fileId).shrink(0);
  }
  finally {
    filesLock.releaseWriteLock();
  }
}
