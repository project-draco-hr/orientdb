{
  final String[] urlParts=iRequest.url.substring(1).split("/");
  if (urlParts.length < 2)   throw new OHttpRequestException("Syntax error in URL. Expected is: <command>/<database>[/...]");
  iRequest.databaseName=urlParts[1];
  iRequest.databaseName=iRequest.databaseName.replace(DBNAME_DIR_SEPARATOR,'/');
  if (iRequest.sessionId == null || (iRequest.sessionId != null && iRequest.sessionId.length() == 1)) {
    if (iRequest.authorization == null || SESSIONID_LOGOUT.equals(iRequest.sessionId)) {
      sendAuthorizationRequest(iRequest,iRequest.databaseName);
      return false;
    }
 else     return authenticate(iRequest,iRequest.databaseName);
  }
 else {
    if (iRequest.sessionId.length() > 1 && OHttpSessionManager.getInstance().getSession(iRequest.sessionId) == null) {
      sendAuthorizationRequest(iRequest,iRequest.databaseName);
      return false;
    }
    return true;
  }
}
