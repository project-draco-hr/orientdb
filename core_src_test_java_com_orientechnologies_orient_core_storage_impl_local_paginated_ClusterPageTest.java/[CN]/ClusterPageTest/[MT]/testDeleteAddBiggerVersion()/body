{
  ODirectMemoryPointer pagePointer=new ODirectMemoryPointer(new byte[OClusterPage.PAGE_SIZE + ODurablePage.PAGE_PADDING]);
  OCachePointer cachePointer=new OCachePointer(pagePointer,new OLogSequenceNumber(0,0));
  cachePointer.incrementReferrer();
  OCacheEntry cacheEntry=new OCacheEntry(0,0,cachePointer,false);
  try {
    OClusterPage localPage=new OClusterPage(cacheEntry,true,ODurablePage.TrackMode.FULL);
    ORecordVersion recordVersion=OVersionFactory.instance().createVersion();
    recordVersion.increment();
    recordVersion.increment();
    int position=localPage.appendRecord(recordVersion,new byte[]{1,2,3,4,5,6,5,4,3,2,1},false);
    Assert.assertTrue(localPage.deleteRecord(position));
    ORecordVersion newRecordVersion=OVersionFactory.instance().createVersion();
    newRecordVersion.increment();
    newRecordVersion.increment();
    newRecordVersion.increment();
    newRecordVersion.increment();
    Assert.assertEquals(localPage.appendRecord(newRecordVersion,new byte[]{2,2,2,4,5,6,5,4,2,2,2},false),position);
    int recordSize=localPage.getRecordSize(position);
    Assert.assertEquals(recordSize,11);
    Assert.assertEquals(localPage.getRecordVersion(position),newRecordVersion);
    Assert.assertEquals(localPage.getRecordBinaryValue(position,0,recordSize),new byte[]{2,2,2,4,5,6,5,4,2,2,2});
    assertChangesTracking(localPage,pagePointer);
  }
  finally {
    cachePointer.decrementReferrer();
  }
}
