{
  for (  List<OLogSequenceNumber> operationUnit : operationUnits.values()) {
    if (operationUnit.isEmpty())     continue;
    final OOperationUnitRecord atomicOperationRecord=(OOperationUnitRecord)writeAheadLog.read(operationUnit.get(0));
    final OAtomicUnitStartRecord startRecord;
    if (atomicOperationRecord instanceof OAtomicUnitStartRecord)     startRecord=(OAtomicUnitStartRecord)atomicOperationRecord;
 else {
      startRecord=(OAtomicUnitStartRecord)writeAheadLog.read(((OOperationUnitBodyRecord)atomicOperationRecord).getStartLsn());
    }
    if (!startRecord.isRollbackSupported())     continue;
    writeAheadLog.logAtomicOperationEndRecord(startRecord.getOperationUnitId(),true,startRecord.getLsn());
    List<OLogSequenceNumber> records=readOperationUnit(startRecord.getLsn(),startRecord.getOperationUnitId());
    undoOperation(records);
  }
}
