{
  final Class<? extends OFile> fileClass=registry.get(iType);
  if (fileClass == null)   throw new OConfigurationException("File type '" + iType + "' is not configured");
  try {
    final OFile f=fileClass.newInstance();
    f.init(iFileName,iOpenMode);
    return f;
  }
 catch (  final Exception e) {
    throw new OConfigurationException("Cannot create file of type '" + iType + "'",e);
  }
}
