{
  checkForRebuild();
  final List<Object> sortedKeys=new ArrayList<Object>(keys);
  Collections.sort(sortedKeys,ODefaultComparator.INSTANCE);
  acquireSharedLock();
  final Set<ODocument> result=new ODocumentFieldsHashSet();
  try {
    for (    final Object key : sortedKeys) {
      if (maxEntriesToFetch > -1 && result.size() == maxEntriesToFetch)       return result;
      final OIdentifiable val=indexEngine.get(key);
      if (val != null) {
        final ODocument document=new ODocument();
        document.field("key",key);
        document.field("rid",val.getIdentity());
        document.unsetDirty();
        result.add(document);
      }
    }
    return result;
  }
  finally {
    releaseSharedLock();
  }
}
