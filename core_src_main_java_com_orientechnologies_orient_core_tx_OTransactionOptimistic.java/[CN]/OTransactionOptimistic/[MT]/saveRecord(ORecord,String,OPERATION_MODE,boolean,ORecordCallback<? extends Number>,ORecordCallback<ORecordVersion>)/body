{
  if (iRecord == null)   return null;
  ORecord orignal=iRecord;
  ODirtyManager dirtyManager=ORecordInternal.getDirtyManager(orignal);
  Set<ORecord> newRecord=dirtyManager.getNewRecord();
  Set<ORecord> updatedRecord=dirtyManager.getUpdateRecord();
  dirtyManager.cleanForSave();
  if (newRecord != null) {
    for (    ORecord rec : newRecord) {
      addRecord(rec,ORecordOperation.CREATED,getClusterName(rec));
    }
  }
  if (updatedRecord != null) {
    for (    ORecord rec : updatedRecord) {
      addRecord(rec,ORecordOperation.UPDATED,getClusterName(rec));
    }
  }
  final byte operation=iForceCreate ? ORecordOperation.CREATED : iRecord.getIdentity().isValid() ? ORecordOperation.UPDATED : ORecordOperation.CREATED;
  addRecord(iRecord,operation,iClusterName);
  return iRecord;
}
