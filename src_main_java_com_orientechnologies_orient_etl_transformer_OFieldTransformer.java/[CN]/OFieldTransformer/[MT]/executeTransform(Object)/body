{
  if (input instanceof OIdentifiable) {
    final ORecord rec=((OIdentifiable)input).getRecord();
    if (rec instanceof ODocument) {
      final ODocument doc=(ODocument)rec;
      if (setOperation) {
        if (sqlFilter == null)         sqlFilter=new OSQLFilter(expression,context,null);
        final Object newValue=sqlFilter.evaluate(doc,null,context);
        doc.field(fieldName,newValue);
        log(OETLProcessor.LOG_LEVELS.DEBUG,"set %s=%s in document=%s",fieldName,newValue,doc);
      }
 else {
        final Object prev=doc.removeField(fieldName);
        log(OETLProcessor.LOG_LEVELS.DEBUG,"removed %s (value=%s) from document=%s",fieldName,prev,doc);
      }
    }
  }
  return input;
}
