{
  if (!isEnabled()) {
    if (rid.getClusterId() != excludedCluster)     return secondary.retrieveRecord(rid);
 else     return null;
  }
  ORecordInternal<?> record;
  underlying.lock(rid);
  try {
    record=underlying.get(rid);
    if (record == null) {
      record=secondary.retrieveRecord(rid);
      if (record != null)       underlying.put(record);
    }
  }
  finally {
    underlying.unlock(rid);
  }
  Orient.instance().getProfiler().updateCounter(record != null ? CACHE_HIT : CACHE_MISS,1L);
  return record;
}
