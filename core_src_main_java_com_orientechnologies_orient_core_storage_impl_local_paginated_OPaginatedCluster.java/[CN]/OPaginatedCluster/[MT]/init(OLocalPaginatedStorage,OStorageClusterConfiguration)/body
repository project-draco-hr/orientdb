{
  OFileUtils.checkValidName(config.getName());
  this.config=(OStoragePaginatedClusterConfiguration)config;
  this.compression=OCompressionFactory.INSTANCE.getCompression(this.config.compression);
  storageLocal=storage;
  final OAtomicOperationsManager atomicOperationsManager=storage.getAtomicOperationsManager();
  final OWriteAheadLog writeAheadLog=storage.getWALInstance();
  init(atomicOperationsManager,writeAheadLog);
  diskCache=storageLocal.getDiskCache();
  name=config.getName();
  this.id=config.getId();
  clusterPositionMap=new OClusterPositionMap(diskCache,name,writeAheadLog,atomicOperationsManager,this.config.useWal);
}
