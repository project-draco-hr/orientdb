{
  acquireExclusiveLock();
  try {
    storage=storageLocal;
    final ODiskCache diskCache=storage.getDiskCache();
    initStores(metadataConfigurationFileExtension,treeStateFileExtension);
    metadataStore.open();
    treeStateStore.open();
    filesMetadata=metadataStore.loadMetadata();
    for (int i=0; i < filesMetadata.length; i++) {
      OHashIndexFileLevelMetadata fileLevelMetadata=filesMetadata[i];
      if (fileLevelMetadata != null) {
        fileLevelIds[i]=diskCache.openFile(fileLevelMetadata.getFileName());
        diskCache.deleteFile(fileLevelIds[i]);
      }
    }
    metadataStore.delete();
    treeStateStore.delete();
    final long nullBucketId=diskCache.openFile(name + nullBucketFileExtension);
    diskCache.deleteFile(nullBucketId);
  }
 catch (  IOException ioe) {
    throw new OIndexException("Can not delete hash table with name " + name,ioe);
  }
 finally {
    releaseExclusiveLock();
  }
}
