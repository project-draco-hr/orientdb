{
  final ODatabaseRecord database=getDatabase();
  database.checkSecurity(ODatabaseSecurityResources.COMMAND,ORole.PERMISSION_READ);
  init(((OCommandRequestText)iRequest).getText());
  className=null;
  newRecords=null;
  content=null;
  parserRequiredKeyword("INSERT");
  parserRequiredKeyword("INTO");
  String subjectName=parserRequiredWord(true,"Invalid subject name. Expected cluster, class or index");
  if (subjectName.startsWith(OCommandExecutorSQLAbstract.CLUSTER_PREFIX))   clusterName=subjectName.substring(OCommandExecutorSQLAbstract.CLUSTER_PREFIX.length());
 else   if (subjectName.startsWith(OCommandExecutorSQLAbstract.INDEX_PREFIX))   indexName=subjectName.substring(OCommandExecutorSQLAbstract.INDEX_PREFIX.length());
 else {
    if (subjectName.startsWith(OCommandExecutorSQLAbstract.CLASS_PREFIX))     subjectName=subjectName.substring(OCommandExecutorSQLAbstract.CLASS_PREFIX.length());
    final OClass cls=database.getMetadata().getSchema().getClass(subjectName);
    if (cls == null)     throwParsingException("Class " + subjectName + " not found in database");
    className=cls.getName();
  }
  parserSkipWhiteSpaces();
  if (parserIsEnded())   throwSyntaxErrorException("Set of fields is missed. Example: (name, surname) or SET name = 'Bill'");
  final String temp=parseOptionalWord(true);
  if (temp.equals("CLUSTER")) {
    clusterName=parserRequiredWord(false);
    parserSkipWhiteSpaces();
    if (parserIsEnded())     throwSyntaxErrorException("Set of fields is missed. Example: (name, surname) or SET name = 'Bill'");
  }
 else   parserGoBack();
  newRecords=new ArrayList<Map<String,Object>>();
  if (parserGetCurrentChar() == '(') {
    parseValues();
  }
 else {
    parserNextWord(true," ,\r\n");
    if (parserGetLastWord().equals(KEYWORD_CONTENT)) {
      newRecords=null;
      parseContent();
    }
 else     if (parserGetLastWord().equals(KEYWORD_SET)) {
      final LinkedHashMap<String,Object> fields=new LinkedHashMap<String,Object>();
      newRecords.add(fields);
      parseSetFields(fields);
    }
  }
  return this;
}
