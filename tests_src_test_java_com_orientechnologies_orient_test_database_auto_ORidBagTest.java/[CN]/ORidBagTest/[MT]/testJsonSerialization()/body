{
  ODocument externalDoc=new ODocument();
  ODocument testDocument=new ODocument();
  ORidBag highLevelRidBag=new ORidBag();
  for (int i=0; i < 10; i++)   highLevelRidBag.add(new ODocument());
  testDocument.field("ridBag",highLevelRidBag);
  testDocument.field("externalDoc",externalDoc);
  final List<ODocument> embeddedList=new ArrayList<ODocument>();
  ODocument embeddedListDoc=new ODocument();
  ORidBag embeddedListDocRidBag=new ORidBag();
  for (int i=0; i < 10; i++)   embeddedListDocRidBag.add(new ODocument());
  embeddedListDoc.field("ridBag",embeddedListDocRidBag);
  embeddedListDoc.field("externalDoc",externalDoc);
  embeddedList.add(embeddedListDoc);
  Set<ODocument> embeddedSet=new HashSet<ODocument>();
  ODocument embeddedSetDoc=new ODocument();
  ORidBag embeddedSetDocRidBag=new ORidBag();
  for (int i=0; i < 10; i++)   embeddedSetDocRidBag.add(new ODocument());
  embeddedSetDoc.field("ridBag",embeddedSetDocRidBag);
  embeddedSetDoc.field("externalDoc",externalDoc);
  embeddedSet.add(embeddedSetDoc);
  Map<String,ODocument> embeddedMap=new HashMap<String,ODocument>();
  ODocument embeddedMapDoc=new ODocument();
  ORidBag embeddedMapDocRidBag=new ORidBag();
  for (int i=0; i < 10; i++)   embeddedMapDocRidBag.add(new ODocument());
  embeddedMapDoc.field("ridBag",embeddedMapDocRidBag);
  embeddedMapDoc.field("externalDoc",externalDoc);
  embeddedMap.put("k1",embeddedMapDoc);
  testDocument.field("embeddedList",embeddedList,OType.EMBEDDEDLIST);
  testDocument.field("embeddedSet",embeddedSet,OType.EMBEDDEDSET);
  testDocument.field("embeddedMap",embeddedMap,OType.EMBEDDEDMAP);
  testDocument.save();
  testDocument.reload();
  final String json=testDocument.toJSON();
  ODocument doc=new ODocument();
  doc.fromJSON(json);
  Assert.assertTrue(ODocumentHelper.hasSameContentOf(doc,db,testDocument,db,null));
}
