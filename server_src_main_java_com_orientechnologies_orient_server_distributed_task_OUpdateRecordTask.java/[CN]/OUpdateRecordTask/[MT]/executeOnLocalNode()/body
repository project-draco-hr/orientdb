{
  ODistributedServerLog.debug(this,getDistributedServerManager().getLocalNodeId(),getNodeSource(),DIRECTION.IN,"updating record %s/%s v.%s oper=%d.%d",databaseName,rid.toString(),version.toString(),runId,operationSerial);
  final ORecordInternal<?> record=Orient.instance().getRecordFactoryManager().newInstance(recordType);
  final ODatabaseDocumentTx database=openDatabase();
  try {
    record.fill(rid,version,content,true);
    record.save();
    ODistributedServerLog.debug(this,getDistributedServerManager().getLocalNodeId(),getNodeSource(),DIRECTION.IN,"updated record %s/%s v.%s oper=%d.%d",databaseName,rid.toString(),record.getRecordVersion().toString(),runId,operationSerial);
    return record.getRecordVersion();
  }
  finally {
    closeDatabase(database);
  }
}
