{
  String cacheKey=null;
  if (SALT_CACHE != null) {
    cacheKey=iPassword + "|" + Arrays.toString(salt)+ "|"+ iterations+ "|"+ bytes;
    final byte[] encoded=SALT_CACHE.get(cacheKey);
    if (encoded != null)     return encoded;
  }
  final PBEKeySpec spec=new PBEKeySpec(iPassword.toCharArray(),salt,iterations,bytes * 8);
  final SecretKeyFactory skf;
  try {
    skf=SecretKeyFactory.getInstance(PBKDF2_ALGORITHM);
    final byte[] encoded=skf.generateSecret(spec).getEncoded();
    if (SALT_CACHE != null) {
      SALT_CACHE.put(cacheKey,encoded);
    }
    return encoded;
  }
 catch (  Exception e) {
    throw new OSecurityException("Cannot create a key with '" + PBKDF2_ALGORITHM + "' algorithm",e);
  }
}
