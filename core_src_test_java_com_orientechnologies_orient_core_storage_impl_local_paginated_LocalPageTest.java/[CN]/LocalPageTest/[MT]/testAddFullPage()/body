{
  long pagePointer=directMemory.allocate(new byte[OLocalPage.PAGE_SIZE]);
  try {
    OLocalPage localPage=new OLocalPage(pagePointer,true);
    List<Integer> positions=new ArrayList<Integer>();
    int lastPosition;
    byte counter=0;
    int freeSpace=localPage.getFreeSpace();
    Assert.assertEquals(freeSpace,OLocalPage.PAGE_SIZE - 5 * OIntegerSerializer.INT_SIZE);
    do {
      lastPosition=localPage.appendRecord(new byte[]{counter,counter,counter});
      if (lastPosition >= 0) {
        Assert.assertEquals(lastPosition,positions.size());
        positions.add(lastPosition);
        counter++;
        Assert.assertEquals(localPage.getFreeSpace(),freeSpace - 11);
        freeSpace=localPage.getFreeSpace();
      }
    }
 while (lastPosition >= 0);
    Assert.assertEquals(localPage.getRecordsCount(),5956);
    counter=0;
    for (    int position : positions) {
      long pointer=localPage.getRecordPointer(position);
      Assert.assertEquals(directMemory.get(pointer,3),new byte[]{counter,counter,counter});
      counter++;
    }
  }
  finally {
    directMemory.free(pagePointer);
  }
}
