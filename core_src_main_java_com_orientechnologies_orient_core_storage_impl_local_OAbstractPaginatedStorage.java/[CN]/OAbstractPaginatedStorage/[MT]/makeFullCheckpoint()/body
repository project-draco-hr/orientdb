{
  if (writeAheadLog == null)   return;
  try {
    writeAheadLog.flush();
    if (configuration != null)     configuration.synch();
    final OLogSequenceNumber lastLSN=writeAheadLog.logFullCheckpointStart();
    diskCache.flushBuffer();
    writeAheadLog.logFullCheckpointEnd();
    writeAheadLog.flush();
    writeAheadLog.cutTill(lastLSN);
    clearStorageDirty();
  }
 catch (  IOException ioe) {
    throw new OStorageException("Error during checkpoint creation for storage " + name,ioe);
  }
}
