{
  checkOpeness();
  if (record == null)   throw new ODatabaseException("Cannot delete null document");
  if (record instanceof ODocument && ((ODocument)record).getClassName() != null)   checkSecurity(ORule.ResourceGeneric.CLASS,ORole.PERMISSION_DELETE,((ODocument)record).getClassName());
  final OTransaction originalTx=wrapInImplicitTxIfRequired();
  try {
    currentTx.deleteRecord(record,OPERATION_MODE.SYNCHRONOUS);
  }
 catch (  OException e) {
    unwrapIfWasWrappedInImplicitTx(originalTx,false);
    throw e;
  }
catch (  final Exception e) {
    unwrapIfWasWrappedInImplicitTx(originalTx,false);
    if (record instanceof ODocument)     throw OException.wrapException(new ODatabaseException("Error on deleting record " + record.getIdentity() + " of class '"+ ((ODocument)record).getClassName()+ "'"),e);
 else     throw OException.wrapException(new ODatabaseException("Error on deleting record " + record.getIdentity()),e);
  }
  unwrapIfWasWrappedInImplicitTx(originalTx,true);
  return this;
}
