{
  final OrientGraphNoTx g;
  if (pool == null) {
    g=(OrientGraphNoTx)new OrientGraphNoTx(getDatabase(),user,password,settings);
    initGraph(g);
  }
 else {
    if (transactional)     throw new IllegalStateException("Cannot create a non-transactional graph instance after the pool has been set as transactional");
    return (OrientGraphNoTx)pool.getResource(url,0,user,password);
  }
  return g;
}
