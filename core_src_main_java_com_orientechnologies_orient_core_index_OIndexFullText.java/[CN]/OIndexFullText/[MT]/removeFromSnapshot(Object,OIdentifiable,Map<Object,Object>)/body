{
  final List<String> words=splitIntoWords(key.toString());
  for (  final String word : words) {
    final Set<OIdentifiable> recs;
    final Object snapshotValue=snapshot.get(word);
    if (snapshotValue == null)     recs=indexEngine.get(word);
 else     if (snapshotValue.equals(RemovedValue.INSTANCE))     recs=null;
 else     recs=(Set<OIdentifiable>)snapshotValue;
    if (recs != null && !recs.isEmpty()) {
      if (recs.remove(value)) {
        if (recs.isEmpty())         snapshot.put(word,RemovedValue.INSTANCE);
 else         snapshot.put(word,recs);
      }
    }
  }
}
