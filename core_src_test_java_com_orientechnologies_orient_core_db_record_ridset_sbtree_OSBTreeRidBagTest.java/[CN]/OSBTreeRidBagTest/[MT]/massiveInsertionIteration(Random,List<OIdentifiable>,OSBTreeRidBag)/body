{
  Iterator<OIdentifiable> ridsIterator=rids.iterator();
  Iterator<OIdentifiable> bagIterator=bag.iterator();
  while (ridsIterator.hasNext()) {
    assertTrue(bagIterator.hasNext());
    OIdentifiable ridValue=ridsIterator.next();
    OIdentifiable bagValue=bagIterator.next();
    assertEquals(bagValue,ridValue);
  }
  for (int i=0; i < 100; i++) {
    if (rnd.nextDouble() < 0.2 & rids.size() > 5) {
      final int index=rnd.nextInt(rids.size());
      final OIdentifiable rid=rids.remove(index);
      bag.remove(rid);
    }
 else {
      final int positionIndex=rnd.nextInt(300);
      final OClusterPosition position=OClusterPositionFactory.INSTANCE.valueOf(positionIndex);
      final ORecordId recordId=new ORecordId(1,position);
      rids.add(recordId);
      bag.add(recordId);
    }
  }
  Collections.sort(rids);
  ridsIterator=rids.iterator();
  bagIterator=bag.iterator();
  while (ridsIterator.hasNext()) {
    assertTrue(bagIterator.hasNext());
    OIdentifiable ridValue=ridsIterator.next();
    OIdentifiable bagValue=bagIterator.next();
    assertEquals(bagValue,ridValue);
    if (rnd.nextDouble() < 0.05) {
      ridsIterator.remove();
      bagIterator.remove();
    }
  }
  ridsIterator=rids.iterator();
  bagIterator=bag.iterator();
  while (ridsIterator.hasNext()) {
    assertTrue(bagIterator.hasNext());
    OIdentifiable ridValue=ridsIterator.next();
    OIdentifiable bagValue=bagIterator.next();
    assertEquals(bagValue,ridValue);
  }
}
