{
  Boolean durableInNonTxMode;
  Object durable=null;
  ODurablePage.TrackMode trackMode=null;
  if (metadata != null) {
    durable=metadata.field("durableInNonTxMode");
    if (metadata.field("trackMode") instanceof String) {
      try {
        trackMode=ODurablePage.TrackMode.valueOf(metadata.<String>field("trackMode"));
      }
 catch (      IllegalArgumentException e) {
        OLogManager.instance().error(this,"Invalid track mode",e);
      }
    }
  }
  if (durable instanceof Boolean)   durableInNonTxMode=(Boolean)durable;
 else   durableInNonTxMode=null;
  if (OClass.INDEX_TYPE.UNIQUE.toString().equals(indexType)) {
    return new OIndexUnique(indexType,SBTREE_ALGORITHM,new OSBTreeIndexEngine<OIdentifiable>(durableInNonTxMode,trackMode),valueContainerAlgorithm,metadata);
  }
 else   if (OClass.INDEX_TYPE.NOTUNIQUE.toString().equals(indexType)) {
    return new OIndexNotUnique(indexType,SBTREE_ALGORITHM,new OSBTreeIndexEngine<Set<OIdentifiable>>(durableInNonTxMode,trackMode),valueContainerAlgorithm,metadata);
  }
 else   if (OClass.INDEX_TYPE.FULLTEXT.toString().equals(indexType)) {
    return new OIndexFullText(indexType,SBTREE_ALGORITHM,new OSBTreeIndexEngine<Set<OIdentifiable>>(durableInNonTxMode,trackMode),valueContainerAlgorithm,metadata);
  }
 else   if (OClass.INDEX_TYPE.DICTIONARY.toString().equals(indexType)) {
    return new OIndexDictionary(indexType,SBTREE_ALGORITHM,new OSBTreeIndexEngine<OIdentifiable>(durableInNonTxMode,trackMode),valueContainerAlgorithm,metadata);
  }
  throw new OConfigurationException("Unsupported type : " + indexType);
}
