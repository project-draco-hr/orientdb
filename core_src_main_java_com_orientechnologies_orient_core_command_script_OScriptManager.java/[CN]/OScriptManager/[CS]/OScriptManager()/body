{
  scriptEngineManager=new ScriptEngineManager();
  registerSharedEngine(OSQLScriptEngine.NAME,new OSQLScriptEngineFactory().getScriptEngine());
  for (  ScriptEngineFactory f : scriptEngineManager.getEngineFactories()) {
    if (f.getParameter("THREADING") != null)     registerSharedEngine(f.getLanguageName().toLowerCase(),f.getScriptEngine());
 else     registerEngine(f.getLanguageName().toLowerCase(),f);
    if (defaultLanguage == null)     defaultLanguage=f.getLanguageName();
  }
  if (!existsEngine(DEF_LANGUAGE)) {
    final ScriptEngine defEngine=scriptEngineManager.getEngineByName(DEF_LANGUAGE);
    if (defEngine == null) {
      OLogManager.instance().warn(this,"Cannot find default script language for %s",DEF_LANGUAGE);
    }
 else {
      registerEngine(DEF_LANGUAGE,defEngine.getFactory());
      defaultLanguage=DEF_LANGUAGE;
    }
  }
  registerFormatter(OSQLScriptEngine.NAME,new OSQLScriptFormatter());
  registerFormatter(DEF_LANGUAGE,new OJSScriptFormatter());
  registerFormatter("ruby",new ORubyScriptFormatter());
}
