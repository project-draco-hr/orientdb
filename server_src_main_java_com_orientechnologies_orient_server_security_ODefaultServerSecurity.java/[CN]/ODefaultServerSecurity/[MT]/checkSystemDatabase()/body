{
  ODatabaseDocumentInternal oldDbInThread=ODatabaseRecordThreadLocal.INSTANCE.getIfDefined();
  try {
    ODatabaseDocumentTx sysDB=new ODatabaseDocumentTx("plocal:" + getSystemDbPath());
    if (!sysDB.exists()) {
      OLogManager.instance().info(this,"Creating the System Database");
      Map<OGlobalConfiguration,Object> settings=new ConcurrentHashMap<OGlobalConfiguration,Object>();
      settings.put(OGlobalConfiguration.CREATE_DEFAULT_USERS,false);
      settings.put(OGlobalConfiguration.CLASS_MINIMUM_CLUSTERS,1);
      sysDB.create(settings);
      sysDB.close();
    }
  }
 catch (  Exception ex) {
    OLogManager.instance().error(this,"checkSystemDatabase() Exception: %s",ex.getMessage());
  }
 finally {
    if (oldDbInThread != null) {
      ODatabaseRecordThreadLocal.INSTANCE.set(oldDbInThread);
    }
 else {
      ODatabaseRecordThreadLocal.INSTANCE.remove();
    }
  }
}
