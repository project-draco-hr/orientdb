{
  OClientSessions session;
synchronized (sessions) {
    session=new OClientSessions(tokenBytes,token);
    sessions.put(new OHashToken(tokenBytes),session);
  }
  connection.tokenBytes=tokenBytes;
  connection.tokenBased=true;
  connection.token=token;
  session.addConnection(connection);
  OLogManager.instance().config(this,"Remote client connected from: " + connection);
  return connection;
}
