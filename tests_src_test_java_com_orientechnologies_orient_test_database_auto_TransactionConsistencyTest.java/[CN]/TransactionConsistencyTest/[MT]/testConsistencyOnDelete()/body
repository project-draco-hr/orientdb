{
  OGraphDatabase db=new OGraphDatabase(url);
  db.open("admin","admin");
  if (db.getVertexType("Foo") == null)   db.createVertexType("Foo");
  try {
    db.createVertex("Foo").field("address","test1").save();
    db.createVertex("Foo").field("address","test2").save();
    db.createVertex("Foo").field("address","test3").save();
    List<ODocument> result=db.query(new OSQLSynchQuery<ODocument>("select * from Foo"));
    for (    ODocument d : result) {
      System.out.println("Vertex: " + d);
    }
    db.begin(TXTYPE.OPTIMISTIC);
    result=db.query(new OSQLSynchQuery<ODocument>("select * from Foo where address = 'test1'"));
    Assert.assertEquals(1,result.size());
    db.removeVertex(result.get(0));
    result=db.query(new OSQLSynchQuery<ODocument>("select * from Foo where address = 'test2'"));
    Assert.assertEquals(1,result.size());
    db.removeVertex(result.get(0));
    result=db.query(new OSQLSynchQuery<ODocument>("select * from Foo where address = 'test3'"));
    Assert.assertEquals(1,result.size());
    db.removeVertex(result.get(0));
    db.commit();
    result=db.query(new OSQLSynchQuery<ODocument>("select * from Foo"));
    for (    ODocument d : result) {
      System.out.println("Vertex: " + d);
    }
  }
  finally {
    db.close();
  }
}
