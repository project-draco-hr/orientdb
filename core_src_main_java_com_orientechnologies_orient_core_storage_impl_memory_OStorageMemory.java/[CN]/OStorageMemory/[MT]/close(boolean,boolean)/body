{
  if (!checkForClose(iForce))   return;
  final long timer=Orient.instance().getProfiler().startChrono();
  lock.acquireExclusiveLock();
  try {
    status=STATUS.CLOSING;
    super.close(iForce,onDelete);
    for (    OClusterMemory c : clusters)     if (c != null)     c.close();
    clusters.clear();
    clusterMap.clear();
    for (    ODataSegmentMemory d : dataSegments)     if (d != null)     d.close();
    dataSegments.clear();
    level2Cache.shutdown();
    Orient.instance().unregisterStorage(this);
    status=STATUS.CLOSED;
  }
  finally {
    lock.releaseExclusiveLock();
    Orient.instance().getProfiler().stopChrono("db." + name + ".close","Close a database",timer,"db.*.close");
  }
}
