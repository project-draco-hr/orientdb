{
  this.syncOnPageFlush=syncOnPageFlush;
  this.writeAheadLog=writeAheadLog;
  this.pageSize=pageSize;
  this.storageLocal=storageLocal;
  long tmpMaxSize=maxMemory / pageSize;
  if (tmpMaxSize >= Integer.MAX_VALUE) {
    maxSize=Integer.MAX_VALUE;
  }
 else {
    maxSize=(int)tmpMaxSize;
  }
  int writeCacheSize=maxSize / 16;
  int readCacheSize=maxSize - writeCacheSize;
  writeCache=new OWOWCache(files,syncOnPageFlush,pageSize,writeGroupTTL,writeAheadLog,pageFlushInterval,writeCacheSize);
  readCache=new O2QReadCache(files,pageSize);
}
