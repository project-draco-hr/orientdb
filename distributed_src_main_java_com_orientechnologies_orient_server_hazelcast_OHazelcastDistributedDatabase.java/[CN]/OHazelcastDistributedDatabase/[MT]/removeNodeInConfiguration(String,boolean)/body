{
  try {
    final ODistributedConfiguration cfg=manager.getDatabaseConfiguration(databaseName);
    if (!cfg.isHotAlignment()) {
      final List<String> foundPartition=cfg.removeNodeInServerList(iNode,iForce);
      if (foundPartition != null) {
        ODistributedServerLog.info(this,getLocalNodeName(),null,ODistributedServerLog.DIRECTION.NONE,"removing node '%s' in partitions: db=%s %s",iNode,databaseName,foundPartition);
        msgService.removeQueue(OHazelcastDistributedMessageService.getRequestQueueName(iNode,databaseName));
        msgService.removeQueue(OHazelcastDistributedMessageService.getRequestQueueName(iNode,databaseName + OCreateRecordTask.SUFFIX_QUEUE_NAME));
      }
      manager.updateCachedDatabaseConfiguration(databaseName,cfg.serialize(),true,true);
    }
  }
 catch (  Exception e) {
    ODistributedServerLog.debug(this,getLocalNodeName(),null,ODistributedServerLog.DIRECTION.NONE,"unable to remove node or change mastership for '%s' in distributed configuration, db=%s",e,iNode,databaseName);
  }
}
