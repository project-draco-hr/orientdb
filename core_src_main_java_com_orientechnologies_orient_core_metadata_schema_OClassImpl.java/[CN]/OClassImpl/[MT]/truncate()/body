{
  getDatabase().checkSecurity(ODatabaseSecurityResources.CLASS,ORole.PERMISSION_UPDATE);
  getDatabase().getStorage().callInLock(new Callable<Object>(){
    public Object call() throws Exception {
      for (      int id : clusterIds) {
        final OStorage storage=getDatabase().getStorage();
        storage.getClusterById(id).truncate();
        storage.getLevel2Cache().freeCluster(id);
      }
      for (      OIndex<?> index : getClassIndexes()) {
        index.clear();
      }
      return null;
    }
  }
,true);
}
