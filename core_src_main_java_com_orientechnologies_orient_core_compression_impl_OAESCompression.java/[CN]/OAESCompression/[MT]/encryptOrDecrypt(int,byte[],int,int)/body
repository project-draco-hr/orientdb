{
  if (!initialized)   throw new OSecurityException("aes-encrypted compression is not available");
  SecretKeySpec ks=new SecretKeySpec(key,algorithmName);
  Cipher cipher=Cipher.getInstance(transformation);
  cipher.init(mode,ks);
  byte[] content;
  if (offset == 0 && length == input.length) {
    content=input;
  }
 else {
    content=new byte[length];
    System.arraycopy(input,offset,content,0,length);
  }
  byte[] output=cipher.doFinal(content);
  return output;
}
