{
  OAtomicOperation atomicOperation=storage.getAtomicOperationsManager().getCurrentOperation();
  long nextPage=removedLink;
  do {
    removedLink=nextPage;
    OCacheEntry valueEntry=loadPage(atomicOperation,fileId,removedLink,false,diskCache);
    try {
      OSBTreeValuePage valuePage=new OSBTreeValuePage(valueEntry,getChangesTree(atomicOperation,valueEntry),false);
      nextPage=valuePage.getNextPage();
    }
  finally {
      diskCache.release(valueEntry);
    }
    removeValuePage(removedLink);
  }
 while (nextPage >= 0);
}
