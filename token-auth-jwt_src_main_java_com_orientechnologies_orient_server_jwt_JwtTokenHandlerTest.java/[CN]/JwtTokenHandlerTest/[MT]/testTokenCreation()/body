{
  ODatabaseDocumentTx db=new ODatabaseDocumentTx("memory:" + JwtTokenHandlerTest.class.getSimpleName());
  db.create();
  OSecurityUser original=db.getUser();
  JwtTokenHandler handler=new JwtTokenHandler();
  handler.config(null,new OServerParameterConfiguration[]{new OServerParameterConfiguration(JwtTokenHandler.O_SIGN_KEY,"crappy key")});
  byte[] token=handler.getSignedWebToken(db,original);
  OToken tok=handler.parseWebToken(token);
  assertNotNull(tok);
  assertTrue(tok.getIsVerified());
  OUser user=tok.getUser(db);
  assertEquals(user.getName(),original.getName());
  boolean boole=handler.validateToken(tok,"open",db.getName());
  assertTrue(boole);
  assertTrue(tok.getIsValid());
}
