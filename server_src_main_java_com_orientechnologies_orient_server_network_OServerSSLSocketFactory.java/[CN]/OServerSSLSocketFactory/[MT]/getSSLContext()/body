{
  try {
    SSLContext context=SSLContext.getInstance("TLS");
    KeyManagerFactory kmf=KeyManagerFactory.getInstance(KeyManagerFactory.getDefaultAlgorithm());
    TrustManagerFactory tmf=TrustManagerFactory.getInstance(TrustManagerFactory.getDefaultAlgorithm());
    KeyStore keyStore=KeyStore.getInstance(keyStoreType);
    char[] keyStorePass=keyStorePassword.toCharArray();
    keyStore.load(new FileInputStream(keyStoreFile),keyStorePass);
    KeyStore trustStore=KeyStore.getInstance(trustStoreType);
    char[] trustStorePass=trustStorePassword.toCharArray();
    trustStore.load(new FileInputStream(trustStoreFile),trustStorePass);
    kmf.init(keyStore,keyStorePass);
    tmf.init(trustStore);
    context.init(kmf.getKeyManagers(),tmf.getTrustManagers(),null);
    return context;
  }
 catch (  Exception e) {
    throw new OConfigurationException("Failed to create SSL context",e);
  }
}
