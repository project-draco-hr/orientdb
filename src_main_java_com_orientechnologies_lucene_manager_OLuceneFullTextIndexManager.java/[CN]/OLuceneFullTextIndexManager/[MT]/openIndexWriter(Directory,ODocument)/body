{
  Analyzer analyzer=getAnalyzer(metadata);
  Version version=getLuceneVersion(metadata);
  IndexWriterConfig iwc=new IndexWriterConfig(version,analyzer);
  iwc.setOpenMode(IndexWriterConfig.OpenMode.APPEND);
  OLogManager.instance().debug(this,"Opening Lucene index in '%s'...",directory);
  return new IndexWriter(directory,iwc);
}
