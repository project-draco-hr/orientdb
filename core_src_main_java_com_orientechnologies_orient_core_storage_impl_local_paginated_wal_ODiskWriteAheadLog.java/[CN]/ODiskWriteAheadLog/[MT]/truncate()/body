{
  syncObject.lock();
  try {
    if (logSegments.size() < 2)     return;
    ListIterator<LogSegment> iterator=logSegments.listIterator(logSegments.size() - 1);
    while (iterator.hasPrevious()) {
      final LogSegment logSegment=iterator.previous();
      logSegment.delete(false);
      iterator.remove();
    }
    recalculateLogSize();
  }
  finally {
    syncObject.unlock();
  }
}
