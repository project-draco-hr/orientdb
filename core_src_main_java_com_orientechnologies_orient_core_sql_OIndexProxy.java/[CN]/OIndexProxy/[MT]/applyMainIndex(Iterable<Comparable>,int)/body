{
  Collection<T> resultSet=new TreeSet<T>();
  for (  Comparable key : currentKeys) {
    final T result=index.get(index.getDefinition().createValue(key));
    if (result instanceof Set) {
      for (      T o : (Set<T>)result) {
        resultSet.add(o);
        if (maxValuesToFetch != -1 && resultSet.size() >= maxValuesToFetch) {
          break;
        }
      }
    }
 else {
      resultSet.add(result);
    }
    if (maxValuesToFetch != -1 && resultSet.size() >= maxValuesToFetch) {
      break;
    }
  }
  updateStatistic(index);
  return resultSet;
}
