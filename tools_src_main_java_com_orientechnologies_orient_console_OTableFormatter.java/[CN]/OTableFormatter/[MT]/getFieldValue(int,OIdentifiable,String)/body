{
  Object value=null;
  if (iColumnName.equals("#"))   value=iIndex;
 else   if (iColumnName.equals("@RID"))   value=iRecord.getIdentity().toString();
 else   if (iRecord instanceof ODocument)   value=((ODocument)iRecord).field(iColumnName);
 else   if (iRecord instanceof ORecordBytes)   value="<binary> (size=" + ((ORecordBytes)iRecord).toStream().length + " bytes)";
 else   if (iRecord instanceof OIdentifiable) {
    final ORecord rec=iRecord.getRecord();
    if (rec instanceof ODocument)     value=((ODocument)rec).field(iColumnName);
 else     if (rec instanceof ORecordBytes)     value="<binary> (size=" + ((ORecordBytes)rec).toStream().length + " bytes)";
  }
  if (value instanceof OMultiCollectionIterator<?>)   value="[" + ((OMultiCollectionIterator<?>)value).size() + "]";
 else   if (value instanceof Collection<?>)   value="[" + ((Collection<?>)value).size() + "]";
 else   if (value instanceof ORecord) {
    if (((ORecord)value).getIdentity().equals(ORecordId.EMPTY_RECORD_ID)) {
      value=((ORecord)value).toString();
    }
 else {
      value=((ORecord)value).getIdentity().toString();
    }
  }
 else   if (value instanceof Date) {
    final ODatabaseRecord db=ODatabaseRecordThreadLocal.INSTANCE.getIfDefined();
    if (db != null)     value=db.getStorage().getConfiguration().getDateTimeFormatInstance().format((Date)value);
 else {
      value=DEF_DATEFORMAT.format((Date)value);
    }
  }
 else   if (value instanceof byte[])   value="byte[" + ((byte[])value).length + "]";
  return value;
}
