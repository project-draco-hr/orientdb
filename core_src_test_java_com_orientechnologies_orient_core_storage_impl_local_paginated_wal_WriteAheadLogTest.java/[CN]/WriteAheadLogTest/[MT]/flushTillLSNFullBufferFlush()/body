{
  List<OWALRecord> writtenRecords=new ArrayList<OWALRecord>();
  Random rnd=new Random();
  final int recordsToWrite=80;
  for (int i=0; i < recordsToWrite; i++) {
    byte[] data=new byte[10];
    rnd.nextBytes(data);
    int pageOffset=rnd.nextInt(65536);
    long pageIndex=rnd.nextLong();
    OSetPageDataRecord setPageDataRecord=new OSetPageDataRecord(data,pageOffset,pageIndex,"test");
    writtenRecords.add(setPageDataRecord);
    writeAheadLog.logRecord(setPageDataRecord);
  }
  writeAheadLog.flushTillLSN(writtenRecords.get(70).getLsn());
  writeAheadLog.close();
  writeAheadLog=createWAL();
  assertLogContent(writeAheadLog,writtenRecords);
}
