{
synchronized (rndFile) {
    long pagesCount=rndFile.length() / OWALPage.PAGE_SIZE;
    long currentPage=pagesCount - 1;
    if (currentPage < 0)     return;
    do {
      rndFile.seek(currentPage * OWALPage.PAGE_SIZE);
      byte[] content=new byte[OWALPage.PAGE_SIZE];
      rndFile.readFully(content);
      ODirectMemoryPointer pointer=new ODirectMemoryPointer(content);
      try {
        final OWALPage page=new OWALPage(pointer,false);
        int lastPosition=findLastRecord(page,true);
        if (lastPosition > -1) {
          last=new OLogSequenceNumber(order,currentPage * OWALPage.PAGE_SIZE + lastPosition);
          return;
        }
        currentPage--;
      }
  finally {
        pointer.free();
      }
    }
 while (currentPage >= 0);
  }
}
