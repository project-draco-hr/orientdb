{
  if (key == null)   return OMVRBTreeThreadLocal.INSTANCE.push(null,null);
  pageItemFound=false;
  if (size == 0) {
    pageIndex=0;
    return iGetContainer ? root : null;
  }
  OMVRBTreeEntry<K,V> p=getBestEntryPoint(key);
  checkTreeStructure(p);
  if (p == null)   return OMVRBTreeThreadLocal.INSTANCE.push(key,null);
  OMVRBTreeEntry<K,V> lastNode=p;
  OMVRBTreeEntry<K,V> prevNode=null;
  OMVRBTreeEntry<K,V> tmpNode;
  int beginKey=-1;
  int steps=-1;
  final Comparable<? super K> k=(Comparable<? super K>)key;
  try {
    while (p != null && p.getSize() > 0) {
      steps++;
      lastNode=p;
      if (comparator != null)       beginKey=comparator.compare((K)key,p.getFirstKey());
 else       try {
        beginKey=k.compareTo(p.getFirstKey());
      }
 catch (      Exception e) {
      }
      if (beginKey == 0) {
        pageIndex=0;
        pageItemFound=true;
        pageItemComparator=0;
        return OMVRBTreeThreadLocal.INSTANCE.push(key,p);
      }
      if (comparator != null)       pageItemComparator=comparator.compare((K)key,p.getLastKey());
 else       pageItemComparator=k.compareTo(p.getLastKey());
      if (beginKey < 0) {
        if (pageItemComparator < 0) {
          tmpNode=predecessor(p);
          if (tmpNode != null && tmpNode != prevNode) {
            prevNode=p;
            p=tmpNode;
            continue;
          }
        }
      }
 else       if (beginKey > 0) {
        if (pageItemComparator > 0) {
          tmpNode=successor(p);
          if (tmpNode != null && tmpNode != prevNode) {
            prevNode=p;
            p=tmpNode;
            continue;
          }
        }
      }
      final V value=lastNode.search(k);
      OMVRBTreeThreadLocal.INSTANCE.push(key,lastNode);
      if (value != null || iGetContainer)       return lastNode;
      return null;
    }
  }
  finally {
    checkTreeStructure(p);
    OProfiler.getInstance().updateStat("[OMVRBTree.getEntry] Steps of search",steps);
  }
  return OMVRBTreeThreadLocal.INSTANCE.push(key,null);
}
