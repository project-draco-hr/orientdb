{
  if (writeAheadLog != null) {
    OPageChanges pageChanges=localPage.getPageChanges();
    if (pageChanges.isEmpty())     return;
    OLogSequenceNumber prevLsn;
    if (isNewPage)     prevLsn=startLSN;
 else     prevLsn=localPage.getLsn();
    OLogSequenceNumber lsn=writeAheadLog.log(new OUpdatePageRecord(pageIndex,fileId,unitId,pageChanges,prevLsn));
    localPage.setLsn(lsn);
  }
}
