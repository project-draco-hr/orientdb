{
  final ORecordOperation op=new ORecordOperation();
  int[] aligned=new int[3];
  final OReplicationLog log=getLog(iNodeId);
  for (int i=0; log.needAlignment() && i < log.totalEntries(); ++i) {
    try {
      log.getEntry(i,op);
    }
 catch (    IOException e) {
      OLogManager.instance().error(this,"DISTRIBUTED -> align failed for log entry %d",e,i);
      return aligned;
    }
    if (op.type < 0)     continue;
    final ORecordId rid=(ORecordId)op.record.getIdentity();
    final ORawBuffer record=storage.readRecord(rid,null,false,null);
    if (record == null && op.type != ORecordOperation.DELETED)     OLogManager.instance().warn(this,"DISTRIBUTED -> align failed for record %s because doesn't exist anymore",rid);
 else {
      cluster.executeOperation(iNodeId,op.type,storageName,rid,op.version,record,EXECUTION_MODE.SYNCHRONOUS);
      if (op.type == ORecordOperation.CREATED)       aligned[0]++;
 else       if (op.type == ORecordOperation.UPDATED)       aligned[1]++;
 else       if (op.type == ORecordOperation.DELETED)       aligned[2]++;
    }
    try {
      log.alignedEntry(i);
    }
 catch (    IOException e) {
      OLogManager.instance().error(this,"DISTRIBUTED -> error on reset log entry %d",e,i);
    }
  }
  return aligned;
}
