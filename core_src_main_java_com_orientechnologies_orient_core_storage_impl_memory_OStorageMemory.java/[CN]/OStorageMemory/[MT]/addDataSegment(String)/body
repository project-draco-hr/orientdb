{
  lock.acquireExclusiveLock();
  try {
    int pos=-1;
    for (int i=0; i < dataSegments.size(); ++i) {
      if (dataSegments.get(i) == null) {
        pos=i;
        break;
      }
    }
    if (pos == -1)     pos=dataSegments.size();
    final ODataSegmentMemory dataSegment=new ODataSegmentMemory(iDataSegmentName,pos);
    if (pos == dataSegments.size())     dataSegments.add(dataSegment);
 else     dataSegments.set(pos,dataSegment);
    return pos;
  }
  finally {
    lock.releaseExclusiveLock();
  }
}
