{
  final long timer=OProfiler.getInstance().startChrono();
  OMemoryOutputStream record=persistentTree.entryRecordBuffer;
  try {
    record.add((short)pageSize);
    record.add(leftRid.toStream());
    record.add(rightRid.toStream());
    record.add(color);
    record.add((short)size);
    serializeNewKeys();
    serializeNewValues();
    for (int i=0; i < size; ++i)     record.add(serializedKeys[i]);
    for (int i=0; i < size; ++i)     record.add(serializedValues[i]);
    record.flush();
    return record.getByteArray();
  }
  finally {
    record.close();
    OProfiler.getInstance().stopChrono("OTreeMapEntryP.toStream",timer);
  }
}
