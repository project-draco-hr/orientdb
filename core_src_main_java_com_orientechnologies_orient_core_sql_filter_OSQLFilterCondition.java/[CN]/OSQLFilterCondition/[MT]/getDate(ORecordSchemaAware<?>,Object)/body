{
  if (iValue == null)   return null;
  if (iValue instanceof Long)   return new Date(((Long)iValue).longValue());
  String stringValue=iValue.toString();
  if (NULL_VALUE.equals(stringValue))   return null;
  if (stringValue.length() <= 0)   return null;
  if (Pattern.matches("^\\d+$",stringValue)) {
    return new Date(Long.valueOf(stringValue).longValue());
  }
  final OStorageConfiguration config=iRecord.getDatabase().getStorage().getConfiguration();
  SimpleDateFormat formatter=config.getDateFormatInstance();
  if (stringValue.length() > config.dateFormat.length()) {
    formatter=config.getDateTimeFormatInstance();
  }
  try {
    return formatter.parse(stringValue);
  }
 catch (  ParseException pe) {
    throw new OQueryParsingException("Error on conversion of date '" + stringValue + "' using the format: "+ formatter.toPattern());
  }
}
