{
  listener.onMessage("\nStarting shallow comparison of clusters:");
  listener.onMessage("\nChecking the number of clusters...");
  if (storage1.getClusterNames().size() != storage1.getClusterNames().size()) {
    listener.onMessage("KO: cluster sizes are different: " + storage1.getClusterNames().size() + " <-> "+ storage1.getClusterNames().size());
    ++differences;
  }
  int cluster2Id;
  boolean ok;
  for (  String cl1 : storage1.getClusterNames()) {
    ok=true;
    cluster2Id=storage2.getClusterIdByName(cl1);
    listener.onMessage("\n- Checking cluster " + String.format("%-25s: ","'" + cl1 + "'"));
    if (cluster2Id == -1) {
      listener.onMessage("KO: cluster name " + cl1 + " was not found on database "+ storage2);
      ++differences;
      ok=false;
    }
    if (cluster2Id != storage1.getClusterIdByName(cl1)) {
      listener.onMessage("KO: cluster id is different for cluster " + cl1 + ": "+ storage1.getClusterIdByName(cl1)+ " <-> "+ cluster2Id);
      ++differences;
      ok=false;
    }
    if (storage1.count(cluster2Id) != storage2.count(cluster2Id)) {
      listener.onMessage("KO: record number are different in cluster '" + cl1 + "' (id="+ cluster2Id+ "): "+ storage1.count(cluster2Id)+ " <-> "+ storage2.count(cluster2Id));
      ++differences;
      ok=false;
    }
    if (ok)     listener.onMessage("OK");
  }
  listener.onMessage("\n\nShallow analysis done.");
  return true;
}
