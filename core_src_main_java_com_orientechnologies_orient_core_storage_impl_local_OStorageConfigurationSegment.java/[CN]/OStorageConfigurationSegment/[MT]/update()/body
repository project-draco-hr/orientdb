{
  try {
    if (!segment.getFile().isOpen())     return;
    final byte[] buffer=toStream();
    final int len=buffer.length + OBinaryProtocol.SIZE_INT;
    if (len > segment.getFile().getFilledUpTo())     segment.getFile().allocateSpace(len - segment.getFile().getFilledUpTo());
    segment.getFile().writeInt(0,buffer.length);
    segment.getFile().write(OBinaryProtocol.SIZE_INT,buffer);
  }
 catch (  Exception e) {
    throw new OSerializationException("Error on update storage configuration",e);
  }
}
