{
  if (!enable)   return null;
  final String key=getKey(iUser,queryText,iLimit);
  Object result;
  lock.lock();
  try {
    final WeakReference<OCachedResult> value=cache.get(key);
    result=get(value);
    if (result != null)     if (result instanceof ORecord)     ((ORecord)result).toStream();
 else     if (OMultiValue.isMultiValue(result)) {
      for (      Object rc : OMultiValue.getMultiValueIterable(result)) {
        if (rc != null && rc instanceof ORecord) {
          ((ORecord)rc).toStream();
        }
      }
    }
  }
  finally {
    lock.unlock();
  }
  final OProfilerMBean profiler=Orient.instance().getProfiler();
  if (profiler.isRecording()) {
    if (result != null) {
      profiler.updateCounter(profiler.getDatabaseMetric(databaseName,"queryCache.hit"),"Results returned by Query Cache",+1);
    }
 else {
      profiler.updateCounter(profiler.getDatabaseMetric(databaseName,"queryCache.miss"),"Results not returned by Query Cache",+1);
    }
  }
  return result;
}
