{
  Object value=iParameters[0];
  if (value instanceof OSQLFilterItemVariable)   value=((OSQLFilterItemVariable)value).getValue(iCurrentRecord,iCurrentResult,iContext);
  if (value == null)   return Collections.emptySet();
  if (!(value instanceof Collection<?>))   value=Arrays.asList(value);
  final Collection<?> coll=(Collection<?>)value;
  if (iParameters.length == 1) {
    if (context == null) {
      context=new HashSet<Object>(coll);
    }
 else {
      context.retainAll(coll);
    }
    return null;
  }
 else {
    final HashSet<Object> result=new HashSet<Object>(coll);
    for (int i=1; i < iParameters.length; ++i) {
      value=iParameters[i];
      if (value instanceof OSQLFilterItemVariable)       value=((OSQLFilterItemVariable)value).getValue(iCurrentRecord,iCurrentResult,iContext);
      if (value != null) {
        if (!(value instanceof Collection<?>))         value=Arrays.asList(value);
        result.retainAll((Collection<?>)value);
      }
 else       result.clear();
    }
    return result;
  }
}
