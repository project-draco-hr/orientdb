{
  setDataCommandInfo("Add cluster");
  checkDatabase();
  final String type=channel.readString();
  final String name=channel.readString();
  final String location;
  if (connection.data.protocolVersion >= 10 || type.equalsIgnoreCase("PHYSICAL"))   location=channel.readString();
 else   location=null;
  final String dataSegmentName;
  if (connection.data.protocolVersion >= 10)   dataSegmentName=channel.readString();
 else {
    channel.readInt();
    dataSegmentName=null;
  }
  Object[] params=null;
  final int num=connection.database.addCluster(type,name,location,dataSegmentName,params);
  beginResponse();
  try {
    sendOk(clientTxId);
    channel.writeShort((short)num);
  }
  finally {
    endResponse();
  }
}
