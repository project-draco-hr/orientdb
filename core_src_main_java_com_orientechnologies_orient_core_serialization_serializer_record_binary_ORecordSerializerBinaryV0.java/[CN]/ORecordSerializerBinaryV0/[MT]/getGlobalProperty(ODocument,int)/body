{
  final int id=(len * -1) - 1;
  ODatabaseDocument db=document.getDatabase();
  if (db == null || db.isClosed())   throw new ODatabaseException("Cannot unmarshall the document because no database is active");
  OMetadataInternal metadata=(OMetadataInternal)db.getMetadata();
  OGlobalProperty prop=metadata.getImmutableSchemaSnapshot().getGlobalPropertyById(id);
  if (prop == null) {
    metadata.clearThreadLocalSchemaSnapshot();
    metadata.reload();
    metadata.makeThreadLocalSchemaSnapshot();
    prop=metadata.getImmutableSchemaSnapshot().getGlobalPropertyById(id);
  }
  return prop;
}
