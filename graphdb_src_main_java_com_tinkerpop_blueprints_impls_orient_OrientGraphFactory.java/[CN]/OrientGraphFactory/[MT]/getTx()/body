{
  final OrientGraph g;
  if (pool == null) {
    g=(OrientGraph)new OrientGraph(getDatabase()).configure(settings);
    initGraph(g);
  }
 else {
    if (!transactional)     throw new IllegalStateException("Cannot create a transactional graph instance after the pool has been set as non-transactional");
    return (OrientGraph)pool.getResource(url,0,user,password);
  }
  return g;
}
