{
  database=ODatabaseDocumentPool.global().acquire(url,"admin","admin");
  ODocument vDoc=database.newInstance();
  vDoc.setClassName("Profile");
  vDoc.field("nick","JayM1").field("name","Jay").field("surname","Miner");
  vDoc.save();
  vDoc=database.load(vDoc.getIdentity());
  vDoc.field("nick","JayM2");
  vDoc.field("nick","JayM3");
  vDoc.save();
  OPropertyIndex index=database.getMetadata().getSchema().getClass("Profile").getProperty("nick").getIndex();
  ORecordLazySet vOldName=index.getUnderlying().get("JayM1");
  ORecordLazySet vIntermediateName=index.getUnderlying().get("JayM2");
  ORecordLazySet vNewName=index.getUnderlying().get("JayM3");
  Assert.assertEquals(vOldName.size(),0);
  Assert.assertEquals(vIntermediateName.size(),0);
  Assert.assertEquals(vNewName.size(),1);
  database.close();
}
