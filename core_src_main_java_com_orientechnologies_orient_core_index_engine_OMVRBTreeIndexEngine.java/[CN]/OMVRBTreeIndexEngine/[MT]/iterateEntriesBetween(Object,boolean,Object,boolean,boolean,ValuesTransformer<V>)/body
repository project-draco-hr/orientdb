{
  acquireExclusiveLock();
  try {
    if (fromInclusive)     rangeFrom=map.enhanceCompositeKey(rangeFrom,OMVRBTree.PartialSearchMode.LOWEST_BOUNDARY);
 else     rangeFrom=map.enhanceCompositeKey(rangeFrom,OMVRBTree.PartialSearchMode.HIGHEST_BOUNDARY);
    if (toInclusive)     rangeTo=map.enhanceCompositeKey(rangeTo,OMVRBTree.PartialSearchMode.HIGHEST_BOUNDARY);
 else     rangeTo=map.enhanceCompositeKey(rangeTo,OMVRBTree.PartialSearchMode.LOWEST_BOUNDARY);
    if (ascSortOrder) {
      return new OMBRBTreeIndexCursor(map.subMap(rangeFrom,fromInclusive,rangeTo,toInclusive).entrySet().iterator(),transformer);
    }
    return new OMBRBTreeIndexCursor(map.subMap(rangeFrom,fromInclusive,rangeTo,toInclusive).descendingMap().entrySet().iterator(),transformer);
  }
  finally {
    releaseExclusiveLock();
  }
}
