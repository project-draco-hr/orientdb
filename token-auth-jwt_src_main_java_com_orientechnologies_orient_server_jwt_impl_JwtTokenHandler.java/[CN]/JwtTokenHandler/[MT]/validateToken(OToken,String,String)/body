{
  boolean valid=false;
  if (!(token instanceof JsonWebToken)) {
    return false;
  }
  OrientJwtPayload payload=(OrientJwtPayload)((JsonWebToken)token).getPayload();
  if (token.getDatabase().equalsIgnoreCase(database) && token.getExpiry() > System.currentTimeMillis() && payload.getNotBefore() < System.currentTimeMillis()) {
    valid=true;
  }
  token.setIsValid(valid);
  return valid;
}
