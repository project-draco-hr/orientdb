{
  atomicOperationsManager.acquireReadLock(this);
  try {
    acquireSharedLock();
    try {
      OAtomicOperation atomicOperation=atomicOperationsManager.getCurrentOperation();
      OHashTable.BucketPath bucketPath=getBucket(HASH_CODE_MAX_VALUE);
      long bucketPointer=directory.getNodePointer(bucketPath.nodeIndex,bucketPath.itemIndex + bucketPath.hashMapOffset);
      long pageIndex=getPageIndex(bucketPointer);
      OCacheEntry cacheEntry=loadPage(atomicOperation,fileId,pageIndex,false,diskCache);
      try {
        OHashIndexBucket<K,V> bucket=new OHashIndexBucket<K,V>(cacheEntry,keySerializer,valueSerializer,keyTypes,getChangesTree(atomicOperation,cacheEntry));
        while (bucket.size() == 0) {
          final OHashTable.BucketPath prevBucketPath=prevBucketToFind(bucketPath,bucket.getDepth());
          if (prevBucketPath == null)           return null;
          releasePage(atomicOperation,cacheEntry,diskCache);
          final long prevPointer=directory.getNodePointer(prevBucketPath.nodeIndex,prevBucketPath.itemIndex + prevBucketPath.hashMapOffset);
          pageIndex=getPageIndex(prevPointer);
          cacheEntry=loadPage(atomicOperation,fileId,pageIndex,false,diskCache);
          bucket=new OHashIndexBucket<K,V>(cacheEntry,keySerializer,valueSerializer,keyTypes,getChangesTree(atomicOperation,cacheEntry));
          bucketPath=prevBucketPath;
        }
        return bucket.getEntry(bucket.size() - 1);
      }
  finally {
        releasePage(atomicOperation,cacheEntry,diskCache);
      }
    }
  finally {
      releaseSharedLock();
    }
  }
 catch (  IOException ioe) {
    throw new OIndexException("Exception during data read",ioe);
  }
 finally {
    atomicOperationsManager.releaseReadLock(this);
  }
}
