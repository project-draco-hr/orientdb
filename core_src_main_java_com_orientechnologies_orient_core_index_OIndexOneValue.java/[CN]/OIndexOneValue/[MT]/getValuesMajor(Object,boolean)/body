{
  acquireExclusiveLock();
  try {
    OMVRBTreeEntry<Object,OIdentifiable> firstEntry;
    if (isInclusive)     firstEntry=map.getCeilingEntry(fromKey,OMVRBTree.PartialSearchMode.LOWEST_BOUNDARY);
 else     firstEntry=map.getHigherEntry(fromKey);
    if (firstEntry == null)     return Collections.emptySet();
    int firstPageIndex=map.getPageIndex();
    int size=0;
    OMVRBTreeEntry<Object,OIdentifiable> entry=firstEntry;
    while (entry != null) {
      size+=entry.getSize();
      entry=OMVRBTree.successor(entry);
    }
    final Set<OIdentifiable> result=new HashSet<OIdentifiable>(size);
    entry=firstEntry;
    map.setPageIndex(firstPageIndex);
    while (entry != null) {
      result.add(entry.getValue(map.getPageIndex()));
      entry=OMVRBTree.next(entry);
    }
    return result;
  }
  finally {
    releaseExclusiveLock();
  }
}
