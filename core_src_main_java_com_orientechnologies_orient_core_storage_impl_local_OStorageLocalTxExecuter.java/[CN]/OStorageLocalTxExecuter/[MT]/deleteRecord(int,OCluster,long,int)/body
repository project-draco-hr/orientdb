{
  try {
    final OPhysicalPosition ppos=iClusterSegment.getPhysicalPosition(iPosition,new OPhysicalPosition());
    if (!storage.checkForRecordValidity(ppos))     return;
    if (iVersion > -1 && ppos.version != iVersion)     throw new OConcurrentModificationException("Can't delete the record #" + iClusterSegment.getId() + ":"+ iPosition+ " because the version is not the latest one. Probably you are deleting an old record or it has been modified by another user (db=v"+ ppos.version+ " your=v"+ iVersion+ ")");
    txSegment.addLog(OTxSegment.OPERATION_DELETE,iTxId,iClusterSegment.getId(),iPosition,ppos.dataPosition,iVersion);
    iClusterSegment.removePhysicalPosition(iPosition,ppos);
    storage.getDataSegment(ppos.dataSegment).deleteRecord(ppos.dataPosition);
  }
 catch (  IOException e) {
    OLogManager.instance().error(this,"Error on deleting entry #" + iPosition + " in log segment: "+ iClusterSegment,e,OTransactionException.class);
  }
}
