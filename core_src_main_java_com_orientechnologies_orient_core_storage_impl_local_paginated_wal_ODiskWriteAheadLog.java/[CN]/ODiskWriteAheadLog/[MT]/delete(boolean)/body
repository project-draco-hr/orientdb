{
synchronized (syncObject) {
    close(flush);
    for (    LogSegment logSegment : logSegments)     logSegment.delete(false);
    boolean deleted=OFileUtils.delete(masterRecordFile);
    int retryCount=0;
    while (!deleted) {
      OMemoryWatchDog.freeMemoryForResourceCleanup(100);
      deleted=OFileUtils.delete(masterRecordFile);
      retryCount++;
      if (retryCount > 10)       throw new IOException("Can not delete file. Retry limit exceeded. (" + retryCount + ").");
    }
  }
}
