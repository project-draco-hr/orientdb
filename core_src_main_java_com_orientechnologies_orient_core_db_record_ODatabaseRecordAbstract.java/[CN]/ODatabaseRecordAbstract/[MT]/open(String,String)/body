{
  try {
    super.open(iUserName,iUserPassword);
    metadata.load();
    recordFormat=DEF_RECORD_FORMAT;
    dictionary.load();
    if (!(getStorage() instanceof OStorageMemory)) {
      user=getMetadata().getSecurity().getUser(iUserName);
      if (user == null)       throw new OSecurityAccessException("User '" + iUserName + "' was not found in database: "+ getName());
      if (!user.checkPassword(iUserPassword)) {
        Thread.sleep(200);
        throw new OSecurityAccessException("Password not valid for user: " + iUserName);
      }
    }
    checkSecurity(ODatabaseSecurityResources.DATABASE,ORole.OPERATIONS.READ);
  }
 catch (  Exception e) {
    close();
    throw new ODatabaseException("Can't open database",e);
  }
  return (DB)this;
}
