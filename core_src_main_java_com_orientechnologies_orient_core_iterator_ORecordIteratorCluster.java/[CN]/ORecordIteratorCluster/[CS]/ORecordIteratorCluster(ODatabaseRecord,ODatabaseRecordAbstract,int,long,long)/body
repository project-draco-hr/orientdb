{
  super(iDatabase,iLowLevelDatabase);
  if (iClusterId == ORID.CLUSTER_ID_INVALID)   throw new IllegalArgumentException("The clusterId is invalid");
  current.clusterId=iClusterId;
  rangeFrom=iRangeFrom > -1 ? iRangeFrom - 1 : iRangeFrom;
  rangeTo=iRangeTo;
  long[] range=database.getStorage().getClusterDataRange(current.clusterId);
  firstClusterPosition=range[0];
  if (rangeTo > -1)   lastClusterPosition=Math.min(rangeTo,range[1]);
 else   lastClusterPosition=range[1];
  totalAvailableRecords=database.countClusterElements(current.clusterId);
  txEntries=iDatabase.getTransaction().getRecordEntriesByClusterIds(new int[]{iClusterId});
  if (txEntries != null)   for (  OTransactionRecordEntry entry : txEntries) {
switch (entry.status) {
case OTransactionRecordEntry.CREATED:
      totalAvailableRecords++;
    break;
case OTransactionRecordEntry.DELETED:
  totalAvailableRecords--;
break;
}
}
begin();
}
