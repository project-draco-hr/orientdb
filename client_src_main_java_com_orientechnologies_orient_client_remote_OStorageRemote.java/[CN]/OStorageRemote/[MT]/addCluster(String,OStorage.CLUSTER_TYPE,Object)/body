{
  checkConnection();
  do {
    boolean locked=lock.acquireExclusiveLock();
    try {
      final int reqId;
      try {
        reqId=beginRequest(OChannelBinaryProtocol.REQUEST_DATACLUSTER_ADD);
        network.writeString(iClusterType.toString());
        network.writeString(iClusterName);
switch (iClusterType) {
case PHYSICAL:
          network.writeString(iArguments.length > 0 ? (String)iArguments[0] : "").writeInt(iArguments.length > 0 ? (Integer)iArguments[1] : -1);
        break;
case LOGICAL:
      network.writeInt(iArguments.length > 0 ? (Integer)iArguments[0] : -1);
    break;
}
}
  finally {
endRequest();
}
try {
beginResponse(reqId);
final int clusterId=network.readShort();
clustersIds.put(iClusterName.toLowerCase(),clusterId);
clustersTypes.put(iClusterName.toLowerCase(),iClusterType.toString());
return clusterId;
}
  finally {
endResponse();
}
}
 catch (Exception e) {
handleException("Error on add new cluster",e);
}
 finally {
lock.releaseExclusiveLock(locked);
}
}
 while (true);
}
