{
  ODocument replaced=null;
  for (  final OIndex<?> index : indexes) {
    if (!(index.getInternal() instanceof OIndexUnique))     continue;
    final OIndexRecorder indexRecorder=new OIndexRecorder((OIndexUnique)index.getInternal());
    addIndexEntry(record,record.getIdentity(),indexRecorder);
    for (    Object keyItem : indexRecorder.getAffectedKeys()) {
      final ODocument r=index.checkEntry(record,keyItem);
      if (r != null)       if (replaced == null)       replaced=r;
 else       throw new OIndexException("Cannot merge record from multiple indexes. Use this strategy when you have only one index");
    }
  }
  return replaced;
}
