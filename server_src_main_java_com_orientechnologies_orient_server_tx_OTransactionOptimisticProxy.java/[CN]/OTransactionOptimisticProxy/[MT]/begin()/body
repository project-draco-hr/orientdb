{
  super.begin();
  try {
    setUsingLog(channel.readByte() == 1);
    while (channel.readByte() == 1) {
      final byte recordStatus=channel.readByte();
      final ORecordId rid=channel.readRID();
      final OTransactionEntryProxy entry=new OTransactionEntryProxy(channel.readByte());
      entry.status=recordStatus;
switch (entry.status) {
case OTransactionRecordEntry.CREATED:
        entry.clusterName=channel.readString();
      entry.getRecord().fill(rid,0,channel.readBytes(),true);
    createdRecords.put(rid.copy(),entry.getRecord());
  break;
case OTransactionRecordEntry.UPDATED:
entry.getRecord().fill(rid,channel.readInt(),channel.readBytes(),true);
updatedRecords.put(rid,entry.getRecord());
break;
case OTransactionRecordEntry.DELETED:
entry.getRecord().fill(rid,channel.readInt(),null,false);
break;
default :
throw new OTransactionException("Unrecognized tx command: " + entry.status);
}
recordEntries.put((ORecordId)entry.getRecord().getIdentity(),entry);
}
remoteIndexEntries=new ODocument(channel.readBytes());
for (ORecord<?> record : createdRecords.values()) unmarshallRecord(record);
for (ORecord<?> record : updatedRecords.values()) unmarshallRecord(record);
}
 catch (IOException e) {
rollback();
throw new OSerializationException("Cannot read transaction record from the network. Transaction aborted",e);
}
}
