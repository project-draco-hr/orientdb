{
  checkForRebuild();
  final OType[] types=getDefinition().getTypes();
  if (types.length == 1) {
    rangeFrom=OType.convert(rangeFrom,types[0].getDefaultJavaType());
    rangeTo=OType.convert(rangeTo,types[0].getDefaultJavaType());
  }
  if (rangeFrom != null && rangeTo != null && rangeFrom.getClass() != rangeTo.getClass())   throw new IllegalArgumentException("Range from-to parameters are of different types");
  acquireSharedLock();
  try {
    return indexEngine.count(rangeFrom,fromInclusive,rangeTo,toInclusive,maxValuesToFetch,MultiValuesTransformer.INSTANCE);
  }
  finally {
    releaseSharedLock();
  }
}
