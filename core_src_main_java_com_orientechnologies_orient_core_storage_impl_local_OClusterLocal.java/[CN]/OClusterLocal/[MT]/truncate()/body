{
  storage.checkForClusterPermissions(getName());
  acquireExclusiveLock();
  try {
    final OClusterPosition begin=getFirstPosition();
    if (begin.isPersistent()) {
      final OClusterPosition end=getLastPosition();
      final OPhysicalPosition ppos=new OPhysicalPosition();
      for (ppos.clusterPosition=begin; ppos.clusterPosition.compareTo(end) <= 0; ppos.clusterPosition=ppos.clusterPosition.inc()) {
        final OPhysicalPosition pposToDelete=getPhysicalPosition(ppos);
        if (pposToDelete != null && storage.checkForRecordValidity(pposToDelete)) {
          final ODataLocal data=storage.getDataSegmentById(pposToDelete.dataSegmentId);
          if (data != null)           data.deleteRecord(pposToDelete.dataSegmentPos);
        }
      }
    }
    fileSegment.truncate();
    holeSegment.truncate();
    beginOffsetData=-1;
    endOffsetData=-1;
  }
  finally {
    releaseExclusiveLock();
  }
}
