{
  acquireExclusiveLock();
  try {
    for (int i=0; i < 2; i++) {
      final OEHFileMetadata metadata=createFileMetadata(i);
      filesMetadata[i]=metadata;
    }
    metadataStore.create(-1);
    treeStateStore.create(-1);
    initHashTreeState();
    if (config.root.clusters.size() <= config.id)     config.root.clusters.add(config);
 else     config.root.clusters.set(config.id,config);
  }
  finally {
    releaseExclusiveLock();
  }
}
