{
  if (threadMode == THREAD_MODE.MANUAL)   return;
  final ODatabaseRecord tlDb=ODatabaseRecordThreadLocal.INSTANCE.getIfDefined();
  if (threadMode == THREAD_MODE.ALWAYS_AUTOSET || tlDb == null) {
    final OrientGraphContext ctx=getContext(true);
    if (ctx != null && (tlDb == null || tlDb != ctx.rawGraph))     ODatabaseRecordThreadLocal.INSTANCE.set(getRawGraph());
  }
}
