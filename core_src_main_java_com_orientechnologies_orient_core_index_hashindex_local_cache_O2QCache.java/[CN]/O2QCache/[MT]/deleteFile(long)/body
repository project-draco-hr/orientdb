{
synchronized (syncObject) {
    if (!files.containsKey(fileId))     return;
    if (isOpen(fileId))     truncateFile(fileId);
    files.get(fileId).delete();
    files.remove(fileId);
    filePages.remove(fileId);
    dirtyPages.remove(fileId);
  }
}
