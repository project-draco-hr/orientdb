{
  final ORole role=metadata.getSecurity().createRole("admin",ORole.ALLOW_MODES.ALLOW_ALL_BUT);
  user=metadata.getSecurity().createUser("admin","admin",new String[]{role.getName()});
  final ORole readerRole=metadata.getSecurity().createRole("reader",ORole.ALLOW_MODES.DENY_ALL_BUT);
  readerRole.addRule(ODatabaseSecurityResources.ALL_CLASSES,ORole.CRUD_OPERATIONS.READ);
  readerRole.addRule(ODatabaseSecurityResources.ALL_CLUSTERS,ORole.CRUD_OPERATIONS.READ);
  metadata.getSecurity().createUser("reader","reader",new String[]{readerRole.getName()});
  final ORole writerRole=metadata.getSecurity().createRole("writer",ORole.ALLOW_MODES.DENY_ALL_BUT);
  writerRole.addRule(ODatabaseSecurityResources.ALL_CLASSES,ORole.CRUD_OPERATIONS.ALL);
  writerRole.addRule(ODatabaseSecurityResources.ALL_CLUSTERS,ORole.CRUD_OPERATIONS.ALL);
  metadata.getSecurity().createUser("writer","writer",new String[]{writerRole.getName()});
  metadata.getSecurity().save();
}
