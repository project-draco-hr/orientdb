{
  filesLock.acquireWriteLock();
  try {
    initNameIdMapping();
    Integer fileId=nameIdMap.get(fileName);
    OFileClassic fileClassic;
    if (fileId == null || fileId < 0)     fileClassic=null;
 else     fileClassic=files.get(fileId);
    if (fileClassic == null)     throw new OStorageException("File with name " + fileName + " does not exist in storage "+ storageLocal.getName());
    openFile(fileClassic);
    return composeFileId(id,fileId);
  }
  finally {
    filesLock.releaseWriteLock();
  }
}
