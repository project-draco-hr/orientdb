{
  if (isEnabled() && record.getIdentity().getClusterId() != excludedCluster && record.getIdentity().isValid() && !record.getRecordVersion().isTombstone()) {
    underlying.lock(record.getIdentity());
    try {
      if (underlying.get(record.getIdentity()) != record)       underlying.put(record);
    }
  finally {
      underlying.unlock(record.getIdentity());
    }
  }
  if (record.getIdentity().getClusterId() != excludedCluster)   secondary.updateRecord(record);
}
