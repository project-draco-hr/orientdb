{
  byte[] bigRecord=new byte[2 * 65536 + 100];
  MersenneTwisterFast mersenneTwisterFast=new MersenneTwisterFast();
  mersenneTwisterFast.nextBytes(bigRecord);
  ORecordVersion recordVersion=OVersionFactory.instance().createVersion();
  recordVersion.increment();
  recordVersion.increment();
  OClusterPosition clusterPosition=paginatedCluster.createRecord(bigRecord,recordVersion,(byte)1);
  Assert.assertEquals(clusterPosition,OClusterPositionFactory.INSTANCE.valueOf(0));
  recordVersion.increment();
  bigRecord=new byte[2 * 65536 + 20];
  mersenneTwisterFast.nextBytes(bigRecord);
  paginatedCluster.updateRecord(clusterPosition,bigRecord,recordVersion,(byte)2);
  ORawBuffer rawBuffer=paginatedCluster.readRecord(clusterPosition);
  Assert.assertNotNull(rawBuffer);
  Assert.assertEquals(rawBuffer.version,recordVersion);
  Assert.assertEquals(rawBuffer.buffer,bigRecord);
  Assert.assertEquals(rawBuffer.recordType,2);
}
