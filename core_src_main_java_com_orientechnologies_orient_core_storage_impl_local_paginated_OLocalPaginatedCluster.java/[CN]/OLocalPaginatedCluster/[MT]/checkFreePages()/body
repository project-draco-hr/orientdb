{
  long filledUpTo=diskCache.getFilledUpTo(fileId);
  for (long i=0; i < filledUpTo; i++) {
    long pointer=diskCache.loadAndLockForRead(fileId,i);
    int freePageIndex;
    try {
      final OLocalPage page=new OLocalPage(pointer,false);
      freePageIndex=calculateFreePageIndex(page);
      if (freePageIndex < 0)       continue;
    }
  finally {
      diskCache.releaseReadLock(fileId,i);
    }
    if (!findInFreeList(freePageIndex,i))     return false;
  }
  return true;
}
