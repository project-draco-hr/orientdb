{
  ODatabaseDocumentTx db=new ODatabaseDocumentTx(url);
  db.open("admin","admin");
  OClass profile=db.getMetadata().getSchema().createClass("MyProfile",db.addCluster("myprofile",OStorage.CLUSTER_TYPE.PHYSICAL));
  OClass edge=db.getMetadata().getSchema().createClass("MyEdge",db.addCluster("myedge",OStorage.CLUSTER_TYPE.PHYSICAL));
  profile.createProperty("name",OType.STRING).setMin("3").setMax("30").createIndex(OClass.INDEX_TYPE.NOTUNIQUE);
  profile.createProperty("surname",OType.STRING).setMin("3").setMax("30");
  profile.createProperty("in",OType.LINKSET,edge);
  profile.createProperty("out",OType.LINKSET,edge);
  edge.createProperty("in",OType.LINK,profile);
  edge.createProperty("out",OType.LINK,profile);
  db.begin();
  ODocument kim=new ODocument("MyProfile").field("name","Kim").field("surname","Bauer");
  ODocument teri=new ODocument("MyProfile").field("name","Teri").field("surname","Bauer");
  ODocument jack=new ODocument("MyProfile").field("name","Jack").field("surname","Bauer");
  ODocument myedge=new ODocument("MyEdge").field("in",kim).field("out",jack);
  myedge.save();
  ((HashSet<ODocument>)kim.field("out",new HashSet<ORID>()).field("out")).add(myedge);
  ((HashSet<ODocument>)jack.field("in",new HashSet<ORID>()).field("in")).add(myedge);
  jack.save();
  kim.save();
  teri.save();
  db.commit();
  db.close();
  db.open("admin","admin");
  List<ODocument> result=db.command(new OSQLSynchQuery<ODocument>("select from MyProfile ")).execute();
  Assert.assertTrue(result.size() != 0);
  db.close();
}
