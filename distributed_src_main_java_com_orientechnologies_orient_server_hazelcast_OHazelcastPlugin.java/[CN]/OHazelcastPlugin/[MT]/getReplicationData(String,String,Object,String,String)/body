{
  final ODocument cfg=getDatabaseClusterConfiguration(iDatabaseName,iClusterName);
  final Boolean active=cfg.field("synchronization");
  if (active == null || !active)   return null;
  final OReplicationConfig data=new OReplicationConfig();
  data.masterNode=cfg.field("master");
  if (data.masterNode == null) {
    ODistributedServerLog.warn(this,getLocalNodeId(),null,DIRECTION.NONE,"network partition: found wrong configuration for database '%s': cannot find the 'master' field for the cluster '%s'. '$auto' will be used",iDatabaseName,iClusterName);
    data.masterNode=MASTER_AUTO;
  }
  if (data.masterNode.startsWith("$"))   data.masterNode=getReplicationStrategy(data.masterNode).getNode(this,iClusterName,iKey);
  if (data.masterNode == null)   throw new ODistributedException("Cannot find a master node for the key '" + iKey + "'");
  final boolean local=data.masterNode.equals(getLocalNodeId());
  ODistributedServerLog.debug(this,getLocalNodeId(),"?",DIRECTION.OUT,"master node for %s%s%s -> %s (local=%s)",iClusterName != null ? "cluster=" + iClusterName + " " : "",iKey != null ? "key=" + iKey : "",iClusterName == null && iKey == null ? "default operation" : "",data.masterNode,local);
  final Set<String> targetNodes=getOnlineRemoteNodeIdsBut(iLocalNodeId,iRemoteNodeId);
  if (!targetNodes.isEmpty())   data.synchReplicas=targetNodes.toArray(new String[targetNodes.size()]);
  return data;
}
