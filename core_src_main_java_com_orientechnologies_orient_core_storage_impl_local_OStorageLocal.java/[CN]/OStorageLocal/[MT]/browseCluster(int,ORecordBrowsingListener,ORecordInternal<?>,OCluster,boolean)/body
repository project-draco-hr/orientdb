{
  ORawBuffer recordBuffer;
  long positionInPhyCluster;
  try {
    if (iLockEntireCluster)     cluster.lock();
    OClusterPositionIterator iterator=cluster.absoluteIterator();
    while (iterator.hasNext()) {
      positionInPhyCluster=iterator.next();
      recordBuffer=readRecord(iRequesterId,cluster,positionInPhyCluster,!iLockEntireCluster);
      if (recordBuffer == null)       continue;
      if (recordBuffer.recordType != ODocument.RECORD_TYPE && recordBuffer.recordType != ORecordColumn.RECORD_TYPE)       continue;
      iRecord.reset();
      iRecord.setIdentity(cluster.getId(),positionInPhyCluster);
      iRecord.fromStream(recordBuffer.buffer);
      if (!iListener.foreach(iRecord))       break;
    }
  }
  finally {
    if (iLockEntireCluster)     cluster.unlock();
  }
}
