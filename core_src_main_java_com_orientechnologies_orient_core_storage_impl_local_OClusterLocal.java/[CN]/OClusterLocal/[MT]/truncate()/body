{
  acquireExclusiveLock();
  try {
    final long begin=getFirstEntryPosition();
    if (begin > -1) {
      final long end=getLastEntryPosition();
      final OPhysicalPosition ppos=new OPhysicalPosition();
      for (ppos.clusterPosition=begin; ppos.clusterPosition <= end; ++ppos.clusterPosition) {
        getPhysicalPosition(ppos);
        if (storage.checkForRecordValidity(ppos))         storage.getDataSegmentById(ppos.dataSegmentId).deleteRecord(ppos.dataSegmentPos);
      }
    }
    fileSegment.truncate();
    holeSegment.truncate();
  }
  finally {
    releaseExclusiveLock();
  }
}
