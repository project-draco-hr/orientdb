{
  totalConsecutiveErrors++;
  if (totalConsecutiveErrors >= MAX_CONSECUTIVE_ERRORS) {
    ODistributedServerLog.warn(this,manager.getLocalNodeName(),server,ODistributedServerLog.DIRECTION.OUT,"Reached %d consecutive errors on connection, remove the server '%s' from the cluster",totalConsecutiveErrors,server);
    Orient.instance().scheduleTask(new TimerTask(){
      @Override public void run(){
        try {
          manager.removeServer(server);
        }
 catch (        Throwable e) {
        }
      }
    }
,100,0);
    throw new OIOException("Reached " + totalConsecutiveErrors + " consecutive errors on connection, remove the server '"+ server+ "' from the cluster");
  }
}
