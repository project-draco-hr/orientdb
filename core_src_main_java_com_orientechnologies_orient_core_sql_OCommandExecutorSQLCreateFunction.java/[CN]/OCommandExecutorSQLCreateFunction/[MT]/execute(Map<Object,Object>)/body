{
  if (name == null)   throw new OCommandExecutionException("Cannot execute the command because it has not been parsed yet");
  ODatabaseRecord database=getDatabase();
  final OFunction f=database.getMetadata().getFunctionLibrary().createFunction(name);
  f.setCode(code);
  f.setIdempotent(idempotent);
  if (language != null)   f.setLanguage(language);
  return f.getId();
}
