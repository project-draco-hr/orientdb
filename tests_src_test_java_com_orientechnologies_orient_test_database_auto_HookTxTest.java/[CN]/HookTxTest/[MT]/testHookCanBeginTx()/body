{
  database.activateOnCurrentThread();
  database.registerHook(new ORecordHookAbstract(){
    @Override public RESULT onRecordBeforeCreate(    ORecord iRecord){
      database.activateOnCurrentThread();
      database.begin();
      ((ODocument)iRecord).field("test-hook",false).save();
      database.commit();
      return RESULT.RECORD_CHANGED;
    }
    @Override public DISTRIBUTED_EXECUTION_MODE getDistributedExecutionMode(){
      return DISTRIBUTED_EXECUTION_MODE.BOTH;
    }
  }
);
  final ODocument doc=new ODocument().field("test-hook",true).save();
  Assert.assertFalse((Boolean)doc.field("test-hook"));
  database.activateOnCurrentThread();
  database.close();
}
