{
  long timer=OProfiler.getInstance().startChrono();
  final Integer identityRecord=System.identityHashCode(iRecord);
  if (OSerializationThreadLocal.INSTANCE.get().contains(identityRecord))   return iRecord;
  OSerializationThreadLocal.INSTANCE.get().add(identityRecord);
  OProperty schemaProperty;
  Class<?> c=iPojo.getClass();
  final List<Field> properties=getClassFields(c);
  String fieldName;
  Object fieldValue;
  invokeCallback(iPojo,iRecord,OBeforeSerialization.class);
  for (  Field p : properties) {
    fieldName=p.getName();
    fieldValue=getFieldValue(iPojo,fieldName);
    schemaProperty=schemaClass != null ? schemaClass.getProperty(fieldName) : null;
    fieldValue=typeToStream(fieldValue,schemaProperty != null ? schemaProperty.getType() : null,iEntityManager,iObj2RecHandler);
    iRecord.field(fieldName,fieldValue);
  }
  invokeCallback(iPojo,iRecord,OAfterSerialization.class);
  OSerializationThreadLocal.INSTANCE.get().remove(identityRecord);
  OProfiler.getInstance().stopChrono("Object.toStream",timer);
  return iRecord;
}
