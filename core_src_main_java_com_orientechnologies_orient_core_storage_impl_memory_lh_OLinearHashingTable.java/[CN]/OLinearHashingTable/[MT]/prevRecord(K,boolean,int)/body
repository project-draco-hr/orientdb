{
  final K[] result=getKeySet(currentRecord,nextNaturalOrderedKeyShouldBeUsed,step);
  if (result.length == 0) {
    return null;
  }
  Arrays.sort(result);
  final int recordPosition=Arrays.binarySearch(result,currentRecord);
  if (recordPosition >= 0 || recordPosition == -1) {
    if (recordPosition == 0 || recordPosition == -1) {
      return prevRecord(currentRecord,true,-1);
    }
 else {
      return result[recordPosition - 1];
    }
  }
 else {
    return result[-(recordPosition + 2)];
  }
}
