{
  checkOpeness();
  stateLock.acquireReadLock();
  try {
    final long timer=Orient.instance().getProfiler().startChrono();
    modificationLock.prohibitModifications();
    try {
      dataLock.acquireSharedLock();
      try {
        checkOpeness();
        if (writeAheadLog != null) {
          makeFullCheckpoint();
          return;
        }
        writeCache.flush();
        if (configuration != null)         configuration.synch();
        clearStorageDirty();
      }
 catch (      IOException e) {
        throw new OStorageException("Error on synch storage '" + name + "'",e);
      }
 finally {
        dataLock.releaseSharedLock();
        Orient.instance().getProfiler().stopChrono("db." + name + ".synch","Synch a database",timer,"db.*.synch");
      }
    }
  finally {
      modificationLock.allowModifications();
    }
  }
  finally {
    stateLock.releaseReadLock();
  }
}
