{
  if (url == null)   throw new IllegalStateException("Database is closed");
  if (pool == null) {
    database=new ODatabaseDocumentTx(url);
    final OStorageRemote.CONNECTION_STRATEGY connMode=settings.getConnectionStrategy();
    database.setProperty(OStorageRemote.PARAM_CONNECTION_STRATEGY,connMode);
    if (url.startsWith("remote:") || database.exists()) {
      if (database.isClosed())       database.open(username,password);
    }
 else     database.create();
  }
 else   database=pool.acquire();
  makeActive();
  putInInitializationStack();
}
