{
  checkOpeness();
  iSegmentName=iSegmentName.toLowerCase();
  lock.acquireExclusiveLock();
  try {
    final OStorageDataConfiguration conf=new OStorageDataConfiguration(configuration,iSegmentName);
    configuration.dataSegments.add(conf);
    final int pos=registerDataSegment(conf);
    if (pos == -1)     throw new OConfigurationException("Cannot add segment " + conf.name + " because it is already part of storage '"+ name+ "'");
    dataSegments[pos].create(-1);
    configuration.update();
    return pos;
  }
 catch (  Throwable e) {
    OLogManager.instance().error(this,"Error on creation of new data segment '" + iSegmentName + "' in: "+ iSegmentFileName,e,OStorageException.class);
    return -1;
  }
 finally {
    lock.releaseExclusiveLock();
  }
}
