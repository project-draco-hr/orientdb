{
  try {
    acquireExclusiveLock();
    long offset=holeSegment.popLastEntryPosition();
    final int[] pos;
    if (offset > -1)     pos=getRelativePosition(offset);
 else {
      pos=allocateSpace(RECORD_SIZE);
      offset=getAbsolutePosition(pos);
    }
    OFile file=files[pos[0]];
    file.writeShort(pos[1],(short)iDataSegmentId);
    file.writeLong(pos[1] + OConstants.SIZE_SHORT,iPosition);
    file.writeInt(pos[1] + OConstants.SIZE_SHORT + OConstants.SIZE_LONG,0);
    return offset / RECORD_SIZE;
  }
  finally {
    releaseExclusiveLock();
  }
}
