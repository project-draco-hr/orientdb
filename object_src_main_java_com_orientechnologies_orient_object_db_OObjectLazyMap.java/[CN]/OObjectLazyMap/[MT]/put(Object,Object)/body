{
  try {
    if (e instanceof OIdentifiable) {
      converted=false;
      OIdentifiable o=underlying.put(iKey,(OIdentifiable)e);
      if (orphanRemoval && o != null && !o.getIdentity().equals(((OIdentifiable)e).getIdentity()))       ((OObjectProxyMethodHandler)sourceRecord.getHandler()).getOrphans().add(o.getIdentity());
      return o;
    }
 else {
      OIdentifiable newValue=e != null ? getDatabase().getRecordByUserObject(e,true) : null;
      OIdentifiable oldValue=underlying.get(iKey);
      underlying.put(iKey,newValue);
      if (orphanRemoval && ((newValue == null && oldValue != null) || (oldValue != null && !oldValue.getIdentity().equals(newValue.getIdentity()))))       ((OObjectProxyMethodHandler)sourceRecord.getHandler()).getOrphans().add(oldValue.getIdentity());
      return super.put(iKey,e);
    }
  }
  finally {
    setDirty();
  }
}
