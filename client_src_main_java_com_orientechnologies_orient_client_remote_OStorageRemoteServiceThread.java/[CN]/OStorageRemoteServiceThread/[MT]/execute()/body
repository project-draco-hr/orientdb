{
  try {
    try {
      storage.beginResponse(network);
    }
 catch (    IOException ioe) {
      sendShutdown();
      storage.closeChannel(network);
      storage.handleException("Network connection lost",ioe);
      return;
    }
    final byte request=network.readByte();
switch (request) {
case OChannelBinaryProtocol.REQUEST_PUSH_RECORD:
      final ORecordInternal<?> record=(ORecordInternal<?>)OStorageRemote.readIdentifiable(network);
    for (    ORemoteServerEventListener listener : storage.getRemoteServerEventListeners())     listener.onRecordPulled(record);
  storage.getLevel2Cache().updateRecord(record);
break;
case OChannelDistributedProtocol.PUSH_DISTRIBUTED_CONFIG:
final byte[] clusterConfig=network.readBytes();
for (ORemoteServerEventListener listener : storage.getRemoteServerEventListeners()) listener.onClusterConfigurationChange(clusterConfig);
storage.updateClusterConfiguration(clusterConfig);
break;
}
network.endResponse();
}
 catch (Exception e) {
sendShutdown();
}
}
