{
  ODatabaseDocument database=ODatabaseRecordThreadLocal.INSTANCE.get();
  OrientBaseGraph result=OrientBaseGraph.getActiveGraph();
  if (result != null && (result instanceof OrientGraphNoTx) && !result.getRawGraph().isClosed()) {
    ODatabaseRecordThreadLocal.INSTANCE.set(result.getRawGraph());
    return (OrientGraphNoTx)result;
  }
  ODatabaseRecordThreadLocal.INSTANCE.set((ODatabaseDocumentInternal)database);
  return new OrientGraphNoTx((ODatabaseDocumentTx)database);
}
