{
  lock.acquireExclusiveLock();
  try {
    addUser();
    if (status != STATUS.CLOSED)     return;
    if (!exists())     throw new OStorageException("Cannot open the storage '" + name + "' because it does not exist in path: "+ url);
    status=STATUS.OPEN;
    int pos;
    if (OGlobalConfiguration.USE_LHPEPS_CLUSTER.getValueAsBoolean())     addDefaultClusters();
    for (int i=0; i < configuration.clusters.size(); ++i) {
      final OStorageClusterConfiguration clusterConfig=configuration.clusters.get(i);
      if (clusterConfig != null) {
        pos=createClusterFromConfig(clusterConfig);
        try {
          if (pos == -1) {
            clusters[i].open();
          }
 else {
            if (clusterConfig.getName().equals(CLUSTER_DEFAULT_NAME))             defaultClusterId=pos;
            clusters[pos].open();
          }
        }
 catch (        FileNotFoundException e) {
          OLogManager.instance().warn(this,"Error on loading cluster '" + clusters[i].getName() + "' ("+ i+ "): file not found. It will be excluded from current database '"+ getName()+ "'.");
          clusterMap.remove(clusters[i].getName());
          clusters[i]=null;
        }
      }
 else {
        clusters=Arrays.copyOf(clusters,clusters.length + 1);
        clusters[i]=null;
      }
    }
  }
 catch (  Exception e) {
    close(true);
    throw new OStorageException("Cannot open local storage '" + url + "' with mode="+ mode,e);
  }
 finally {
    lock.releaseExclusiveLock();
  }
}
