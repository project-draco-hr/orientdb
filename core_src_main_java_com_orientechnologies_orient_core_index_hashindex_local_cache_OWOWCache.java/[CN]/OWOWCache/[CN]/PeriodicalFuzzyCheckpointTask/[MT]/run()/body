{
  OLogSequenceNumber minLsn=writeAheadLog.getFlushedLSN();
  for (  Map.Entry<PagedKey,PageGroup> entry : writePages.entrySet()) {
    Lock groupLock=lockManager.acquireExclusiveLock(entry.getKey());
    try {
      PageGroup group=entry.getValue();
      final OCachePointer pagePointer=group.page;
      if (pagePointer.getLastFlushedLsn() != null) {
        if (minLsn.compareTo(pagePointer.getLastFlushedLsn()) > 0) {
          minLsn=pagePointer.getLastFlushedLsn();
        }
      }
    }
  finally {
      lockManager.releaseLock(groupLock);
    }
  }
  OLogManager.instance().debug(this,"Start fuzzy checkpoint flushed LSN is %s",minLsn);
  try {
    writeAheadLog.logFuzzyCheckPointStart(minLsn);
    for (    OFileClassic fileClassic : files.values()) {
      fileClassic.synch();
    }
    writeAheadLog.logFuzzyCheckPointEnd();
    writeAheadLog.flush();
    if (minLsn.compareTo(new OLogSequenceNumber(-1,-1)) > 0)     writeAheadLog.cutTill(minLsn);
  }
 catch (  IOException ioe) {
    OLogManager.instance().error(this,"Error during fuzzy checkpoint",ioe);
  }
  OLogManager.instance().debug(this,"End fuzzy checkpoint");
}
