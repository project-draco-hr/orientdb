{
  OrientGraphNoTx graph=new OrientGraphNoTx("memory:functionsTest");
  try {
    ODatabaseDocumentTx db=graph.getRawGraph();
    db.command(new OCommandSQL("create class Polygon extends v")).execute();
    db.command(new OCommandSQL("create property Polygon.geometry EMBEDDED OPolygon")).execute();
    db.command(new OCommandSQL("insert into Polygon set geometry = ST_GeomFromText('POLYGON((0 0, 10 0, 10 5, 0 5, 0 0))')")).execute();
    db.command(new OCommandSQL("create index Polygon.g on Polygon (geometry) SPATIAL engine lucene")).execute();
    List<ODocument> execute=db.command(new OCommandSQL("SELECT from Polygon where ST_DWithin(geometry, ST_GeomFromText('POLYGON((12 0, 14 0, 14 6, 12 6, 12 0))'), 2.0d) = true")).execute();
    Assert.assertEquals(execute.size(),1);
  }
  finally {
    graph.drop();
  }
}
