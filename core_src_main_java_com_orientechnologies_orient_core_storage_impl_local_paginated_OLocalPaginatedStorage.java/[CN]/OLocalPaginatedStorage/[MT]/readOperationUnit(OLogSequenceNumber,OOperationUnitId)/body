{
  final OLogSequenceNumber beginSequence=writeAheadLog.begin();
  if (startLSN == null)   startLSN=beginSequence;
  if (startLSN.compareTo(beginSequence) < 0)   startLSN=beginSequence;
  List<OWALRecord> operationUnit=new ArrayList<OWALRecord>();
  OLogSequenceNumber lsn=startLSN;
  while (lsn != null) {
    OWALRecord record=writeAheadLog.read(lsn);
    if (!(record instanceof OOperationUnitRecord))     continue;
    OOperationUnitRecord operationUnitRecord=(OOperationUnitRecord)record;
    if (operationUnitRecord.getOperationUnitId().equals(unitId)) {
      operationUnit.add(record);
      if (record instanceof OAtomicUnitEndRecord)       break;
    }
  }
  return operationUnit;
}
