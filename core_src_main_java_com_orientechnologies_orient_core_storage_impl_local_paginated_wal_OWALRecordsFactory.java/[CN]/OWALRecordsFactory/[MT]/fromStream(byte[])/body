{
  OWALRecord walRecord;
switch (content[0]) {
case 0:
    walRecord=new OUpdatePageRecord();
  break;
case 1:
walRecord=new OFuzzyCheckpointStartRecord();
break;
case 2:
walRecord=new OFuzzyCheckpointEndRecord();
break;
case 3:
walRecord=new ODirtyPagesRecord();
break;
case 4:
walRecord=new OFullCheckpointStartRecord();
break;
case 5:
walRecord=new OCheckpointEndRecord();
break;
case 6:
walRecord=new OAddNewPageRecord();
break;
case 7:
walRecord=new OClusterStateRecord();
break;
default :
if (idToTypeMap.containsKey(content[0])) try {
walRecord=(OWALRecord)idToTypeMap.get(content[0]).newInstance();
}
 catch (InstantiationException e) {
throw new IllegalStateException("Can not deserialize passed in record",e);
}
catch (IllegalAccessException e) {
throw new IllegalStateException("Can not deserialize passed in record",e);
}
 else throw new IllegalStateException("Can not deserialize passed in wal record.");
}
walRecord.fromStream(content,1);
return walRecord;
}
