{
  lock.acquireSharedLock();
  try {
    for (    ODataSegmentMemory d : dataSegments)     if (d.getName().equalsIgnoreCase(iDataSegmentName))     return d.getId();
    throw new IllegalArgumentException("Data segment '" + iDataSegmentName + "' does not exist in storage '"+ name+ "'");
  }
  finally {
    lock.releaseSharedLock();
  }
}
