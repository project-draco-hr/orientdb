{
  final int queuedMsg=requestQueue.size();
  long lastMessageId=-1;
  for (long processedMessages=0; running; processedMessages++) {
    if (restoringMessages && processedMessages >= queuedMsg) {
      ODistributedServerLog.debug(this,getLocalNodeName(),null,DIRECTION.NONE,"executed all pending tasks in queue (%d), set restoringMessages=false and database '%s' as online. Last req=%d",queuedMsg,databaseName,lastMessageId);
      restoringMessages=false;
    }
    String senderNode=null;
    ODistributedRequest message=null;
    try {
      message=readRequest();
      if (message != null) {
        lastMessageId=message.getId();
        senderNode=message.getSenderNodeName();
        onMessage(message);
      }
    }
 catch (    InterruptedException e) {
      Thread.interrupted();
      break;
    }
catch (    DistributedObjectDestroyedException e) {
      Thread.interrupted();
      break;
    }
catch (    HazelcastInstanceNotActiveException e) {
      Thread.interrupted();
      break;
    }
catch (    Throwable e) {
      if (e.getCause() instanceof InterruptedException)       Thread.interrupted();
 else       ODistributedServerLog.error(this,manager.getLocalNodeName(),senderNode,DIRECTION.IN,"error on executing distributed request %d: %s",e,message != null ? message.getId() : -1,message != null ? message.getTask() : "-");
    }
  }
  ODistributedServerLog.debug(this,manager.getLocalNodeName(),null,DIRECTION.NONE,"end of reading requests for database %s",databaseName);
}
