{
synchronized (syncObject) {
    if (flush)     writeCache.flush(fileId);
    writeCache.clear(fileId);
    readCache.clear(fileId);
    files.get(fileId).close();
  }
}
