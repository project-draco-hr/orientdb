{
  final List<List<String>> partitions=iManager.getDatabaseConfiguration(iDatabaseName).getPartitions(iClusterName);
  final List<String> partition;
  if (partitions.size() > 1) {
    AtomicLong lastPos=lastPartition.get(iDatabaseName);
    if (lastPos == null) {
      lastPos=new AtomicLong(-1l);
      lastPartition.putIfAbsent(iDatabaseName,lastPos);
    }
    final long newPos=lastPos.incrementAndGet();
    partition=partitions.get((int)(newPos % partitions.size()));
  }
 else   partition=partitions.get(0);
  return iManager.newPartition(partition);
}
