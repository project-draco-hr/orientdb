{
  OLogManager.instance().config(this,"Loading plugin '%s'...",plugin.getName());
  try {
    final URLClassLoader pluginClassLoader=new URLClassLoader(new URL[]{plugin.toURI().toURL()},this.getClass().getClassLoader());
    final InputStream pluginPropertiesFile=pluginClassLoader.getResourceAsStream("plugin.properties");
    if (pluginPropertiesFile == null || pluginPropertiesFile.available() == 0)     OLogManager.instance().error(this,"Error on loading plugin.properties",IllegalArgumentException.class);
    final Properties properties=new Properties();
    properties.load(pluginPropertiesFile);
    final String pluginClass=properties.getProperty("class");
    List<OServerParameterConfiguration> params=new ArrayList<OServerParameterConfiguration>();
    for (    Object prop : properties.keySet()) {
      final String propName=prop.toString();
      if (propName.startsWith("prop."))       params.add(new OServerParameterConfiguration(propName.substring("prop.".length()),properties.getProperty(propName)));
    }
    startPluginClass(pluginClassLoader,pluginClass,params);
  }
 catch (  Exception e) {
    OLogManager.instance().error(this,"Error on loading plugin '%s'",e,plugin.getName());
  }
}
