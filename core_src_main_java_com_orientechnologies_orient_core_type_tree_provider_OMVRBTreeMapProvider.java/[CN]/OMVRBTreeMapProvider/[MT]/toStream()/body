{
  final OProfilerMBean profiler=Orient.instance().getProfiler();
  final long timer=profiler.startChrono();
  try {
    stream.jump(0);
    stream.set(CURRENT_PROTOCOL_VERSION);
    stream.setAsFixed(root != null ? root.toStream() : ORecordId.EMPTY_RECORD_ID_STREAM);
    stream.set(size);
    stream.set(pageSize);
    stream.set(keySize);
    stream.set(keySerializer.getId());
    stream.setCustom(valueSerializer.getName());
    if (streamKeySerializer != null)     stream.setCustom(streamKeySerializer.getName());
 else     stream.setCustom("");
    final byte[] result=stream.toByteArray();
    record.fromStream(result);
    return result;
  }
  finally {
    profiler.stopChrono(profiler.getProcessMetric("mvrbtree.toStream"),"Serialize a MVRBTree",timer);
  }
}
