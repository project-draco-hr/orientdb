{
  final byte type=(byte)stream.read();
switch (type) {
case NULL_MARKER:
{
      return null;
    }
case RECORD_MARKER:
{
    return readIdentifiable(stream);
  }
case COLLECTION_MARKER:
{
  final int size=OBinaryProtocol.bytes2int(stream);
  final List<OIdentifiable> result=new ArrayList<OIdentifiable>(size);
  for (int i=0; i < size; i++) {
    result.add(readIdentifiable(stream));
  }
  return result;
}
case INTEGER_MARKER:
{
return OBinaryProtocol.bytes2int(stream);
}
case LONG_MARKER:
{
return OBinaryProtocol.bytes2long(stream);
}
case BOOLEAN_MARKER:
{
return stream.read() == 1;
}
case END_MARKER:
{
final long nodeId=OBinaryProtocol.bytes2long(stream);
return new OHazelcastResultListener.EndOfResult(nodeId);
}
case OTHER_MARKER:
{
final int len=OBinaryProtocol.bytes2int(stream);
final byte[] bytes=readFully(stream,0,len);
final String value=new String(bytes);
return ORecordSerializerStringAbstract.fieldTypeFromStream(null,ORecordSerializerStringAbstract.getType(value),value);
}
}
return null;
}
