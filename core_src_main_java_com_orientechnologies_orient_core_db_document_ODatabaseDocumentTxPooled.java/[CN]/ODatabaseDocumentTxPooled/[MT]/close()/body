{
  if (isClosed())   return;
  checkOpeness();
  rollback();
  final OMetadata md=getMetadata();
  if (md != null)   md.close();
  ((ODatabaseRaw)((ODatabaseRecord)underlying).getUnderlying()).callOnCloseListeners();
  getLevel1Cache().clear();
  ownerPool.release(this);
  ownerPool=null;
}
