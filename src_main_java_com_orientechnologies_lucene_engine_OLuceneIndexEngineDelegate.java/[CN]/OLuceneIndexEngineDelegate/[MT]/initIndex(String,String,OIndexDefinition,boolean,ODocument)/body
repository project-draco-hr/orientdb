{
  if (indexType.equalsIgnoreCase("SPATIAL")) {
    if (indexDefinition.getFields().size() > 1) {
      delegate=new OLuceneLegacySpatialIndexEngine(indexName,OShapeFactory.INSTANCE);
    }
 else {
      delegate=new OLuceneGeoSpatialIndexEngine(indexName,OShapeFactory.INSTANCE);
    }
  }
 else   if (indexType.equalsIgnoreCase("FULLTEXT")) {
    delegate=new OLuceneFullTextIndexEngine(indexName,new ODocBuilder(),new OQueryBuilderImpl());
  }
  delegate.initIndex(indexName,indexType,indexDefinition,isAutomatic,metadata);
}
