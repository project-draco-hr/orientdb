{
  if (OLogManager.instance().isDebugEnabled())   OLogManager.instance().debug(this,"DISTRIBUTED <- command: %s",text.toString());
  if (status != STATUS.ALIGN && !getDistributedServerManager().checkStatus("online"))   throw new OServerOfflineException();
  final ODatabaseDocumentTx db=(ODatabaseDocumentTx)OServerMain.server().openDatabase("document",databaseName,replicatorUser.name,replicatorUser.password);
  ODistributedThreadLocal.INSTANCE.distributedExecution=true;
  try {
    Object result=getStorage().command(new OCommandSQL(text));
    if (mode != EXECUTION_MODE.FIRE_AND_FORGET)     return result;
    return null;
  }
  finally {
    ODistributedThreadLocal.INSTANCE.distributedExecution=false;
    db.close();
  }
}
