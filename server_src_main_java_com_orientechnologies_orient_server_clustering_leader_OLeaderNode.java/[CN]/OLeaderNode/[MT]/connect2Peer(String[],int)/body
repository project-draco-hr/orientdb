{
  Throwable lastException=null;
  if (OLogManager.instance().isDebugEnabled())   OLogManager.instance().debug(this,"Trying to connecting to peer %s:%d",Arrays.toString(iServerAddresses),iServerPort);
  for (  String serverAddress : iServerAddresses) {
    final String key=ODistributedServerManager.getNodeName(serverAddress,iServerPort);
    final ORemotePeer node;
synchronized (this) {
      if (nodes.containsKey(key)) {
        node=nodes.get(key);
        if (OLogManager.instance().isDebugEnabled())         OLogManager.instance().debug(this,"Peer %s already registered. Now has status: %s",key,node.getStatus());
        if (node.getStatus() != ORemotePeer.STATUS.UNREACHABLE && node.getStatus() != ORemotePeer.STATUS.DISCONNECTED && node.checkConnection())         return;
      }
 else       node=new ORemotePeer(this,serverAddress,iServerPort);
      try {
        if (node.connect(manager.getConfig().networkTimeoutNode,manager.getConfig().name,manager.getConfig().securityKey))         nodes.put(key,node);
        return;
      }
 catch (      Exception e) {
        lastException=e;
      }
    }
  }
  OLogManager.instance().error(this,"CLUSTER <%s>: cannot connect to distributed server node using addresses %s:%d and %s:%d",manager.getConfig().name,lastException,iServerAddresses[0],iServerPort,iServerAddresses[1],iServerPort);
}
