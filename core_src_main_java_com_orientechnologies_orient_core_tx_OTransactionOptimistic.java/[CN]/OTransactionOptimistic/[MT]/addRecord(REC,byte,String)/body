{
  checkTransaction();
  int clusterId=iRecord.getIdentity().getClusterId();
  long position=iRecord.getIdentity().getClusterPosition();
  final StringBuilder key=new StringBuilder();
  key.append(clusterId);
  key.append(ORID.SEPARATOR);
  if (position == -1) {
    for (    OTransactionEntry<REC> entry : entries.values()) {
      if (entry.record == iRecord)       return;
    }
    position=newObjectCounter++;
    key.append(position);
    key.append('+');
  }
 else   key.append(position);
  OTransactionEntry<REC> txEntry=entries.get(key);
  if (txEntry == null) {
    txEntry=new OTransactionEntry<REC>(iRecord,iStatus,iClusterName);
    entries.put(key.toString(),txEntry);
  }
 else {
    txEntry.record=iRecord;
switch (txEntry.status) {
case OTransactionEntry.LOADED:
switch (iStatus) {
case OTransactionEntry.UPDATED:
        txEntry.status=OTransactionEntry.UPDATED;
      break;
case OTransactionEntry.DELETED:
    txEntry.status=OTransactionEntry.DELETED;
  break;
}
break;
case OTransactionEntry.UPDATED:
switch (iStatus) {
case OTransactionEntry.DELETED:
txEntry.status=OTransactionEntry.DELETED;
break;
}
break;
case OTransactionEntry.DELETED:
break;
case OTransactionEntry.CREATED:
switch (iStatus) {
case OTransactionEntry.DELETED:
entries.remove(key);
break;
}
break;
}
}
}
