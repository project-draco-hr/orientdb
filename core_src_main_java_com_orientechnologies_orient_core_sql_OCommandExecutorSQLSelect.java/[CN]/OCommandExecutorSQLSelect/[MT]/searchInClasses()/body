{
  final int[] clusterIds;
  final OClass cls=compiledFilter.getTargetClasses().keySet().iterator().next();
  final ODatabaseRecord database=getDatabase();
  database.checkSecurity(ODatabaseSecurityResources.CLASS,ORole.PERMISSION_READ,cls.getName());
  clusterIds=cls.getPolymorphicClusterIds();
  for (  final int clusterId : clusterIds)   database.checkSecurity(ODatabaseSecurityResources.CLUSTER,ORole.PERMISSION_READ,database.getClusterNameById(clusterId));
  if (searchForIndexes(cls))   OProfiler.getInstance().updateCounter("Query.indexUsage",1);
 else   scanEntireClusters(clusterIds);
}
