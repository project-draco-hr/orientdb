{
  acquireSharedLock();
  try {
    checkNullSupport(key);
    if (key == null) {
      if (diskCache.getFilledUpTo(nullBucketFileId) == 0)       return null;
      V result=null;
      OCacheEntry cacheEntry=diskCache.load(nullBucketFileId,0,false);
      OCachePointer cachePointer=cacheEntry.getCachePointer();
      try {
        ONullBucket<V> nullBucket=new ONullBucket<V>(cachePointer.getDataPointer(),ODurablePage.TrackMode.NONE,valueSerializer,false);
        result=nullBucket.getValue();
      }
  finally {
        diskCache.release(cacheEntry);
      }
      return result;
    }
 else {
      key=keySerializer.preprocess(key,(Object[])keyTypes);
      final long hashCode=keyHashFunction.hashCode(key);
      BucketPath bucketPath=getBucket(hashCode);
      final long bucketPointer=directory.getNodePointer(bucketPath.nodeIndex,bucketPath.itemIndex + bucketPath.hashMapOffset);
      if (bucketPointer == 0)       return null;
      long pageIndex=getPageIndex(bucketPointer);
      int fileLevel=getFileLevel(bucketPointer);
      OCacheEntry cacheEntry=loadPageEntry(pageIndex,fileLevel);
      OCachePointer dataPointer=cacheEntry.getCachePointer();
      try {
        final OHashIndexBucket<K,V> bucket=new OHashIndexBucket<K,V>(dataPointer.getDataPointer(),keySerializer,valueSerializer,keyTypes,ODurablePage.TrackMode.NONE);
        OHashIndexBucket.Entry<K,V> entry=bucket.find(key,hashCode);
        if (entry == null)         return null;
        return entry.value;
      }
  finally {
        diskCache.release(cacheEntry);
      }
    }
  }
 catch (  IOException e) {
    throw new OIndexException("Exception during index value retrieval",e);
  }
 finally {
    releaseSharedLock();
  }
}
