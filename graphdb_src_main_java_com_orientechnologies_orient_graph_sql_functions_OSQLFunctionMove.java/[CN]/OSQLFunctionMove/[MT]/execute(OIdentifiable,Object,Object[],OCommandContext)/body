{
  final OrientBaseGraph graph=OGraphCommandExecutorSQLFactory.getGraph();
  try {
    final String[] labels;
    if (iParameters != null && iParameters.length > 0 && iParameters[0] != null)     labels=OMultiValue.array(iParameters,String.class,new OCallable<Object,Object>(){
      @Override public Object call(      final Object iArgument){
        return OStringSerializerHelper.getStringContent(iArgument);
      }
    }
);
 else     labels=null;
    if (iCurrentRecord == null) {
      return OSQLEngine.foreachRecord(new OCallable<Object,OIdentifiable>(){
        @Override public Object call(        final OIdentifiable iArgument){
          return move(graph,iArgument,labels);
        }
      }
,iCurrentResult,iContext);
    }
 else     return move(graph,iCurrentRecord.getRecord(),labels);
  }
  finally {
    graph.shutdown();
  }
}
