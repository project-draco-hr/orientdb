{
  database.getMetadata().getSchema().getClass("Profile").createProperty("hash",OType.LONG).createIndex(INDEX_TYPE.UNIQUE);
  OIndex<OIdentifiable> idx=(OIndex<OIdentifiable>)database.getMetadata().getIndexManager().getIndex("Profile.hash");
  for (int i=0; i < 5; i++) {
    Profile profile=new Profile("HashTest" + i).setHash(100l + i);
    database.save(profile);
  }
  Iterator<Entry<Object,OIdentifiable>> it=idx.iterator();
  while (it.hasNext()) {
    it.next();
  }
  Assert.assertEquals(idx.getSize(),5);
}
