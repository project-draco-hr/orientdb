{
  OCacheEntry rootCacheEntry=diskCache.load(fileId,ROOT_INDEX,false);
  OSBTreeBucket<K,V> rootBucket=new OSBTreeBucket<K,V>(rootCacheEntry,keySerializer,keyTypes,valueSerializer,ODurablePage.TrackMode.NONE);
  long freeListFirstIndex;
  try {
    freeListFirstIndex=rootBucket.getValuesFreeListFirstIndex();
  }
  finally {
    diskCache.release(rootCacheEntry);
  }
  if (freeListFirstIndex >= 0) {
    OCacheEntry freePageEntry=diskCache.load(fileId,freeListFirstIndex,false);
    OSBTreeValuePage valuePage=new OSBTreeValuePage(freePageEntry,getTrackMode(),false);
    freePageEntry.acquireExclusiveLock();
    try {
      long nextFreeListIndex=valuePage.getNextFreeListPage();
      rootCacheEntry=diskCache.load(fileId,ROOT_INDEX,false);
      rootCacheEntry.acquireExclusiveLock();
      rootBucket=new OSBTreeBucket<K,V>(rootCacheEntry,keySerializer,keyTypes,valueSerializer,getTrackMode());
      try {
        rootBucket.setValuesFreeListFirstIndex(nextFreeListIndex);
        rootCacheEntry.markDirty();
        logPageChanges(rootBucket,fileId,ROOT_INDEX,false);
      }
  finally {
        rootCacheEntry.releaseExclusiveLock();
        diskCache.release(rootCacheEntry);
      }
      valuePage.setNextFreeListPage(-1);
      freePageEntry.markDirty();
      logPageChanges(valuePage,fileId,freePageEntry.getPageIndex(),false);
    }
  finally {
      freePageEntry.releaseExclusiveLock();
      diskCache.release(freePageEntry);
    }
    return freePageEntry.getPageIndex();
  }
  return -1;
}
