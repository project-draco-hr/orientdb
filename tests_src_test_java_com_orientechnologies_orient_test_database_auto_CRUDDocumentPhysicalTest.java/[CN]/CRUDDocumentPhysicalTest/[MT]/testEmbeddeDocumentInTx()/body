{
  database=ODatabaseDocumentPool.global().acquire(url,"admin","admin");
  ODocument bank=database.newInstance("Account");
  try {
    database.begin();
    bank.field("Name","MyBank");
    ODocument bank2=database.newInstance("Account");
    bank.field("embedded",bank2,OType.EMBEDDED);
    bank.save();
    database.commit();
  }
  finally {
    database.close();
  }
  database=ODatabaseDocumentPool.global().acquire(url,"admin","admin");
  try {
    bank.reload();
    Assert.assertTrue(((ODocument)bank.field("embedded")).isEmbedded());
    Assert.assertFalse(((ODocument)bank.field("embedded")).getIdentity().isPersistent());
    bank.delete();
  }
  finally {
    database.close();
  }
}
