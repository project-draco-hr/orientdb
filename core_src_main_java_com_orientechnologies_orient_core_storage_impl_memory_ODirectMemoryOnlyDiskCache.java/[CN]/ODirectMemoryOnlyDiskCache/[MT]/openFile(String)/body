{
  metadataLock.lock();
  try {
    Long fileId=fileNameIdMap.get(fileName);
    if (fileId == null) {
      throw new OStorageException("File " + fileName + " does not exist.");
    }
    return fileId;
  }
  finally {
    metadataLock.unlock();
  }
}
