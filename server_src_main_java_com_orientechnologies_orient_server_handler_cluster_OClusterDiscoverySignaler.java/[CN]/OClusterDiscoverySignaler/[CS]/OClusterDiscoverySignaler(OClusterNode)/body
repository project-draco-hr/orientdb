{
  super(iClusterNode.configNetworkMulticastHeartbeat * 1000,OServer.getThreadGroup(),"DiscoverySignaler");
  OServerNetworkListener binaryNetworkListener=null;
  for (  OServerNetworkListener l : iClusterNode.server.getListeners()) {
    if (l.getProtocolType().equals(ONetworkProtocolBinary.class)) {
      binaryNetworkListener=l;
      break;
    }
  }
  if (binaryNetworkListener == null)   OLogManager.instance().error(this,"Can't find a configured network listener with binary protocol. Can't start cluster node",null,OConfigurationException.class);
  String buffer=OClusterNode.PACKET_HEADER + OConstants.ORIENT_VERSION + "|"+ OClusterNode.PROTOCOL_VERSION+ "|"+ iClusterNode.name+ "|"+ binaryNetworkListener.getInboundAddr().getHostName()+ "|"+ binaryNetworkListener.getInboundAddr().getPort();
  discoveryPacket=OSecurityManager.instance().encrypt(iClusterNode.securityAlgorithm,iClusterNode.securityKey,buffer.getBytes());
  try {
    dgram=new DatagramPacket(discoveryPacket,discoveryPacket.length,iClusterNode.configNetworkMulticastAddress,iClusterNode.configNetworkMulticastPort);
    socket=new DatagramSocket();
    start();
  }
 catch (  Exception e) {
    OLogManager.instance().error(this,"Can't startup cluster discovery signaler",e);
  }
}
