{
  final OStorageSynchronizer dbSynchronizer=getDatabaseSynchronizer(iTask.getDatabaseName());
  while (true) {
    if (!checkOperationSequence(iTask))     break;
    final long opSerial=iTask.getOperationSerial();
synchronized (lockQueue) {
      final long[] lastExecutedOperation=dbSynchronizer.getLog().getLastExecutedOperationId();
      if ((lastExecutedOperation[0] != iTask.getRunId() && opSerial > 1) || (lastExecutedOperation[0] == iTask.getRunId() && lastExecutedOperation[1] != opSerial - 1)) {
        try {
          final String tasksToWait=lastExecutedOperation[0] != iTask.getRunId() ? ">=1 (prev run)" : "" + (opSerial - lastExecutedOperation[1] - 1);
          ODistributedServerLog.debug(this,getLocalNodeId(),iTask.getNodeSource(),DIRECTION.NONE,"waiting for %s task(s) in queue %s, current=%d my=%d thread=%s",tasksToWait,iTask.getRunId(),lastExecutedOperation[1],opSerial,Thread.currentThread().getName());
          lockQueue.wait(OGlobalConfiguration.DISTRIBUTED_QUEUE_TIMEOUT.getValueAsLong());
        }
 catch (        InterruptedException e) {
        }
      }
 else {
        ODistributedThreadLocal.INSTANCE.set(iTask.getNodeSource());
        return true;
      }
    }
  }
  return false;
}
