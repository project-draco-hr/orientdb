{
synchronized (syncObject) {
    long fileId=fileCounter++;
    OFileClassic fileClassic=new OFileClassic();
    String path=storageLocal.getVariableParser().resolveVariables(storageLocal.getStoragePath() + File.separator + fileName);
    fileClassic.init(path,storageLocal.getMode());
    if (fileClassic.exists())     fileClassic.open();
 else     fileClassic.create(-1);
    files.put(fileId,fileClassic);
    filePages.put(fileId,new HashSet<Long>());
    dirtyPages.put(fileId,new TreeMap<Long,OLogSequenceNumber>());
    return fileId;
  }
}
