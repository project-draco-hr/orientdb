{
  ODistributedServerLog.debug(this,iManager.getLocalNodeName(),null,DIRECTION.IN,"Delete record %s/%s v.%d",database.getName(),rid.toString(),version);
  prepareUndoOperation();
  final ORecord loadedRecord=previousRecord.copy();
  if (loadedRecord != null) {
    if (delayed)     if (loadedRecord.getVersion() == version)     ((ODistributedStorage)database.getStorage()).pushDeletedRecord(rid,version);
 else     throw new OConcurrentModificationException(rid,loadedRecord.getVersion(),version,ORecordOperation.DELETED);
 else     loadedRecord.delete();
  }
  return true;
}
