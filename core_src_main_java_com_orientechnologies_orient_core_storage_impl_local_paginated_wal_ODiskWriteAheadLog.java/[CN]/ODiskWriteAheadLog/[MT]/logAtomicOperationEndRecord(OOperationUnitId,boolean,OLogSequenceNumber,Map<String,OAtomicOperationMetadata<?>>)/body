{
  syncObject.lock();
  try {
    checkForClose();
    final OLogSequenceNumber lsn=log(new OAtomicUnitEndRecord(operationUnitId,rollback,atomicOperationMetadata));
    activeOperations.remove(operationUnitId);
    return lsn;
  }
  finally {
    syncObject.unlock();
  }
}
