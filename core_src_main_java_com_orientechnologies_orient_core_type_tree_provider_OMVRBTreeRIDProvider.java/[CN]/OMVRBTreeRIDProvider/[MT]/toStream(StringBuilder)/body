{
  final long timer=OProfiler.getInstance().startChrono();
  if (buffer.length() == 0)   try {
    marshalling=true;
    if (isEmbeddedStreaming()) {
      buffer.append(OStringSerializerHelper.COLLECTION_BEGIN);
      boolean first=true;
      for (      OIdentifiable rid : tree.keySet()) {
        if (!first)         buffer.append(OStringSerializerHelper.COLLECTION_SEPARATOR);
 else         first=false;
        rid.getIdentity().toString(buffer);
      }
      buffer.append(OStringSerializerHelper.COLLECTION_END);
    }
 else {
      buffer.append(OStringSerializerHelper.EMBEDDED_BEGIN);
      buffer.append(new String(toDocument().toStream()));
      buffer.append(OStringSerializerHelper.EMBEDDED_END);
    }
  }
  finally {
    marshalling=false;
    OProfiler.getInstance().stopChrono("OMVRBTreeRIDProvider.toStream",timer);
  }
  iBuffer.append(buffer);
  return this;
}
