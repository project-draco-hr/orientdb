{
  final OCluster cluster;
  if (clusterName != null) {
    clusterName=clusterName.toLowerCase(configuration.getLocaleInstance());
    cluster=OPaginatedClusterFactory.INSTANCE.createCluster(clusterName,configuration.version,this);
    cluster.configure(this,clusterPos,clusterName,parameters);
    if (clusterName.equals(OMVRBTreeRIDProvider.PERSISTENT_CLASS_NAME.toLowerCase(configuration.getLocaleInstance()))) {
      cluster.set(OCluster.ATTRIBUTES.USE_WAL,false);
      cluster.set(OCluster.ATTRIBUTES.RECORD_GROW_FACTOR,5);
      cluster.set(OCluster.ATTRIBUTES.RECORD_OVERFLOW_GROW_FACTOR,2);
    }
  }
 else {
    cluster=null;
  }
  final int createdClusterId=registerCluster(cluster);
  if (cluster != null) {
    if (!cluster.exists()) {
      cluster.create(-1);
      if (makeFullCheckPointAfterClusterCreate && fullCheckPoint)       makeFullCheckpoint();
    }
 else {
      cluster.open();
    }
    configuration.update();
  }
  return createdClusterId;
}
