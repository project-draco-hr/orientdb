{
  if (connection.getProtocol() instanceof OBinaryNetworkProtocolAbstract) {
    OBinaryNetworkProtocolAbstract proto=(OBinaryNetworkProtocolAbstract)connection.getProtocol();
    byte[] tokenBytes=proto.getTokenBytes();
    OHashToken hashToken=new OHashToken(tokenBytes);
    OClientSessions sess=sessions.get(hashToken);
    if (sess != null) {
      sess.removeConnection(connection);
      if (!sess.isActive()) {
        sessions.remove(hashToken);
      }
    }
  }
}
