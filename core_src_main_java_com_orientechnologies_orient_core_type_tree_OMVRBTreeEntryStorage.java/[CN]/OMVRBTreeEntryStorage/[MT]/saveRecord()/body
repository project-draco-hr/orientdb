{
  record.fromStream(toStream());
  if (record.getIdentity().isValid())   record.setVersion(((OMVRBTreeStorage<K,V>)tree).storage.updateRecord((ORecordId)record.getIdentity(),record.toStream(),-1,record.getRecordType()));
 else {
    record.setIdentity(record.getIdentity().getClusterId(),((OMVRBTreeStorage<K,V>)tree).storage.createRecord((ORecordId)record.getIdentity(),record.toStream(),record.getRecordType()));
  }
  record.unsetDirty();
}
