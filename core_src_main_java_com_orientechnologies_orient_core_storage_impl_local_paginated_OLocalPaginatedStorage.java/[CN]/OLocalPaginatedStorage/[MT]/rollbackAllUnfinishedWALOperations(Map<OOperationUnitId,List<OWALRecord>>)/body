{
  for (  List<OWALRecord> operationUnit : operationUnits.values()) {
    if (operationUnit.isEmpty())     continue;
    final OAtomicUnitStartRecord atomicUnitStartRecord=(OAtomicUnitStartRecord)operationUnit.get(0);
    if (!atomicUnitStartRecord.isRollbackSupported())     continue;
    final OAtomicUnitEndRecord atomicUnitEndRecord=new OAtomicUnitEndRecord(atomicUnitStartRecord.getOperationUnitId(),true);
    writeAheadLog.log(atomicUnitEndRecord);
    operationUnit.add(atomicUnitEndRecord);
    undoOperation(operationUnit);
  }
}
