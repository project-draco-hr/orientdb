{
  if (currentIterator == null)   return null;
  while (!currentIterator.hasNext()) {
    final Map.Entry<Object,OIdentifiable> entry=internalCursor.next(prefetchSize);
    if (entry == null) {
      currentIterator=null;
      return null;
    }
    queryResult.clear();
    applyTailIndexes(entry.getValue(),new IndexValuesResultListener(){
      @Override public boolean addResult(      OIdentifiable value){
        queryResult.add(value);
        return true;
      }
    }
);
    currentIterator=queryResult.iterator();
  }
  if (!currentIterator.hasNext()) {
    currentIterator=null;
    return null;
  }
  final OIdentifiable result=currentIterator.next();
  return new Map.Entry<Object,OIdentifiable>(){
    @Override public Object getKey(){
      throw new UnsupportedOperationException("getKey");
    }
    @Override public OIdentifiable getValue(){
      return result;
    }
    @Override public OIdentifiable setValue(    OIdentifiable value){
      throw new UnsupportedOperationException("setValue");
    }
  }
;
}
