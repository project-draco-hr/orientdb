{
  SpatialContext ctx=SpatialContext.GEO;
  Object[] points=parseParams(iRecord,iCondition);
  Point p=ctx.makePoint((Double)points[2],(Double)points[3]);
  double docDistDEG=ctx.getDistCalc().distance(p,(Double)points[0],(Double)points[1]);
  double docDistInKM=DistanceUtils.degrees2Dist(docDistDEG,DistanceUtils.EARTH_EQUATORIAL_RADIUS_KM);
  iContext.setVariable("$distance",docDistInKM);
  return true;
}
