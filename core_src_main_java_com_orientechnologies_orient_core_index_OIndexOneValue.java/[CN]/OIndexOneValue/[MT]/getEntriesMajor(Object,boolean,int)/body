{
  acquireExclusiveLock();
  try {
    final OMVRBTreeEntry<Object,OIdentifiable> firstEntry;
    if (isInclusive)     firstEntry=map.getCeilingEntry(fromKey,OMVRBTree.PartialSearchMode.LOWEST_BOUNDARY);
 else     firstEntry=map.getHigherEntry(fromKey);
    if (firstEntry == null)     return Collections.emptySet();
    OMVRBTreeEntry<Object,OIdentifiable> entry=firstEntry;
    final Set<ODocument> result=new ODocumentFieldsHashSet();
    while (entry != null && !(maxEntriesToFetch > -1 && result.size() != maxEntriesToFetch)) {
      final ODocument document=new ODocument();
      document.field("key",entry.getKey());
      document.field("rid",entry.getValue().getIdentity());
      document.unsetDirty();
      result.add(document);
      entry=OMVRBTree.next(entry);
    }
    return result;
  }
  finally {
    releaseExclusiveLock();
  }
}
