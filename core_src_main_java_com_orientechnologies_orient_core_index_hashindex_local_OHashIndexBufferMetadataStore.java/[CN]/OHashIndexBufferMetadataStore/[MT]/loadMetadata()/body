{
  final int len=file.readInt(0);
  final OHashIndexFileLevelMetadata[] metadatas=new OHashIndexFileLevelMetadata[len];
  final int bufferSize=file.readInt(OIntegerSerializer.INT_SIZE);
  final byte[] buffer=new byte[bufferSize];
  file.read(2 * OIntegerSerializer.INT_SIZE,buffer,buffer.length);
  int offset=0;
  int i=0;
  while (offset < bufferSize) {
    final String name=OStringSerializer.INSTANCE.deserializeNative(buffer,offset);
    offset+=OStringSerializer.INSTANCE.getObjectSize(name);
    final int id=OIntegerSerializer.INSTANCE.deserializeNative(buffer,offset);
    offset+=OIntegerSerializer.INT_SIZE;
    final long bucketsCount=OLongSerializer.INSTANCE.deserializeNative(buffer,offset);
    offset+=OLongSerializer.LONG_SIZE;
    final long tombstone=OLongSerializer.INSTANCE.deserializeNative(buffer,offset);
    offset+=OLongSerializer.LONG_SIZE;
    final OStorageSegmentConfiguration fileConfiguration=new OStorageSegmentConfiguration(storage.getConfiguration(),name,id);
    final OHashIndexFileLevelMetadata metadata=new OHashIndexFileLevelMetadata(fileConfiguration,bucketsCount,tombstone);
    metadatas[i]=metadata;
    i++;
  }
  return metadatas;
}
