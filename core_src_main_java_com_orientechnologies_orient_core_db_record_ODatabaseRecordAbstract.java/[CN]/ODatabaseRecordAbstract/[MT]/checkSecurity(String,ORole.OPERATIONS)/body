{
  OLogManager.instance().debug(this,"[checkSecurity] Check permissions for resource '%s', operation '%s'",iResource,iOperation);
  if (user != null) {
    try {
      final ORole role=user.allow(iResource,iOperation);
      OLogManager.instance().debug(this,"[checkSecurity] Granted permission for resource '%s', operation '%s' by role: %s",iResource,iOperation,role.getName());
    }
 catch (    OSecurityAccessException e) {
      if (OLogManager.instance().isDebugEnabled())       OLogManager.instance().debug(this,"[checkSecurity] User '%s' tried to access to the reserved resource '%s', operation '%s'",getUser(),iResource,iOperation);
      throw e;
    }
  }
  return (DB)this;
}
