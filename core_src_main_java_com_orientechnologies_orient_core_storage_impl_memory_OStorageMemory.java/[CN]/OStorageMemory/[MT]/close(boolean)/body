{
  lock.acquireExclusiveLock();
  try {
    if (!checkForClose(iForce))     return;
    status=STATUS.CLOSING;
    for (    OClusterMemory c : clusters)     if (c != null)     c.close();
    clusters.clear();
    for (    ODataSegmentMemory d : dataSegments)     if (d != null)     d.close();
    dataSegments.clear();
    level2Cache.shutdown();
    super.close(iForce);
    Orient.instance().unregisterStorage(this);
    status=STATUS.CLOSED;
  }
  finally {
    lock.releaseExclusiveLock();
  }
}
