{
  if (clusterMap.containsKey(cluster.getName()))   throw new OConfigurationException("Can't add segment " + cluster.getName() + " because it was already registered");
  clusterMap.put(cluster.getName(),cluster);
  final int id=clusters.length;
  clusters=OArrays.copyOf(clusters,id + 1);
  clusters[id]=cluster;
  return id;
}
