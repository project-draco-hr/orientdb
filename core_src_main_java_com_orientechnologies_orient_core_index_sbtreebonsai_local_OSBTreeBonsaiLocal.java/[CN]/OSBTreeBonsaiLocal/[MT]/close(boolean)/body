{
  Lock lock=fileLockManager.acquireExclusiveLock(fileId);
  try {
    readCache.closeFile(fileId,flush,writeCache);
  }
 catch (  IOException e) {
    throw OException.wrapException(new OSBTreeException("Error during close of index " + getName()),e);
  }
 finally {
    lock.unlock();
  }
}
