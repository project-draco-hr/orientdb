{
  final int pendingMsgs=localQueue.size();
  if (pendingMsgs > 0)   ODistributedServerLog.warn(this,getLocalNodeName(),null,ODistributedServerLog.DIRECTION.NONE,"Received shutdown signal, waiting for distributed worker queue is empty (pending msgs=%d)...",pendingMsgs);
  try {
    running=false;
    interrupt();
    if (pendingMsgs > 0)     join();
    ODistributedServerLog.warn(this,getLocalNodeName(),null,ODistributedServerLog.DIRECTION.NONE,"Shutdown distributed worker completed");
    localQueue.clear();
    if (database != null)     database.close();
  }
 catch (  Exception e) {
    ODistributedServerLog.warn(this,getLocalNodeName(),null,ODistributedServerLog.DIRECTION.NONE,"Error on shutting down distributed worker",e);
  }
}
