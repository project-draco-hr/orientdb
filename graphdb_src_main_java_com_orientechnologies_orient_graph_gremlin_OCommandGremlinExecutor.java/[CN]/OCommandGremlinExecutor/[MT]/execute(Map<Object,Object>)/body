{
  try {
    final Object result=engine.eval(text);
    if (result instanceof GremlinPipeline) {
      final List<Object> coll=new ArrayList<Object>();
      final Iterator<?> it=((GremlinPipeline<?,?>)result).iterator();
      while (it.hasNext())       coll.add(it.next());
      return coll.toString();
    }
    return result;
  }
 catch (  ScriptException e) {
    throw new OCommandExecutionException("Error on executing GREMLIN command: " + text,e);
  }
 finally {
    graph.shutdown();
  }
}
