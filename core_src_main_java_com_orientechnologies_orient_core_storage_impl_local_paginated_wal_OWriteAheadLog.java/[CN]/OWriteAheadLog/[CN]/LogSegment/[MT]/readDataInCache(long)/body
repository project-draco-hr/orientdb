{
  final long pageCount=rndFile.length() / OWALPage.PAGE_SIZE;
  final long cacheSize=OGlobalConfiguration.WAL_READ_CACHE_SIZE.getValueAsInteger();
  final long endPage=Math.min(pageCount,pageIndex + cacheSize);
  final HashMap<Long,byte[]> result=new HashMap<Long,byte[]>((int)(endPage - pageIndex));
  rndFile.seek(pageIndex * OWALPage.PAGE_SIZE);
  while (pageIndex < endPage) {
synchronized (rndFile) {
      byte[] pageContent=new byte[OWALPage.PAGE_SIZE];
      rndFile.readFully(pageContent);
      result.put(pageIndex,pageContent);
      pageIndex++;
    }
  }
  return result;
}
