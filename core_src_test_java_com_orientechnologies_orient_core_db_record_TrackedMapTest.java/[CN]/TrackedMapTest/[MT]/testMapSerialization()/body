{
  ODocument doc=new ODocument();
  OTrackedMap<String> beforeSerialization=new OTrackedMap<String>(doc);
  beforeSerialization.put(0,"firstVal");
  beforeSerialization.put(1,"secondVal");
  final OMemoryStream memoryStream=new OMemoryStream();
  ObjectOutputStream out=new ObjectOutputStream(memoryStream);
  out.writeObject(beforeSerialization);
  out.close();
  final ObjectInputStream input=new ObjectInputStream(new OMemoryInputStream(memoryStream.copy()));
  @SuppressWarnings("unchecked") final OTrackedMap<String> afterSerialization=(OTrackedMap<String>)input.readObject();
  Assert.assertEquals(afterSerialization.size(),beforeSerialization.size(),"Map size");
  for (int i=0; i < afterSerialization.size(); i++) {
    Assert.assertEquals(afterSerialization.get(i),beforeSerialization.get(i));
  }
}
