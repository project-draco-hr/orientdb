{
  final StringBuilder columnRow=new StringBuilder("\n");
  final StringBuilder noteRow=new StringBuilder(columnNotes.isEmpty() ? "" : "\n");
  printHeaderLine(iColumns);
  int i=0;
  if (leftBorder) {
    columnRow.append('|');
    if (!columnNotes.isEmpty())     noteRow.append('|');
  }
  for (  Entry<String,Integer> column : iColumns.entrySet()) {
    String colName=column.getKey();
    if (columnHidden.contains(colName))     continue;
    if (i++ > 0) {
      columnRow.append('|');
      if (!columnNotes.isEmpty())       noteRow.append('|');
    }
    if (colName.length() > column.getValue())     colName=colName.substring(0,column.getValue());
    columnRow.append(String.format("%-" + column.getValue() + "s",colName));
    if (!columnNotes.isEmpty()) {
      String note=columnNotes.get(column.getKey());
      if (note == null)       note="";
      if (note.length() > column.getValue())       note=note.substring(0,column.getValue());
      noteRow.append(String.format("%-" + column.getValue() + "s",note));
    }
  }
  if (rightBorder) {
    columnRow.append('|');
    if (!columnNotes.isEmpty())     noteRow.append('|');
  }
  out.onMessage(columnRow.toString());
  if (!columnNotes.isEmpty())   out.onMessage(noteRow.toString());
  printHeaderLine(iColumns);
}
