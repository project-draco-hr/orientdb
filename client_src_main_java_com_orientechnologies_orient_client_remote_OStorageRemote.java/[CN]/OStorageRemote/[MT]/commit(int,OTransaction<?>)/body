{
  checkConnection();
  do {
    boolean locked=acquireExclusiveLock();
    try {
      network.writeByte(OChannelBinaryProtocol.TX_COMMIT);
      network.writeInt(iTx.getId());
      network.writeInt(iTx.size());
      for (      OTransactionEntry<? extends ORecord<?>> txEntry : iTx.getEntries()) {
        if (txEntry.status == OTransactionEntry.LOADED)         continue;
        network.writeByte((byte)txEntry.status);
        network.writeShort((short)txEntry.record.getIdentity().getClusterId());
switch (txEntry.status) {
case OTransactionEntry.CREATED:
          network.writeString(txEntry.clusterName);
        network.writeBytes(txEntry.record.toStream());
      break;
case OTransactionEntry.UPDATED:
    network.writeLong(txEntry.record.getIdentity().getClusterPosition());
  network.writeInt(txEntry.record.getVersion());
network.writeBytes(txEntry.record.toStream());
case OTransactionEntry.DELETED:
network.writeLong(txEntry.record.getIdentity().getClusterPosition());
network.writeInt(txEntry.record.getVersion());
}
}
network.flush();
readStatus();
break;
}
 catch (Exception e) {
if (handleException("Error on commit",e)) break;
}
 finally {
releaseExclusiveLock(locked);
}
}
 while (true);
}
