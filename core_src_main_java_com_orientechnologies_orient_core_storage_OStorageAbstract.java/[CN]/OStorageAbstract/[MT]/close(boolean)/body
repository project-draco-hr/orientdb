{
  if (!checkForClose(iForce))   return;
  for (  Object resource : sharedResources.values()) {
    if (resource instanceof OSharedResource)     ((OSharedResource)resource).releaseExclusiveLock();
    if (resource instanceof OCloseable)     ((OCloseable)resource).close();
  }
  sharedResources.clear();
  Orient.instance().unregisterStorage(this);
}
