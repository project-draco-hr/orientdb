{
  final OSchema schema=database.getMetadata().getSchema();
  if (!schema.existsClass("CMEInCaseOfHide")) {
    schema.createClass("CMEInCaseOfHide");
  }
  ODocument document=new ODocument("CMEInCaseOfHide");
  document.field("index",1);
  document.save();
  ODocument brokenDoc=database.load(document.getIdentity(),"*:-1",true);
  document.field("val","val");
  document.save();
  try {
    brokenDoc.hide();
    Assert.fail();
  }
 catch (  OConcurrentModificationException e) {
  }
catch (  OResponseProcessingException e) {
    Assert.assertTrue(e.getCause() instanceof OConcurrentModificationException);
  }
}
