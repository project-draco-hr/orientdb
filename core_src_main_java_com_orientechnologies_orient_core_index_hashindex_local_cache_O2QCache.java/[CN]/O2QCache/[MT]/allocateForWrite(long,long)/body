{
synchronized (syncObject) {
    final OMultiFileSegment multiFileSegment=files.get(fileId);
    final long startPosition=pageIndex * pageSize;
    final long endPosition=startPosition + pageSize;
    if (multiFileSegment.getFilledUpTo() < endPosition)     multiFileSegment.allocateSpaceContinuously((int)(endPosition - multiFileSegment.getFilledUpTo()));
    long dataPointer=directMemory.allocate(new byte[pageSize]);
    LRUEntry lruEntry=updateCache(fileId,pageIndex,dataPointer);
    lruEntry.usageCounter.incrementAndGet();
    return dataPointer;
  }
}
