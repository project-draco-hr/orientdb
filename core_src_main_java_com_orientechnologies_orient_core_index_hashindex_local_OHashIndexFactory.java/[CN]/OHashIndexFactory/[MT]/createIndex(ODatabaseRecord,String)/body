{
  if (!(iDatabase.getStorage() instanceof OStorageLocal))   throw new OConfigurationException("Given configuration works only for local storage.");
  final OStorageLocal storageLocal=(OStorageLocal)iDatabase.getStorage();
  final ODirectMemory directMemory=ODirectMemoryFactory.INSTANCE.directMemory();
  if (directMemory == null)   throw new OConfigurationException("There is no suitable direct memory implementation for this platform." + " Index creation was canceled.");
  if (OUniqueHashIndex.TYPE_ID.equals(iIndexType))   return new OUniqueHashIndex(storageLocal);
  throw new OConfigurationException("Unsupported type : " + iIndexType);
}
