{
  if (!(getDatabase().getStorage() instanceof OStorageProxy)) {
    getDatabase().registerListener(index.getInternal());
    if (index instanceof OIndexMultiValues)     return new OIndexTxAwareMultiValue(getDatabase(),(OIndex<Collection<OIdentifiable>>)getIndexInstance(index));
 else     if (index instanceof OIndexDictionary)     return new OIndexTxAwareDictionary(getDatabase(),(OIndex<OIdentifiable>)getIndexInstance(index));
 else     if (index instanceof OIndexOneValue)     return new OIndexTxAwareOneValue(getDatabase(),(OIndex<OIdentifiable>)getIndexInstance(index));
  }
  return index;
}
