{
  final Map<OIdentifiable,OModifiableInteger> convertedEntries=new HashMap<OIdentifiable,OModifiableInteger>();
  for (  Map.Entry<OIdentifiable,OModifiableInteger> entry : entries.entrySet()) {
    if (entry.getKey() instanceof ORecord) {
      final ORecord record=(ORecord)entry.getKey();
      if (record.isDirty() || entry.getKey().getIdentity().isNew()) {
        record.save();
        convertedEntries.put(record.getIdentity(),entry.getValue());
      }
    }
 else     convertedEntries.put(entry.getKey().getIdentity(),entry.getValue());
  }
  for (  Map.Entry<OIdentifiable,OModifiableInteger> entry : entries.entrySet()) {
    if (entry.getKey() instanceof ORecord) {
      final ORecord record=(ORecord)entry.getKey();
      record.save();
      convertedEntries.put(record.getIdentity(),entry.getValue());
    }
 else     convertedEntries.put(entry.getKey().getIdentity(),entry.getValue());
  }
  newEntries.clear();
  entries.clear();
  entries.putAll(convertedEntries);
  return true;
}
