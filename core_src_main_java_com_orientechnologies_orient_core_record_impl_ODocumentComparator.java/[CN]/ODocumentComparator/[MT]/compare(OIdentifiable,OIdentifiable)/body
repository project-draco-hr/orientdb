{
  Object fieldValue1;
  Object fieldValue2;
  int partialResult=0;
  for (  OPair<String,String> field : orderCriteria) {
    fieldValue1=((ODocument)iDoc1.getRecord()).field(field.getKey());
    if (fieldValue1 == null)     return 1;
    fieldValue2=((ODocument)iDoc2.getRecord()).field(field.getKey());
    if (fieldValue2 == null)     return -1;
    if (!(fieldValue1 instanceof Comparable<?>))     throw new IllegalArgumentException("Can't sort documents because the field '" + field.getKey() + "' is not comparable");
    partialResult=((Comparable<Object>)fieldValue1).compareTo(fieldValue2);
    partialResult=factor(partialResult,field.getValue());
    if (partialResult != 0)     break;
  }
  return partialResult;
}
