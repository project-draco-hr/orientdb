{
  if (query == null && indexName == null)   throw new OCommandExecutionException("Cannot execute the command because it has not been parsed yet");
  if (query != null) {
    query.execute(iArgs);
    return recordCount;
  }
 else {
    if (compiledFilter != null)     compiledFilter.bindParameters(iArgs);
    final OIndex<?> index=getDatabase().getMetadata().getIndexManager().getIndex(indexName);
    if (index == null)     throw new OCommandExecutionException("Target index '" + indexName + "' not found");
    Object key=null;
    Object value=VALUE_NOT_FOUND;
    if (compiledFilter == null || compiledFilter.getRootCondition() == null) {
      final long total=index.getSize();
      index.clear();
      return total;
    }
 else {
      if (KEYWORD_KEY.equalsIgnoreCase(compiledFilter.getRootCondition().getLeft().toString()))       key=getIndexKey(index.getDefinition(),compiledFilter.getRootCondition().getRight());
 else       if (KEYWORD_RID.equalsIgnoreCase(compiledFilter.getRootCondition().getLeft().toString())) {
        value=OSQLHelper.getValue(compiledFilter.getRootCondition().getRight());
      }
 else       if (compiledFilter.getRootCondition().getLeft() instanceof OSQLFilterCondition) {
        final OSQLFilterCondition leftCondition=(OSQLFilterCondition)compiledFilter.getRootCondition().getLeft();
        if (KEYWORD_KEY.equalsIgnoreCase(leftCondition.getLeft().toString()))         key=getIndexKey(index.getDefinition(),leftCondition.getRight());
        final OSQLFilterCondition rightCondition=(OSQLFilterCondition)compiledFilter.getRootCondition().getRight();
        if (KEYWORD_RID.equalsIgnoreCase(rightCondition.getLeft().toString()))         value=OSQLHelper.getValue(rightCondition.getRight());
      }
      final boolean result;
      if (value != VALUE_NOT_FOUND)       if (key != null)       result=index.remove(key,(OIdentifiable)value);
 else       return index.remove((OIdentifiable)value);
 else       result=index.remove(key);
      return result ? 1 : 0;
    }
  }
}
