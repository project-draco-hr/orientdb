{
  final int id;
  if (cluster != null) {
    if (clusterMap.containsKey(cluster.getName()))     throw new OConfigurationException("Cannot add segment '" + cluster.getName() + "' because it is already registered in database '"+ name+ "'");
    clusterMap.put(cluster.getName(),cluster);
    id=cluster.getId();
  }
 else {
    id=clusters.length;
  }
  if (id >= clusters.length) {
    clusters=OArrays.copyOf(clusters,id + 1);
  }
  clusters[id]=cluster;
  return id;
}
