{
  final ODatabaseRecord database=ODatabaseRecordThreadLocal.INSTANCE.get();
  if (!(database.getStorage() instanceof OStorageEmbedded))   throw new OCommandExecutionException("Native queries can run only in embedded-local version. Not in the remote one.");
  queryRecord.setSourceQuery(this);
  final OClass cls=database.getMetadata().getSchema().getClass(cluster);
  if (cls == null)   throw new OCommandExecutionException("Cluster " + cluster + " was not found");
  ((OStorageEmbedded)database.getStorage()).browse(cls.getPolymorphicClusterIds(),null,null,this,record,false);
  return null;
}
