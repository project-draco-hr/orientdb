{
  if (input instanceof OIdentifiable) {
    final ORecord rec=((OIdentifiable)input).getRecord();
    if (rec instanceof ODocument) {
      final ODocument doc=(ODocument)rec;
      if (setOperation) {
        final Object newValue;
        if (expression != null) {
          if (sqlFilter == null)           sqlFilter=new OSQLFilter(expression,context,null);
          newValue=sqlFilter.evaluate(doc,null,context);
        }
 else         newValue=value;
        doc.field(fieldName,newValue);
        log(OETLProcessor.LOG_LEVELS.DEBUG,"set %s=%s in document=%s",fieldName,newValue,doc);
      }
 else {
        final Object prev=doc.removeField(fieldName);
        log(OETLProcessor.LOG_LEVELS.DEBUG,"removed %s (value=%s) from document=%s",fieldName,prev,doc);
      }
      if (save) {
        final ODatabaseDocumentTx db=super.pipeline.getDocumentDatabase();
        if (db == null)         throw new OTransformException("Database instance not found in pipeline");
        log(OETLProcessor.LOG_LEVELS.DEBUG,"saving record %s",doc);
        db.save(doc);
      }
    }
  }
  return input;
}
