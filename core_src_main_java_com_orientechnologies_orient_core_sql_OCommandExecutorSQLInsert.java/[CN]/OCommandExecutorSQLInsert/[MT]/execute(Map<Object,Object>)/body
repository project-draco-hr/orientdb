{
  if (newRecords == null)   throw new OCommandExecutionException("Cannot execute the command because it has not been parsed yet");
  if (indexName != null) {
    final OIndex<?> index=getDatabase().getMetadata().getIndexManager().getIndex(indexName);
    if (index == null)     throw new OCommandExecutionException("Target index '" + indexName + "' not found");
    Map<String,Object> result=null;
    for (    Map<String,Object> candidate : newRecords) {
      index.put(candidate.get(KEYWORD_KEY),(OIdentifiable)candidate.get(KEYWORD_RID));
      result=candidate;
    }
    return new ODocument(result);
  }
 else {
    final List<ODocument> docs=new ArrayList<ODocument>();
    for (    Map<String,Object> candidate : newRecords) {
      final ODocument doc=className != null ? new ODocument(className) : new ODocument();
      OSQLHelper.bindParameters(doc,candidate,new OCommandParameters(iArgs));
      if (clusterName != null) {
        doc.save(clusterName);
      }
 else {
        doc.save();
      }
      docs.add(doc);
    }
    if (docs.size() == 1) {
      return docs.get(0);
    }
 else {
      return docs;
    }
  }
}
