{
  if (document != null)   return;
  document=iSource;
  mode=((Number)document.field("mode")).byteValue() == STREAM_ALLOW ? ALLOW_MODES.ALLOW_ALL_BUT : ALLOW_MODES.DENY_ALL_BUT;
  final String roleName=document.field("inheritedRole");
  parentRole=roleName != null ? document.getDatabase().getMetadata().getSecurity().getRole(roleName) : null;
  final Map<String,Number> storedRules=document.field("rules");
  for (  Entry<String,Number> a : storedRules.entrySet()) {
    rules.put(a.getKey(),a.getValue().byteValue());
  }
}
