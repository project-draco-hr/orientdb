{
  setDataCommandInfo("Connect");
  readConnectionData();
  connection.serverUser=server.serverLogin(channel.readString(),channel.readString(),"connect");
  if (connection.serverUser == null)   throw new OSecurityAccessException("Wrong user/password to [connect] to the remote OrientDB Server instance. Get the user/password from the config/orientdb-server-config.xml file");
  beginResponse();
  try {
    sendOk(clientTxId);
    channel.writeInt(connection.id);
    if (connection.data.protocolVersion > OChannelBinaryProtocol.PROTOCOL_VERSION_26) {
      connection.data.serverUsername=connection.serverUser.name;
      connection.data.serverUser=true;
      byte[] token;
      if (Boolean.TRUE.equals(tokenBased)) {
        token=tokenHandler.getSignedBinaryToken(null,null,connection.data);
      }
 else       token=OCommonConst.EMPTY_BYTE_ARRAY;
      channel.writeBytes(token);
    }
  }
  finally {
    endResponse();
  }
}
