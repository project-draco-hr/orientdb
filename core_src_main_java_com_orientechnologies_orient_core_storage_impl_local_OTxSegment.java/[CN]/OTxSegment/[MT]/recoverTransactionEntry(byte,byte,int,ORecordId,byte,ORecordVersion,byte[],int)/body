{
  final OCluster cluster=storage.getClusterById(iRid.clusterId);
  if (!(cluster instanceof OClusterLocal || cluster instanceof OClusterLocalEH))   return;
  OLogManager.instance().debug(this,"Recovering tx <%d>. Operation <%d> was in status <%d> on record %s size=%d...",iTxId,iOperation,iStatus,iRid,iRecordContent != null ? iRecordContent.length : 0);
switch (iOperation) {
case OPERATION_CREATE:
    storage.deleteRecord(iRid,OVersionFactory.instance().createUntrackedVersion(),0,null);
  break;
case OPERATION_UPDATE:
iRecordVersion.setRollbackMode();
storage.updateRecord(cluster,iRid,iRecordContent,iRecordVersion,iRecordType);
break;
case OPERATION_DELETE:
final ODataLocal dataSegment=storage.getDataSegmentById(dataSegmentId);
storage.createRecord(dataSegment,cluster,iRecordContent,iRecordType,iRid,iRecordVersion);
break;
}
}
