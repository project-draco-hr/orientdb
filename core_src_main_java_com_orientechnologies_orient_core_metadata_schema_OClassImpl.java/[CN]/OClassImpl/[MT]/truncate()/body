{
  getDatabase().checkSecurity(ODatabaseSecurityResources.CLASS,ORole.PERMISSION_UPDATE);
  getDatabase().getStorage().callInLock(new Callable<Object>(){
    public Object call() throws Exception {
      for (      int id : clusterIds) {
        getDatabase().getStorage().getClusterById(id).truncate();
      }
      for (      OIndex<?> index : getClassIndexes()) {
        index.clear();
      }
      return null;
    }
  }
,true);
}
