{
  syncObject.lock();
  try {
    if (closed)     return;
    closed=true;
    for (    LogSegment logSegment : logSegments)     logSegment.close(flush);
    masterRecordLSNHolder.close();
  }
  finally {
    syncObject.unlock();
  }
}
