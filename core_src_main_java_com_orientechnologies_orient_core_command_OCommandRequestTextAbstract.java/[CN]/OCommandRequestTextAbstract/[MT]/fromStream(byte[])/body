{
  final OMemoryInputStream buffer=new OMemoryInputStream(iStream);
  try {
    text=buffer.getAsString();
    byte[] paramBuffer=buffer.getAsByteArray();
    if (paramBuffer.length == 0)     parameters=null;
 else {
      final ODocument param=new ODocument(database);
      param.fromStream(paramBuffer);
      Map<String,Object> params=param.field("params");
      parameters=new HashMap<Object,Object>();
      for (      Entry<String,Object> p : params.entrySet()) {
        final Object value;
        if (p.getValue() instanceof String)         value=ORecordSerializerStringAbstract.getTypeValue((String)p.getValue());
 else         value=p.getValue();
        if (Character.isDigit(p.getKey().charAt(0)))         parameters.put(Integer.parseInt(p.getKey()),value);
 else         parameters.put(p.getKey(),value);
      }
    }
  }
 catch (  IOException e) {
    throw new OSerializationException("Error while unmarshalling OCommandRequestTextAbstract impl",e);
  }
  return this;
}
