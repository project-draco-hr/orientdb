{
  if (writeAheadLog == null)   return;
  lock.acquireExclusiveLock();
  try {
    writeAheadLog.flush();
    if (configuration != null)     configuration.synch();
    writeAheadLog.logFullCheckpointStart();
    diskCache.flushBuffer();
    writeAheadLog.logFullCheckpointEnd();
    writeAheadLog.flush();
  }
 catch (  IOException ioe) {
    throw new OStorageException("Error during checkpoint creation for storage " + name,ioe);
  }
 finally {
    lock.releaseExclusiveLock();
  }
}
