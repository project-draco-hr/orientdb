{
  Iterator<OIndexFactory> ite=getAllFactories();
  boolean found=false;
  while (ite.hasNext()) {
    final OIndexFactory factory=ite.next();
    found=found || factory.getAlgorithms().contains(algorithm);
  }
  if (!found) {
    throw new OIndexException("Engine type: '" + algorithm + "' is not supported. Types are "+ OCollections.toString(getIndexEngines())+ ". Please check the engine name or verify that the engine '"+ algorithm+ "' is installed correctly");
  }
  ite=getAllFactories();
  while (ite.hasNext()) {
    final OIndexFactory factory=ite.next();
    if (factory.getTypes().contains(indexType) && factory.getAlgorithms().contains(algorithm)) {
      return factory.createIndex(database,indexType,algorithm,valueContainerAlgorithm,metadata);
    }
  }
  throw new OIndexException("Index type: " + indexType + " is not supported. Types are "+ OCollections.toString(getIndexTypes()));
}
