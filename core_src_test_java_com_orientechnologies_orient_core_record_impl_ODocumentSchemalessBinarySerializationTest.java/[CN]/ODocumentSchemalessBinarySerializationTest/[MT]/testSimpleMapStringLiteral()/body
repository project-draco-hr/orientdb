{
  ODatabaseRecordThreadLocal.INSTANCE.set(null);
  ODocument document=new ODocument();
  Map<String,String> mapString=new HashMap<String,String>();
  mapString.put("key","value");
  mapString.put("key1","value1");
  document.field("mapString",mapString);
  Map<String,Integer> mapInt=new HashMap<String,Integer>();
  mapInt.put("key",2);
  mapInt.put("key1",3);
  document.field("mapInt",mapInt);
  Map<String,Long> mapLong=new HashMap<String,Long>();
  mapLong.put("key",2L);
  mapLong.put("key1",3L);
  document.field("mapLong",mapLong);
  Map<String,Short> shortMap=new HashMap<String,Short>();
  shortMap.put("key",(short)2);
  shortMap.put("key1",(short)3);
  document.field("shortMap",shortMap);
  Map<String,Date> dateMap=new HashMap<String,Date>();
  dateMap.put("key",new Date());
  dateMap.put("key1",new Date());
  document.field("dateMap",dateMap);
  Map<String,Float> floatMap=new HashMap<String,Float>();
  floatMap.put("key",10f);
  floatMap.put("key1",11f);
  document.field("floatMap",floatMap);
  Map<String,Double> doubleMap=new HashMap<String,Double>();
  doubleMap.put("key",10d);
  doubleMap.put("key1",11d);
  document.field("doubleMap",doubleMap);
  Map<String,Byte> bytesMap=new HashMap<String,Byte>();
  bytesMap.put("key",(byte)10);
  bytesMap.put("key1",(byte)11);
  document.field("bytesMap",bytesMap);
  Map<String,String> mapWithNulls=new HashMap<String,String>();
  mapWithNulls.put("key","dddd");
  mapWithNulls.put("key1",null);
  document.field("bytesMap",mapWithNulls);
  byte[] res=serializer.toStream(document,false);
  ODocument extr=(ODocument)serializer.fromStream(res,new ODocument(),new String[]{});
  assertEquals(extr.fields(),document.fields());
  assertEquals(extr.field("mapString"),document.field("mapString"));
  assertEquals(extr.field("mapLong"),document.field("mapLong"));
  assertEquals(extr.field("shortMap"),document.field("shortMap"));
  assertEquals(extr.field("dateMap"),document.field("dateMap"));
  assertEquals(extr.field("doubleMap"),document.field("doubleMap"));
  assertEquals(extr.field("bytesMap"),document.field("bytesMap"));
}
