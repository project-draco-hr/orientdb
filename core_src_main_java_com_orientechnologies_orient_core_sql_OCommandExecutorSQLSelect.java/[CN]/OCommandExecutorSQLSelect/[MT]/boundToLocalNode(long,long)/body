{
  if (fromId == toId) {
    return this;
  }
  final Set<Integer> clusters=getInvolvedClusters();
  if (!clusters.isEmpty()) {
    final OSQLFilterCondition nodeCondition;
    if (fromId < toId) {
      nodeCondition=getConditionForClusters(clusters,fromId,toId);
    }
 else {
      nodeCondition=new OSQLFilterCondition(getConditionForClusters(clusters,fromId,Long.MAX_VALUE),new OQueryOperatorOr(),getConditionForClusters(clusters,-1L,toId));
    }
    if (compiledFilter == null) {
      compiledFilter=OSQLEngine.getInstance().parseCondition("",getContext(),KEYWORD_WHERE);
    }
    final OSQLFilterCondition rootCondition=compiledFilter.getRootCondition();
    if (rootCondition != null) {
      compiledFilter.setRootCondition(new OSQLFilterCondition(nodeCondition,new OQueryOperatorAnd(),rootCondition));
    }
 else {
      compiledFilter.setRootCondition(nodeCondition);
    }
  }
  return this;
}
