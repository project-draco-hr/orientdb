{
  final ODocument sourceVertex=(ODocument)iEdge.field(OGraphDatabase.EDGE_FIELD_OUT);
  final ODocument targetVertex=(ODocument)iEdge.field(OGraphDatabase.EDGE_FIELD_IN);
  Set<OGraphEdge> edges;
  if (sourceVertex != null && iDatabase.existsUserObjectByRID(sourceVertex.getIdentity())) {
    final OGraphVertex vertex=(OGraphVertex)iDatabase.getUserObjectByRecord(sourceVertex,null);
    edges=vertex.getOutEdges();
    if (edges != null) {
      for (      OGraphEdge e : edges)       if (e.getDocument().equals(iEdge)) {
        edges.remove(e);
        break;
      }
    }
  }
  if (targetVertex != null && iDatabase.existsUserObjectByRID(targetVertex.getIdentity())) {
    final OGraphVertex vertex=(OGraphVertex)iDatabase.getUserObjectByRecord(targetVertex,null);
    edges=vertex.getInEdges();
    if (edges != null) {
      for (      OGraphEdge e : edges)       if (e.getDocument().equals(iEdge)) {
        edges.remove(e);
        break;
      }
    }
  }
  Set<ODocument> docs=sourceVertex.field(OGraphDatabase.VERTEX_FIELD_OUT_EDGES);
  if (docs != null)   docs.remove(iEdge);
  sourceVertex.setDirty();
  sourceVertex.save();
  docs=targetVertex.field(OGraphDatabase.VERTEX_FIELD_IN_EDGES);
  if (docs != null)   docs.remove(iEdge);
  targetVertex.setDirty();
  targetVertex.save();
  if (iDatabase.existsUserObjectByRID(iEdge.getIdentity())) {
    final OGraphEdge edge=(OGraphEdge)iDatabase.getUserObjectByRecord(iEdge,null);
    iDatabase.unregisterPojo(edge,iEdge);
  }
  iEdge.delete();
}
