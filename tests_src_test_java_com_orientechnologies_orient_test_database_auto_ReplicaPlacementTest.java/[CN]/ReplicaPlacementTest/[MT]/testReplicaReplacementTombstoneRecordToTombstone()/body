{
  if (!OGlobalConfiguration.USE_LHPEPS_MEMORY_CLUSTER.getValueAsBoolean())   return;
  ODatabaseRecordThreadLocal.INSTANCE.set(dbOne);
  ORecordBytes recordOne=new ORecordBytes(new byte[]{10,11,22,33,44,55,66,77});
  recordOne.save();
  ODatabaseRecordThreadLocal.INSTANCE.set(dbTwo);
  dbTwo.updatedReplica(recordOne);
  ORecordBytes recordTwo=dbTwo.load(recordOne.getIdentity());
  Assert.assertNotNull(recordTwo);
  recordTwo.delete();
  ODatabaseRecordThreadLocal.INSTANCE.set(dbOne);
  recordOne.setDirty();
  recordOne.fromInputStream(new ByteArrayInputStream(new byte[]{10,11,22}));
  recordOne.save();
  recordOne.delete();
  recordOne=dbOne.load(recordOne.getIdentity(),"*:0",false,true);
  ORecordVersion docOneVersion=recordOne.getRecordVersion();
  ODatabaseRecordThreadLocal.INSTANCE.set(dbTwo);
  dbTwo.updatedReplica(recordOne);
  recordTwo=dbTwo.load(recordOne.getIdentity(),"*:0",false,true);
  Assert.assertEquals(docOneVersion,recordTwo.getRecordVersion());
}
