{
  if (currentRemoved)   throw new IllegalStateException("Current element has already been removed");
  if (currentValue == null)   throw new IllegalStateException("Next method was not called for given iterator");
  currentRemoved=true;
  if (currentValue.getIdentity().isValid()) {
    OModifiableInteger counter=entries.get(currentValue);
    counter.decrement();
    if (counter.intValue() < 1) {
      entries.remove(currentValue);
      if (currentValue instanceof ORecord) {
        ORecord record=(ORecord)currentValue;
        record.removeIdentityChangeListener(OEmbeddedRidBag.this);
      }
      entriesIterator=entries.tailMap(currentValue,false).entrySet().iterator();
    }
  }
 else {
    newEntries.remove(currentValue);
    if (currentValue instanceof ORecord) {
      ORecord record=(ORecord)currentValue;
      record.removeIdentityChangeListener(OEmbeddedRidBag.this);
    }
  }
  size--;
  fireCollectionChangedEvent(new OMultiValueChangeEvent<OIdentifiable,OIdentifiable>(OMultiValueChangeEvent.OChangeType.REMOVE,currentValue,null,currentValue));
}
