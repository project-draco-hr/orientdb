{
  acquireExclusiveLock();
  try {
    final ORID rid=configuration.field(CONFIG_MAP_RID,ORID.class);
    if (rid == null)     throw new OIndexException("Error during deserialization of index definition: '" + CONFIG_MAP_RID + "' attribute is null");
    identity=rid;
    this.configuration=configuration;
    storage=(OStorageLocalAbstract)getDatabase().getStorage();
    clustersToIndex.clear();
    IndexMetadata indexMetadata=loadMetadata(configuration);
    name=indexMetadata.getName();
    type=indexMetadata.getType();
    indexDefinition=indexMetadata.getIndexDefinition();
    clustersToIndex.addAll(indexMetadata.getClustersToIndex());
    keyHashFunction.setValueSerializer((OBinarySerializer<Object>)detectKeySerializer(indexDefinition));
    localHashTable.load(name,storage);
    return true;
  }
  finally {
    releaseExclusiveLock();
  }
}
