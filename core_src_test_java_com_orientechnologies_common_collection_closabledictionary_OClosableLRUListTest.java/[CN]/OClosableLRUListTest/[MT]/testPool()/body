{
  OClosableLRUList<Long,CIItem> lruList=new OClosableLRUList<Long,CIItem>();
  OClosableEntry<Long,CIItem> firstEntry=new OClosableEntry<Long,CIItem>(new CIItem());
  OClosableEntry<Long,CIItem> secondEntry=new OClosableEntry<Long,CIItem>(new CIItem());
  OClosableEntry<Long,CIItem> thirdEntry=new OClosableEntry<Long,CIItem>(new CIItem());
  lruList.moveToTheTail(firstEntry);
  lruList.moveToTheTail(secondEntry);
  lruList.moveToTheTail(thirdEntry);
  OClosableEntry<Long,CIItem> removed=lruList.poll();
  Assert.assertTrue(removed == firstEntry);
  Assert.assertEquals(lruList.size(),2);
  Assert.assertTrue(!lruList.contains(firstEntry));
  Assert.assertTrue(lruList.contains(secondEntry));
  Assert.assertTrue(lruList.contains(thirdEntry));
  assertContent(lruList,new OClosableEntry[]{secondEntry,thirdEntry});
  Assert.assertTrue(lruList.assertBackwardStructure());
  Assert.assertTrue(lruList.assertForwardStructure());
  removed=lruList.poll();
  Assert.assertTrue(removed == secondEntry);
  Assert.assertEquals(lruList.size(),1);
  Assert.assertTrue(!lruList.contains(firstEntry));
  Assert.assertTrue(!lruList.contains(secondEntry));
  Assert.assertTrue(lruList.contains(thirdEntry));
  assertContent(lruList,new OClosableEntry[]{thirdEntry});
  Assert.assertTrue(lruList.assertBackwardStructure());
  Assert.assertTrue(lruList.assertForwardStructure());
  removed=lruList.poll();
  Assert.assertTrue(removed == thirdEntry);
  Assert.assertEquals(lruList.size(),0);
  Assert.assertTrue(!lruList.contains(firstEntry));
  Assert.assertTrue(!lruList.contains(secondEntry));
  Assert.assertTrue(!lruList.contains(thirdEntry));
  assertContent(lruList,new OClosableEntry[]{});
  Assert.assertTrue(lruList.assertBackwardStructure());
  Assert.assertTrue(lruList.assertForwardStructure());
  removed=lruList.poll();
  Assert.assertTrue(removed == null);
}
