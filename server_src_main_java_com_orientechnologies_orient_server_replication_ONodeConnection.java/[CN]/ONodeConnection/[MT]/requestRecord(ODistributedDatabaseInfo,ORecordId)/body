{
  logger.setNode(databaseEntry.serverId);
  logger.setDatabase(databaseEntry.databaseName);
  if (OLogManager.instance().isInfoEnabled())   logger.log(this,Level.INFO,TYPE.REPLICATION,DIRECTION.IN,"%s record",rid);
  do {
    try {
      final OChannelBinaryClient network=beginRequest(OClusterProtocol.REQUEST_NODE2NODE_REPLICATION_RECORD_REQUEST);
      try {
        network.writeString(databaseEntry.databaseName);
        network.writeRID(rid);
      }
  finally {
        endRequest();
      }
      try {
        beginResponse();
        final byte recordType=network.readByte();
        if (recordType > -1) {
          final ORecordInternal<?> record=Orient.instance().getRecordFactoryManager().newInstance(recordType);
          record.fill(rid,network.readInt(),network.readBytes(),false);
          return record;
        }
 else         return null;
      }
  finally {
        endResponse();
      }
    }
 catch (    OException e) {
      throw e;
    }
catch (    Exception e) {
      throw new OIOException("REPL <" + databaseEntry.databaseName + "> error on reading record: "+ rid,e);
    }
  }
 while (true);
}
