{
  clearLock.readLock().lock();
  try {
    long index=-1;
    do {
      Long lastIndex=content.lastKey();
      if (lastIndex == null)       index=0;
 else       index=lastIndex + 1;
      final ODirectMemoryPointer directMemoryPointer=new ODirectMemoryPointer(pageSize);
      final OCachePointer cachePointer=new OCachePointer(directMemoryPointer,new OLogSequenceNumber(0,0));
      cachePointer.incrementReferrer();
      OCachePointer oldCachePointer=content.putIfAbsent(index,cachePointer);
      if (oldCachePointer != null) {
        cachePointer.decrementReferrer();
        index=-1;
      }
    }
 while (index < 0);
    return index;
  }
  finally {
    clearLock.readLock().unlock();
  }
}
