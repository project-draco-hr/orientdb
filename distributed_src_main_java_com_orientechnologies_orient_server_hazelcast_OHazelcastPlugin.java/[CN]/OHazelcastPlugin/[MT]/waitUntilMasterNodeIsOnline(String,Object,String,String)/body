{
  if (!masterNodeId.equals(localNodeId) && isOfflineNode(masterNodeId)) {
    ODistributedServerLog.warn(this,getLocalNodeId(),masterNodeId,DIRECTION.OUT,"node is offline (status=%s). Waiting for completition...",getRemoteNodeStatus(masterNodeId));
    while (isOfflineNode(masterNodeId)) {
      try {
        Thread.sleep(200);
      }
 catch (      InterruptedException e) {
        Thread.interrupted();
      }
      final String newMasterNodeId=getMasterNode(dbName,iClusterName,iKey);
      if (!newMasterNodeId.equals(masterNodeId)) {
        ODistributedServerLog.warn(this,getLocalNodeId(),masterNodeId,DIRECTION.OUT,"node %s is the new owner of the requested key set",getRemoteNodeStatus(masterNodeId));
        masterNodeId=newMasterNodeId;
      }
    }
    ODistributedServerLog.warn(this,getLocalNodeId(),masterNodeId,DIRECTION.OUT,"node %s is aligned. Flushing pending operations...");
  }
  return masterNodeId;
}
