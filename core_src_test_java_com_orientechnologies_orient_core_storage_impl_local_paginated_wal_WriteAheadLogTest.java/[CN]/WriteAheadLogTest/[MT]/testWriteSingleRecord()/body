{
  writeAheadLog.log(new OUpdatePageRecord(20,100));
  OWALRecord walRecord=writeAheadLog.read(writeAheadLog.begin());
  Assert.assertTrue(walRecord instanceof OUpdatePageRecord);
  OUpdatePageRecord setPageDataRecord=(OUpdatePageRecord)walRecord;
  Assert.assertEquals(setPageDataRecord.getPageIndex(),20);
  Assert.assertEquals(setPageDataRecord.getClusterId(),100);
  Assert.assertNull(writeAheadLog.next(walRecord.getLsn()));
  writeAheadLog.close();
  writeAheadLog=createWAL();
  walRecord=writeAheadLog.read(writeAheadLog.begin());
  Assert.assertEquals(walRecord.getLsn(),writeAheadLog.begin());
  Assert.assertTrue(walRecord instanceof OUpdatePageRecord);
  setPageDataRecord=(OUpdatePageRecord)walRecord;
  Assert.assertEquals(setPageDataRecord.getPageIndex(),20);
  Assert.assertEquals(setPageDataRecord.getClusterId(),100);
  Assert.assertNull(writeAheadLog.next(writeAheadLog.begin()));
}
