{
  for (  int port : networkPort)   try {
    channel=new OChannelBinaryClient(networkAddress,port,contextConfig);
    break;
  }
 catch (  Exception e) {
  }
  if (channel == null)   throw new ONetworkProtocolException("Can't connect to server host '" + networkAddress + "', ports: "+ Arrays.toString(networkPort));
  channel.writeByte((byte)OChannelBinaryProtocol.REQUEST_SHUTDOWN);
  channel.writeInt(0);
  channel.writeString(OServerConfiguration.SRV_ROOT_ADMIN);
  channel.writeString(rootPassword);
  channel.flush();
  if (channel.readByte() == OChannelBinaryProtocol.RESPONSE_STATUS_ERROR) {
    channel.readInt();
    channel.readString();
    throw new ONetworkProtocolException(channel.readString());
  }
}
