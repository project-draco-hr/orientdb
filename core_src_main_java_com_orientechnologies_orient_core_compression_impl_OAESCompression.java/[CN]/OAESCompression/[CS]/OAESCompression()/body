{
  initialized=false;
  final String configuredKey=OGlobalConfiguration.STORAGE_ENCRYPTION_AES_KEY.getValueAsString();
  if (configuredKey == null)   throw new OStorageException("AES compression has been selected, but no key was found. Please configure '" + OGlobalConfiguration.STORAGE_ENCRYPTION_AES_KEY.getKey() + "' setting or remove AES compression by setting '"+ OGlobalConfiguration.STORAGE_COMPRESSION_METHOD.getKey()+ "=nothing'");
  try {
    final byte[] key=OBase64Utils.decode(configuredKey);
    theKey=new SecretKeySpec(key,ALGORITHM_NAME);
    cipher=Cipher.getInstance(TRANSFORMATION);
  }
 catch (  Exception e) {
    throw new OSecurityException("Cannot initialize AES encryption with current key. Assure the key is a BASE64 - 128 oe 256 bits long",e);
  }
  this.initialized=true;
}
