{
  if (database.isClosed())   if (database.getStorage() instanceof ODirectMemoryStorage && !database.exists())   database.create();
 else {
    try {
      database.open(iUser,iPassword);
    }
 catch (    OSecurityException e) {
      try {
        connection.serverUser=server.serverLogin(iUser,iPassword,"database.passthrough");
      }
 catch (      OSecurityException ex) {
        throw e;
      }
      database.resetInitialization();
      database.setProperty(ODatabase.OPTIONS.SECURITY.toString(),Boolean.FALSE);
      database.open(iUser,iPassword);
    }
  }
  return database;
}
