{
  final OCluster cluster=getClusterById(clusterId);
  final String name=cluster.getName();
  if (OMetadataDefault.CLUSTER_INDEX_NAME.equals(name) || OMetadataDefault.CLUSTER_MANUAL_INDEX_NAME.equals(name)) {
    throw new IllegalArgumentException("It is impossible to freeze and release index or manual index cluster!");
  }
  cluster.getExternalModificationLock().prohibitModifications(throwException);
  try {
    cluster.synch();
    cluster.setSoftlyClosed(true);
  }
 catch (  IOException e) {
    throw new OStorageException("Error on synch cluster '" + name + "'",e);
  }
}
