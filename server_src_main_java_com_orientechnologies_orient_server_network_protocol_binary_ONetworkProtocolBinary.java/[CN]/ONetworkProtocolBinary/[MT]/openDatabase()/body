{
  setDataCommandInfo("Open database");
  readConnectionData();
  final String dbURL=channel.readString();
  user=channel.readString();
  passwd=channel.readString();
  connection.database=openDatabase(dbURL,user,passwd);
  connection.rawDatabase=((ODatabaseRaw)((ODatabaseComplex<?>)connection.database.getUnderlying()).getUnderlying());
  if (!(connection.database.getStorage() instanceof OStorageEmbedded) && !loadUserFromSchema(user,passwd)) {
    sendError(clientTxId,new OSecurityAccessException(connection.database.getName(),"User or password not valid for database: '" + connection.database.getName() + "'"));
  }
 else {
    beginResponse();
    try {
      sendOk(clientTxId);
      channel.writeInt(connection.id);
      sendDatabaseInformation();
      channel.writeBytes(null);
    }
  finally {
      endResponse();
    }
  }
}
