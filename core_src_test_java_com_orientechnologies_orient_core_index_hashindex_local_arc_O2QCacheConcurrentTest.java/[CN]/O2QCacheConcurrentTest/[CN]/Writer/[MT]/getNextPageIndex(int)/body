{
  long pageIndex;
  if (continuousWrite.get()) {
    pageIndex=pageCounters.getAndIncrement(fileNumber);
  }
 else {
    int queueSize=pagesQueue.get(fileNumber).size();
    if (queueSize == 0) {
      return -1;
    }
    int randomPageIndexFromQueue=new Random().nextInt(queueSize);
    pageIndex=pagesQueue.get(fileNumber).remove(randomPageIndexFromQueue);
  }
  return pageIndex;
}
