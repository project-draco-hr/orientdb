{
  try {
    ((ODatabaseRecordTx)underlying.getUnderlying()).commit();
    if (getTransaction().getAllRecordEntries() != null) {
      Object pojo=null;
      for (      ORecordOperation entry : getTransaction().getAllRecordEntries()) {
        pojo=records2Objects.get(entry.getRecord());
        if (pojo != null) switch (entry.type) {
case ORecordOperation.CREATED:
          rid2Records.put(entry.getRecord().getIdentity(),(ODocument)entry.getRecord());
        OObjectSerializerHelper.setObjectID(entry.getRecord().getIdentity(),pojo);
case ORecordOperation.UPDATED:
      OObjectSerializerHelper.setObjectVersion(entry.getRecord().getVersion(),pojo);
    break;
case ORecordOperation.DELETED:
  OObjectSerializerHelper.setObjectID(null,pojo);
OObjectSerializerHelper.setObjectVersion(null,pojo);
unregisterPojo(pojo,(ODocument)entry.getRecord());
break;
}
}
}
}
  finally {
getTransaction().close();
}
return this;
}
