{
  OrientGraphNoTx graph=new OrientGraphNoTx("memory:functionsTest");
  try {
    ODatabaseDocumentTx db=graph.getRawGraph();
    db.command(new OCommandSQL("create class Polygon extends v")).execute();
    db.command(new OCommandSQL("create property Polygon.geometry EMBEDDED OPolygon")).execute();
    db.command(new OCommandSQL("insert into Polygon set geometry = ST_Buffer(ST_GeomFromText('POINT(50 50)'), 20)")).execute();
    db.command(new OCommandSQL("insert into Polygon set geometry = ST_Buffer(ST_GeomFromText('POINT(50 50)'), 40)")).execute();
    db.command(new OCommandSQL("create index Polygon.g on Polygon (geometry) SPATIAL engine lucene")).execute();
    List<ODocument> execute=db.command(new OCommandSQL("SELECT from Polygon where ST_Within(geometry, ST_Buffer(ST_GeomFromText('POINT(50 50)'), 50)) = true")).execute();
    Assert.assertEquals(execute.size(),2);
    execute=db.command(new OCommandSQL("SELECT from Polygon where ST_Within(geometry, ST_Buffer(ST_GeomFromText('POINT(50 50)'), 30)) = true")).execute();
    Assert.assertEquals(execute.size(),1);
  }
  finally {
    graph.drop();
  }
}
