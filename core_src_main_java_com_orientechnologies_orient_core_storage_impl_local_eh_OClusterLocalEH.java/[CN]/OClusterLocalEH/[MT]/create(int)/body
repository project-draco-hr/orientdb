{
  acquireExclusiveLock();
  try {
    for (int i=0; i < filesMetadata.length; i++) {
      final OEHFileMetadata metadata=new OEHFileMetadata();
      final OStorageFileConfiguration fileConfiguration=new OStorageFileConfiguration(null,OStorageVariableParser.DB_PATH_VARIABLE + '/' + name+ i+ OEHFileMetadata.DEF_EXTENSION,OFileFactory.MMAP,"0","100%");
      final OSingleFileSegment bucketFile=new OSingleFileSegment(storage,fileConfiguration);
      bucketFile.create(bucketBufferSize * maxLevelSize);
      metadata.setFile(bucketFile);
      filesMetadata[i]=metadata;
    }
    initHashTreeState();
  }
  finally {
    releaseExclusiveLock();
  }
}
