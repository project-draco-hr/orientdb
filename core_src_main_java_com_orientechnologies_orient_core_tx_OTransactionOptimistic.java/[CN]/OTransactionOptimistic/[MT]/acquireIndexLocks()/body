{
  List<OIndexAbstract<?>> lockedIndexes=null;
  final List<String> involvedIndexes=getInvolvedIndexes();
  if (involvedIndexes != null)   Collections.sort(involvedIndexes);
  try {
    if (involvedIndexes != null)     for (    String indexName : involvedIndexes) {
      final OIndexAbstract<?> index=(OIndexAbstract<?>)database.getMetadata().getIndexManager().getIndexInternal(indexName);
      if (lockedIndexes == null)       lockedIndexes=new ArrayList<OIndexAbstract<?>>();
      index.acquireModificationLock();
      lockedIndexes.add(index);
    }
    return lockedIndexes;
  }
 catch (  RuntimeException e) {
    releaseIndexLocks(lockedIndexes);
    throw e;
  }
}
