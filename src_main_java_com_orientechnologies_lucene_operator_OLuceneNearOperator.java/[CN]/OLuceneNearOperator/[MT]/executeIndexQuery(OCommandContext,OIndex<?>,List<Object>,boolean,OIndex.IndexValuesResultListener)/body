{
  OIndexDefinition definition=index.getDefinition();
  int idxSize=definition.getFields().size();
  int paramsSize=keyParams.size();
  double distance=0;
  Object spatial=iContext.getVariable("spatial");
  if (spatial != null) {
    if (spatial instanceof Number) {
      distance=((Double)OType.convert(spatial,Double.class)).doubleValue();
    }
 else     if (spatial instanceof Map) {
      Map<String,Object> params=(Map<String,Object>)spatial;
      Object dst=params.get("distance");
      if (dst != null && dst instanceof Number) {
        distance=((Double)OType.convert(dst,Double.class)).doubleValue();
      }
    }
  }
  Object result=index.get(new OSpatialCompositeKey(keyParams).setMaxDistance(distance));
  convertIndexResult(result,resultListener);
  return true;
}
