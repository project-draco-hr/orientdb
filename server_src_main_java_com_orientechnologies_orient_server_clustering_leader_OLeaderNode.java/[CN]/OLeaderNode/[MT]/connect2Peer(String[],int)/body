{
  Throwable lastException=null;
  if (OLogManager.instance().isDebugEnabled())   logger.log(this,Level.FINE,TYPE.CLUSTER,DIRECTION.NONE,"trying to connecting to peer %s:%d",Arrays.toString(iServerAddresses),iServerPort);
  for (  String serverAddress : iServerAddresses) {
    final String key=ODistributedServerManager.getNodeName(serverAddress,iServerPort);
    final ORemotePeer node;
synchronized (this) {
      if (nodes.containsKey(key)) {
        node=nodes.get(key);
        logger.log(this,Level.FINE,TYPE.CLUSTER,DIRECTION.NONE,"peer %s already registered. Now has status: %s",key,node.getStatus());
        if (node.getStatus() != ORemotePeer.STATUS.UNREACHABLE && node.getStatus() != ORemotePeer.STATUS.DISCONNECTED && node.checkConnection())         return;
      }
 else       node=new ORemotePeer(this,serverAddress,iServerPort);
      try {
        if (node.connect(manager.getConfig().networkTimeoutNode,manager.getConfig().name,manager.getConfig().securityKey))         nodes.put(key,node);
        return;
      }
 catch (      Exception e) {
        lastException=e;
      }
    }
  }
  if (iServerAddresses.length > 1)   logger.error(this,TYPE.CLUSTER,DIRECTION.NONE,"cannot connect to distributed server node using addresses %s:%d and %s:%d",lastException,null,iServerAddresses[0],iServerPort,iServerAddresses[1],iServerPort);
 else   logger.error(this,TYPE.CLUSTER,DIRECTION.NONE,"cannot connect to distributed server node using addresses %s:%d",lastException,null,iServerAddresses[0],iServerPort);
}
