{
  getDatabase().checkSecurity(ODatabaseSecurityResources.COMMAND,ORole.PERMISSION_READ);
  init(((OCommandRequestText)iRequest).getText());
  parserRequiredKeyword(KEYWORD_FIND);
  parserRequiredKeyword(KEYWORD_REFERENCES);
  final String target=parserRequiredWord(true,"Expected <target>");
  if (target.charAt(0) == '(') {
    subQuery=new StringBuilder();
    parserSetCurrentPosition(OStringSerializerHelper.getEmbedded(text,parserGetPreviousPosition(),-1,subQuery));
  }
 else {
    try {
      final ORecordId rid=new ORecordId(target);
      if (!rid.isValid())       throwParsingException("Record ID " + target + " is not valid");
      recordIds.add(rid);
    }
 catch (    IllegalArgumentException iae) {
      throw new OCommandSQLParsingException("Error reading record Id",text,parserGetPreviousPosition(),iae);
    }
  }
  parserSkipWhiteSpaces();
  classList=parserOptionalWord(true);
  if (classList != null) {
    classList=textUpperCase.substring(parserGetPreviousPosition());
    if (!classList.startsWith("[") || !classList.endsWith("]")) {
      throwParsingException("Class list must be contained in []");
    }
    classList=classList.substring(1,classList.length() - 1);
  }
  return this;
}
