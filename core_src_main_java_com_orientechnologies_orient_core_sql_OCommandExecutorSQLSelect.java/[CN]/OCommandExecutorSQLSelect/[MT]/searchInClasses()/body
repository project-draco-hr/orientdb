{
  final int[] clusterIds;
  final OClass cls=compiledFilter.getTargetClasses().keySet().iterator().next();
  database.checkSecurity(ODatabaseSecurityResources.CLASS,ORole.PERMISSION_READ,cls.getName());
  clusterIds=cls.getPolymorphicClusterIds();
  for (  int clusterId : clusterIds)   database.checkSecurity(ODatabaseSecurityResources.CLUSTER,ORole.PERMISSION_READ,database.getClusterNameById(clusterId),clusterId);
  final List<ORecord<?>> resultSet=new ArrayList<ORecord<?>>();
  if (searchForIndexes(resultSet,cls)) {
    OProfiler.getInstance().updateCounter("Query.indexUsage",1);
    for (    ORecord<?> record : resultSet)     addResult(record);
  }
 else   scanEntireClusters(clusterIds);
}
