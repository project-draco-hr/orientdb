{
  final int id;
  if (iCluster != null) {
    if (clusterMap.containsKey(iCluster.getName()))     throw new OConfigurationException("Can't add segment '" + iCluster.getName() + "' because it was already registered in storage '"+ name+ "'");
    clusterMap.put(iCluster.getName(),iCluster);
    id=iCluster.getId();
  }
 else   id=clusters.length;
  clusters=OArrays.copyOf(clusters,clusters.length + 1);
  clusters[id]=iCluster;
  return id;
}
