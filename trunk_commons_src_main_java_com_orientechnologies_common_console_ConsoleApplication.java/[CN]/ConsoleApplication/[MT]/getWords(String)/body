{
  iRecord=iRecord.trim();
  char separator=wordSeparator.charAt(0);
  ArrayList<String> fields=new ArrayList<String>();
  StringBuilder buffer=new StringBuilder();
  char stringBeginChar=' ';
  char c;
  for (int i=0; i < iRecord.length(); ++i) {
    c=iRecord.charAt(i);
    if (c == '\'' || c == '"') {
      if (stringBeginChar != ' ') {
        if (stringBeginChar == c) {
          stringBeginChar=' ';
          fields.add(buffer.toString());
          buffer.setLength(0);
          continue;
        }
      }
 else {
        stringBeginChar=c;
        continue;
      }
    }
 else     if (c == separator && stringBeginChar == ' ') {
      fields.add(buffer.toString());
      buffer.setLength(0);
      continue;
    }
    buffer.append(c);
  }
  fields.add(buffer.toString());
  buffer.setLength(0);
  String[] result=new String[fields.size()];
  fields.toArray(result);
  return result;
}
