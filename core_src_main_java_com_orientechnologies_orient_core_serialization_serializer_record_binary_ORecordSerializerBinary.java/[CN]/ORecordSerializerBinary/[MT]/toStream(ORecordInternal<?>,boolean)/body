{
  checkTypeODocument(iSource);
  if (!checkRecursion((ODocument)iSource))   return null;
  BytesContainer container=new BytesContainer();
  int pos=container.alloc(1);
  container.bytes[pos]=LAST_RECORD_VERSION;
  serializerByVersion[LAST_RECORD_VERSION].serialize((ODocument)iSource,container);
  removeCheck((ODocument)iSource);
  return container.fitBytes();
}
