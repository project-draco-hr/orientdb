{
  if (rid == null && query == null)   throw new OCommandExecutionException("Cannot execute the command because it has not been parsed yet");
  if (!returning.equalsIgnoreCase("COUNT"))   allDeletedRecords=new ArrayList<ORecord>();
  if (rid != null) {
    OGraphCommandExecutorSQLFactory.runInTx(new OGraphCommandExecutorSQLFactory.GraphCallBack<Object>(){
      @Override public Object call(      OrientBaseGraph graph){
        final OrientVertex v=graph.getVertex(rid);
        if (v != null) {
          v.remove();
          removed=1;
        }
        return null;
      }
    }
);
  }
 else   if (query != null) {
    graph=OGraphCommandExecutorSQLFactory.getGraph(false,shutdownFlag);
    OGraphCommandExecutorSQLFactory.runInTx(graph,new OGraphCommandExecutorSQLFactory.GraphCallBack<Object>(){
      @Override public Object call(      OrientBaseGraph graph){
        return query.execute(iArgs);
      }
    }
);
  }
 else   throw new OCommandExecutionException("Invalid target");
  if (returning.equalsIgnoreCase("COUNT"))   return removed;
 else   return allDeletedRecords;
}
