{
  if (database == null) {
    for (int retry=0; retry < 100; ++retry) {
      try {
        database=distributed.getDatabaseInstance();
        break;
      }
 catch (      OConfigurationException e) {
        if (!waitForDatabaseIsOpen)         break;
        try {
          ODistributedServerLog.info(this,manager.getLocalNodeName(),null,DIRECTION.NONE,"Database not present, waiting for it (retry=%d/%d)...",retry,100);
          Thread.sleep(300);
        }
 catch (        InterruptedException e1) {
          Thread.currentThread().interrupt();
          return;
        }
      }
    }
    if (database == null)     throw new ODistributedException("Cannot open database '" + databaseName + "'");
  }
 else   if (database.isClosed()) {
    database.close();
    manager.getServerInstance().openDatabase(database,"internal","internal",null,true);
  }
}
