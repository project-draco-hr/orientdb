{
  ORemoteServerController remoteServer=remoteServers.get(nodeName);
  if (remoteServer == null) {
    final ODocument cfg=getNodeConfigurationById(nodeName);
    final Collection<Map<String,Object>> listeners=(Collection<Map<String,Object>>)cfg.field("listeners");
    if (listeners == null)     throw new ODatabaseException("Cannot connect to a remote node because bad distributed configuration: missing 'listeners' array field");
    String url=null;
    for (    Map<String,Object> listener : listeners) {
      if (((String)listener.get("protocol")).equals("ONetworkProtocolBinary")) {
        url=(String)listener.get("listen");
        break;
      }
    }
    if (url == null)     throw new ODatabaseException("Cannot connect to a remote node because the url was not found");
    remoteServer=new ORemoteServerController(url);
    remoteServers.put(nodeName,remoteServer);
  }
  return remoteServer;
}
