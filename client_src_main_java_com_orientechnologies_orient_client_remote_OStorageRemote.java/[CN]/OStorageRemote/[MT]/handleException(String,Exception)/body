{
  if (iException instanceof OTimeoutException)   throw (OTimeoutException)iException;
 else   if (iException instanceof OException)   throw (OException)iException;
 else   if (!(iException instanceof IOException))   throw new OStorageException(iMessage,iException);
  if (status != STATUS.OPEN)   return;
  final long lostConnectionTime=System.currentTimeMillis();
  final int currentMaxRetry;
  final int currentRetryDelay;
synchronized (clusterConfiguration) {
    if (!clusterConfiguration.isEmpty()) {
      currentMaxRetry=1;
      currentRetryDelay=0;
    }
 else {
      currentMaxRetry=connectionRetry;
      currentRetryDelay=connectionRetryDelay;
    }
  }
  for (int retry=0; retry < currentMaxRetry; ++retry) {
    if (currentRetryDelay > 0)     try {
      Thread.sleep(currentRetryDelay);
    }
 catch (    InterruptedException e) {
      Thread.currentThread().interrupt();
      break;
    }
    try {
      if (OLogManager.instance().isDebugEnabled())       OLogManager.instance().debug(this,"Retrying to connect to remote server #" + (retry + 1) + "/"+ currentMaxRetry+ "...");
      openRemoteDatabase();
      OLogManager.instance().warn(this,"Connection re-acquired transparently after %dms and %d retries: no errors will be thrown at application level",System.currentTimeMillis() - lostConnectionTime,retry + 1);
      return;
    }
 catch (    Throwable t) {
    }
  }
  throw new OStorageException(iMessage,iException);
}
