{
  final boolean safeMode=beginBlock();
  try {
    final ODocument sourceVertex=iEdge.field(EDGE_FIELD_IN);
    final ODocument destVertex=iEdge.field(EDGE_FIELD_OUT);
    final ORID edgeIdentity=iEdge.getIdentity();
    List<ODocument> outEdges=((List<ODocument>)sourceVertex.field(VERTEX_FIELD_OUT_EDGES));
    for (int i=0; i < outEdges.size(); ++i) {
      if (outEdges.get(i).getIdentity().equals(edgeIdentity)) {
        outEdges.remove(i);
        break;
      }
    }
    List<ODocument> inEdges=((List<ODocument>)destVertex.field(VERTEX_FIELD_IN_EDGES));
    for (int i=0; i < inEdges.size(); ++i) {
      if (inEdges.get(i).getIdentity().equals(edgeIdentity)) {
        inEdges.remove(i);
        break;
      }
    }
    iEdge.delete();
    sourceVertex.delete();
    destVertex.delete();
    commitBlock(safeMode);
  }
 catch (  RuntimeException e) {
    rollbackBlock(safeMode);
    throw e;
  }
}
