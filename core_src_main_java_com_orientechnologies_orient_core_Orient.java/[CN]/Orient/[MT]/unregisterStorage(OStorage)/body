{
  if (!active)   return;
  if (iStorage == null)   return;
  getLock().lock();
  try {
    final Iterable<OOrientListener> listenerCopy=getListenersCopy();
    for (Iterator<OOrientListener> it=listenerCopy.iterator(); it.hasNext(); ) {
      final OOrientListener l=it.next();
      unregisterListener(l);
      l.onStorageUnregistered(iStorage);
    }
    for (    Entry<String,OStorage> s : storages.entrySet()) {
      if (s.getValue() == iStorage) {
        storages.remove(s.getKey());
        break;
      }
    }
  }
  finally {
    getLock().unlock();
  }
}
