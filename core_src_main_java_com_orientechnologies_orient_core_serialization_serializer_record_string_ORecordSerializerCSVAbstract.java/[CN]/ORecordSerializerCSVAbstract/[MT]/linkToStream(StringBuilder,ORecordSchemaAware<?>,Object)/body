{
  if (iLinked == null)   return;
  ORID rid;
  buffer.append(OStringSerializerHelper.LINK);
  if (iLinked instanceof ORID) {
    rid=(ORID)iLinked;
  }
 else {
    ORecordInternal<?> iLinkedRecord=(ORecordInternal<?>)iLinked;
    rid=iLinkedRecord.getIdentity();
    if (!rid.isValid()) {
      iLinkedRecord.setDatabase(iParentRecord.getDatabase());
      iLinkedRecord.getDatabase().save((ORecordInternal)iLinkedRecord);
    }
    if (iLinkedRecord instanceof ORecordSchemaAware<?>) {
      final ORecordSchemaAware<?> schemaAwareRecord=(ORecordSchemaAware<?>)iLinkedRecord;
      if (schemaAwareRecord.getClassName() != null) {
        buffer.append(schemaAwareRecord.getClassName());
        buffer.append(OStringSerializerHelper.CLASS_SEPARATOR);
      }
    }
  }
  if (rid.isValid())   buffer.append(rid.toString());
}
