{
  ODatabaseRecordFlat db1=new ODatabaseRecordFlat(url);
  db1.open("admin","admin");
  ODatabaseRecordFlat db2=new ODatabaseRecordFlat(url);
  db2.open("admin","admin");
  ORecordFlat record1=new ORecordFlat(db1);
  record1.value("This is the first version").save();
  try {
    db1.begin();
    record1.load();
    ORecordFlat record2=db2.load(record1.getIdentity());
    record2.value("This is the second version").save();
    record1.value("This is the third version").save();
    db1.commit();
    Assert.assertTrue(false);
  }
 catch (  OConcurrentModificationException e) {
    Assert.assertTrue(true);
    db1.rollback();
  }
 finally {
    db1.close();
    db2.close();
  }
}
