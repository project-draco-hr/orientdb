{
  OrientGraphNoTx graph=new OrientGraphNoTx("memory:functionsTest");
  try {
    ODatabaseDocumentTx db=graph.getRawGraph();
    db.command(new OCommandSQL("create class Lines extends v")).execute();
    db.command(new OCommandSQL("create property Lines.geometry EMBEDDED OLINESTRING")).execute();
    db.command(new OCommandSQL("insert into Lines set geometry = ST_GeomFromText('LINESTRING ( 2 0, 0 2 )')")).execute();
    db.command(new OCommandSQL("insert into Lines set geometry = ST_GeomFromText('LINESTRING ( 0 0, 0 2 )')")).execute();
    db.command(new OCommandSQL("create index L.g on Lines (geometry) SPATIAL engine lucene")).execute();
    List<ODocument> execute=db.command(new OCommandSQL("SELECT from lines where ST_Intersects(geometry, 'POINT(0 0)') = true")).execute();
    Assert.assertEquals(execute.size(),1);
  }
  finally {
    graph.drop();
  }
}
