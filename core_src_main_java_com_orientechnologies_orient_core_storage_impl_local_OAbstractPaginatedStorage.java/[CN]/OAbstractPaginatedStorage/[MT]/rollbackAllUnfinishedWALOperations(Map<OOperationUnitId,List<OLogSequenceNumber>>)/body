{
  for (  List<OLogSequenceNumber> operationUnit : operationUnits.values()) {
    if (operationUnit.isEmpty())     continue;
    final OOperationUnitRecord atomicOperationRecord=(OOperationUnitRecord)writeAheadLog.read(operationUnit.get(0));
    if (atomicOperationRecord == null) {
      writeAheadLog.read(operationUnit.get(0));
    }
    final OAtomicUnitStartRecord startRecord;
    if (atomicOperationRecord instanceof OAtomicUnitStartRecord)     startRecord=(OAtomicUnitStartRecord)atomicOperationRecord;
 else {
      OLogManager.instance().info(this,"Rollback operation with id %s  and lsn %s",atomicOperationRecord.getOperationUnitId(),((OOperationUnitBodyRecord)atomicOperationRecord).getStartLsn());
      startRecord=(OAtomicUnitStartRecord)writeAheadLog.read(((OOperationUnitBodyRecord)atomicOperationRecord).getStartLsn());
    }
    if (!startRecord.isRollbackSupported())     continue;
    writeAheadLog.logAtomicOperationEndRecord(startRecord.getOperationUnitId(),true,startRecord.getLsn());
  }
}
