{
  final long timer=OProfiler.getInstance().startChrono();
  try {
    stream.jump(0);
    stream.set(CURRENT_PROTOCOL_VERSION);
    stream.setAsFixed(root != null ? root.toStream() : ORecordId.EMPTY_RECORD_ID_STREAM);
    stream.set(size);
    stream.set(pageSize);
    stream.set(keySize);
    stream.set(keySerializer.getName());
    stream.set(valueSerializer.getName());
    final byte[] result=stream.toByteArray();
    record.fromStream(result);
    return result;
  }
  finally {
    OProfiler.getInstance().stopChrono("OMVRBTreeMapProvider.toStream",timer);
  }
}
