{
  walActive=OGlobalConfiguration.USE_WAL.getValueAsBoolean();
  if (walActive)   OGlobalConfiguration.USE_WAL.setValue(false);
  if (averageEdgeNumberPerNode > 0) {
    OGlobalConfiguration.RID_BAG_EMBEDDED_DEFAULT_SIZE.setValue(averageEdgeNumberPerNode);
    OGlobalConfiguration.RID_BAG_EMBEDDED_TO_SBTREEBONSAI_THRESHOLD.setValue(bonsaiThreshold);
  }
  db=new ODatabaseDocumentTx(dbUrl);
  if (db.exists()) {
    db.open(userName,password);
  }
 else {
    db.create();
  }
  createBaseSchema();
  out=estimatedEntries > 0 ? new HashMap<Long,List<Long>>(estimatedEntries) : new HashMap<Long,List<Long>>();
  in=estimatedEntries > 0 ? new HashMap<Long,List<Long>>(estimatedEntries) : new HashMap<Long,List<Long>>();
}
