{
  storage.checkForClusterPermissions(getName());
  acquireExclusiveLock();
  try {
    BucketPath bucketPath=getBucket(zeroKey);
    while (bucketPath != null) {
      OEHBucket bucket=readBucket(bucketPath);
      for (      OPhysicalPosition position : bucket) {
        if (storage.checkForRecordValidity(position))         storage.getDataSegmentById(position.dataSegmentId).deleteRecord(position.dataSegmentPos);
      }
      bucketPath=nextBucketToFind(bucketPath,bucket.getDepth());
    }
    for (    OEHFileMetadata metadata : files) {
      metadata.getFile().shrink(0);
      metadata.setBucketsCount(0);
      metadata.setTombstonePosition(-1);
    }
    initHashTreeState();
  }
  finally {
    releaseExclusiveLock();
  }
}
