{
  checkStatus();
  final OrientGraph g=graphPool.getResource(iUserName + "," + iURL,Long.MAX_VALUE);
  if (!g.getRawGraph().getUser().checkPassword(iUserPassword)) {
    graphPool.returnResource(g);
    throw new OSecurityException("User and/or password not valid to open database: " + iURL);
  }
  return g;
}
