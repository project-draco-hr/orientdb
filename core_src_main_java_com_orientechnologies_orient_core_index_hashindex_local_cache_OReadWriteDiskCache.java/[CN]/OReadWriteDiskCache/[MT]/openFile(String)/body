{
  cacheLock.acquireWriteLock();
  try {
    long fileId=writeCache.isOpen(fileName);
    if (fileId >= 0)     return fileId;
    fileId=writeCache.openFile(fileName);
    filePages.put(fileId,Collections.newSetFromMap(new ConcurrentHashMap<Long,Boolean>()));
    return fileId;
  }
  finally {
    cacheLock.releaseWriteLock();
  }
}
