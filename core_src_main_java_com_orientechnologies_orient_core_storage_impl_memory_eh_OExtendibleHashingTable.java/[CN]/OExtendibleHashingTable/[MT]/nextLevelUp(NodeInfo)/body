{
  if (nodeInfo.parent == null)   return null;
  final int nodeLocalDepth=nodeLocalDepths[nodeInfo.nodeIndex];
  final int pointersSize=1 << (MAX_LEVEL_DEPTH - nodeLocalDepth);
  final NodeInfo parent=nodeInfo.parent;
  if (parent.itemIndex < MAX_LEVEL_SIZE / 2) {
    final int nextParentIndex=(parent.itemIndex / pointersSize + 1) * pointersSize;
    return new NodeInfo(parent.parent,0,nextParentIndex,parent.nodeIndex,parent.nodeGlobalDepth);
  }
  final int nextParentIndex=((nodeInfo.parent.itemIndex - MAX_LEVEL_SIZE / 2) / pointersSize + 1) * pointersSize;
  if (nextParentIndex < MAX_LEVEL_SIZE)   return new NodeInfo(parent.parent,0,nextParentIndex,parent.nodeIndex,parent.nodeGlobalDepth);
  return nextLevelUp(new NodeInfo(parent.parent,0,MAX_LEVEL_SIZE - 1,parent.nodeIndex,parent.nodeGlobalDepth));
}
