{
  final OIndex<?> previousIndex=indexChain.get(indexChain.size() - 2);
  Set<Comparable> currentKeys=prepareKeys(previousIndex,result);
  for (int j=indexChain.size() - 2; j > 0; j--) {
    Set<Comparable> newKeys=new TreeSet<Comparable>();
    final OIndex<?> currentIndex=indexChain.get(j);
    for (    Comparable currentKey : currentKeys) {
      final Object currentResult=currentIndex.get(currentKey);
      final Set<Comparable> preparedKeys;
      preparedKeys=prepareKeys(indexChain.get(j - 1),currentResult);
      newKeys.addAll(preparedKeys);
    }
    updateStatistic(currentIndex);
    currentKeys=newKeys;
  }
  return applyMainIndex(currentKeys,maxValuesToFetch);
}
