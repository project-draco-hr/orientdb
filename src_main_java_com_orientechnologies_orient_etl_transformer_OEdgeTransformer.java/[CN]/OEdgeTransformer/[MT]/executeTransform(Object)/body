{
  final OrientVertex vertex;
  if (input instanceof OrientVertex)   vertex=(OrientVertex)input;
 else   if (input instanceof OIdentifiable)   vertex=pipeline.getGraphDatabase().getVertex(input);
 else   throw new OTransformException(getName() + ": input type '" + input+ "' is not supported");
  final Object joinCurrentValue=joinValue != null ? joinValue : vertex.getProperty(joinFieldName);
  if (OMultiValue.isMultiValue(joinCurrentValue)) {
    for (    Object o : OMultiValue.getMultiValueIterable(joinCurrentValue)) {
      final Object r=lookup(o,false);
      if (createEdge(vertex,o,r) == null)       return null;
    }
  }
 else {
    final Object result=lookup(joinCurrentValue,false);
    if (createEdge(vertex,joinCurrentValue,result) == null)     return null;
  }
  return input;
}
