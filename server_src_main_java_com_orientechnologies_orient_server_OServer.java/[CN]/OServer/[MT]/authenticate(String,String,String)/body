{
  final OServerUserConfiguration user=getUser(iUserName);
  if (user != null && user.password != null) {
    final String passwordToMatch;
    if (user.password.startsWith(OSecurityManager.ALGORITHM_PREFIX))     passwordToMatch=OSecurityManager.instance().digest2String(iPassword,true);
 else     passwordToMatch=iPassword;
    if (user.password.equals(passwordToMatch)) {
      if (user.resources.equals("*"))       return true;
      String[] resourceParts=user.resources.split(",");
      for (      String r : resourceParts)       if (r.equals(iResourceToCheck))       return true;
    }
  }
  return false;
}
