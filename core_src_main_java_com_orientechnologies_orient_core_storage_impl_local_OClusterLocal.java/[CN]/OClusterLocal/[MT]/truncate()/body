{
  acquireExclusiveLock();
  try {
    final long begin=getFirstEntryPosition();
    final long end=getLastEntryPosition();
    final OPhysicalPosition ppos=new OPhysicalPosition();
    for (long i=begin; i <= end; ++i) {
      getPhysicalPosition(i,ppos);
      if (storage.checkForRecordValidity(ppos))       storage.getDataSegment(ppos.dataSegment).deleteRecord(ppos.dataPosition);
    }
    super.truncate();
    holeSegment.truncate();
  }
  finally {
    releaseExclusiveLock();
  }
}
