{
  if (obj == null)   return false;
  if (obj.getClass() != document.getClass())   return false;
  if (obj == document)   return true;
  final ODocument anotherDocument=(ODocument)obj;
  if (!document.getIdentity().equals(anotherDocument))   return false;
  final String[] filedNames=document.fieldNames();
  final String[] anotherFieldNames=anotherDocument.fieldNames();
  if (filedNames.length != anotherFieldNames.length)   return false;
  for (  final String fieldName : filedNames) {
    final Object fieldValue=document.field(fieldName);
    final Object anotherFieldValue=anotherDocument.field(fieldName);
    if (fieldValue == null && anotherFieldValue != null)     return false;
    if (fieldValue != null && !fieldValue.equals(anotherFieldValue))     return false;
  }
  return true;
}
