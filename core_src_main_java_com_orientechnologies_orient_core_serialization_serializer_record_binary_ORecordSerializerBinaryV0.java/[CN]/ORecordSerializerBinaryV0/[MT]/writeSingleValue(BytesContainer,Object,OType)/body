{
  int pointer=0;
switch (type) {
case INTEGER:
case LONG:
case SHORT:
    pointer=OVarIntSerializer.write(bytes,((Number)value).longValue());
  break;
case STRING:
pointer=writeString(bytes,(String)value);
break;
case DOUBLE:
long dg=Double.doubleToLongBits((Double)value);
pointer=bytes.alloc(OLongSerializer.LONG_SIZE);
OLongSerializer.INSTANCE.serialize(dg,bytes.bytes,pointer);
break;
case FLOAT:
int fg=Float.floatToIntBits((Float)value);
pointer=bytes.alloc(OIntegerSerializer.INT_SIZE);
OIntegerSerializer.INSTANCE.serialize(fg,bytes.bytes,pointer);
break;
case BYTE:
pointer=bytes.alloc(1);
bytes.bytes[pointer]=(Byte)value;
break;
case BOOLEAN:
pointer=bytes.alloc(1);
bytes.bytes[pointer]=((Boolean)value) ? (byte)1 : (byte)0;
break;
case DATETIME:
pointer=OVarIntSerializer.write(bytes,((Date)value).getTime());
break;
case DATE:
pointer=OVarIntSerializer.write(bytes,(((Date)value).getTime() + ONE_HOUR) / MILLISEC_PER_DAY);
break;
case EMBEDDED:
pointer=bytes.offset;
serialize((ODocument)value,bytes);
break;
case EMBEDDEDSET:
case EMBEDDEDLIST:
if (value.getClass().isArray()) pointer=writeEmbeddedCollection(bytes,Arrays.asList(OMultiValue.array(value)));
 else pointer=writeEmbeddedCollection(bytes,(Collection<?>)value);
break;
case DECIMAL:
BigDecimal decimalValue=(BigDecimal)value;
pointer=bytes.alloc(ODecimalSerializer.INSTANCE.getObjectSize(decimalValue));
ODecimalSerializer.INSTANCE.serialize(decimalValue,bytes.bytes,pointer);
break;
case BINARY:
byte[] valueBytes=(byte[])(value);
pointer=OVarIntSerializer.write(bytes,valueBytes.length);
int start=bytes.alloc(valueBytes.length);
System.arraycopy(valueBytes,0,bytes.bytes,start,valueBytes.length);
break;
case LINKSET:
case LINKLIST:
Collection<OIdentifiable> ridCollection=(Collection<OIdentifiable>)value;
pointer=writeLinkCollection(bytes,ridCollection);
break;
case LINK:
pointer=writeOptimizedLink(bytes,(OIdentifiable)value);
break;
case LINKMAP:
pointer=writeLinkMap(bytes,(Map<Object,OIdentifiable>)value);
break;
case EMBEDDEDMAP:
pointer=writeEmbeddedMap(bytes,(Map<Object,Object>)value);
break;
case LINKBAG:
pointer=((ORidBag)value).toStream(bytes);
case TRANSIENT:
break;
case CUSTOM:
break;
case ANY:
break;
}
return pointer;
}
