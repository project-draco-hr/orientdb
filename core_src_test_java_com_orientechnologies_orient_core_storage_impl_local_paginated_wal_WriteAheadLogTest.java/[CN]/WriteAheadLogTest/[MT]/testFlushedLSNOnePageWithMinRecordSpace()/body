{
  OWALRecord walRecord=new TestRecord(ONE_KB,false);
  writeAheadLog.log(walRecord);
  walRecord=new TestRecord(ONE_KB,false);
  writeAheadLog.log(walRecord);
  walRecord=new TestRecord(OWALPage.PAGE_SIZE - OWALPage.RECORDS_OFFSET - 2048- OWALPage.MIN_RECORD_SIZE,false);
  OLogSequenceNumber end=writeAheadLog.log(walRecord);
  Assert.assertNull(writeAheadLog.getFlushedLSN());
  writeAheadLog.flush();
  Assert.assertEquals(writeAheadLog.getFlushedLSN(),walRecord.getLsn());
  Assert.assertEquals(writeAheadLog.end(),end);
  writeAheadLog.close();
  writeAheadLog=createWAL();
  Assert.assertEquals(writeAheadLog.end(),end);
  Assert.assertEquals(writeAheadLog.getFlushedLSN(),walRecord.getLsn());
}
