{
  final String[] files=backupDirectory.list(new FilenameFilter(){
    @Override public boolean accept(    final File dir,    final String name){
      return new File(dir,name).length() > 0 && name.toLowerCase(configuration.getLocaleInstance()).endsWith(IBU_EXTENSION);
    }
  }
);
  if (files == null)   throw new OStorageException("Can not read list of backup files from directory " + backupDirectory.getAbsolutePath());
  final List<OPair<Long,String>> indexedFiles=new ArrayList<OPair<Long,String>>(files.length);
  for (  String file : files) {
    final long fileIndex=extractIndexFromIBUFile(backupDirectory,file);
    indexedFiles.add(new OPair<Long,String>(fileIndex,file));
  }
  Collections.sort(indexedFiles);
  final String[] sortedFiles=new String[files.length];
  int index=0;
  for (  OPair<Long,String> indexedFile : indexedFiles) {
    sortedFiles[index]=indexedFile.getValue();
    index++;
  }
  return sortedFiles;
}
