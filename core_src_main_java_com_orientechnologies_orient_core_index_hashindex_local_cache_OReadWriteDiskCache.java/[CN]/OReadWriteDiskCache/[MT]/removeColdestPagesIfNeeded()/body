{
  if (!coldPagesRemovalInProgress.compareAndSet(false,true))   return;
  final boolean exclusiveCacheLock=(am.size() + a1in.size() - maxSize) > MAX_CACHE_OVERFLOW;
  if (exclusiveCacheLock)   cacheLock.writeLock().lock();
 else   cacheLock.readLock().lock();
  try {
    if (exclusiveCacheLock)     removeColdPagesWithCacheLock();
 else     removeColdPagesWithoutCacheLock();
  }
  finally {
    if (exclusiveCacheLock)     cacheLock.writeLock().unlock();
 else     cacheLock.readLock().unlock();
    coldPagesRemovalInProgress.set(false);
  }
}
