{
  final Set<Comparable> keys=prepareKeys(indexChain.size() - 1,result,maxValuesToFetch);
  Set<Comparable> currentKeys=keys;
  for (int j=indexChain.size() - 2; j > 0; j--) {
    Set<Comparable> newKeys=new TreeSet<Comparable>();
    for (    Comparable currentKey : currentKeys) {
      final OIndex<?> currentIndex=indexChain.get(j);
      final Object currentResult=currentIndex.get(currentKey);
      final Set<Comparable> preparedKeys;
      preparedKeys=prepareKeys(j,currentResult,maxValuesToFetch);
      newKeys.addAll(preparedKeys);
      maxValuesToFetch-=preparedKeys.size();
    }
    currentKeys=newKeys;
  }
  return applyMainIndex(currentKeys,maxValuesToFetch);
}
