{
synchronized (syncObject) {
    close(flush);
    for (    LogSegment logSegment : logSegments)     if (!logSegment.delete(false))     OLogManager.instance().error(this,"Can not delete WAL segment %s for storage %s",logSegment.getPath(),storage.getName());
    if (!masterRecordFile.delete())     OLogManager.instance().error(this,"Can not delete WAL state file for %s storage",storage.getName());
  }
}
