{
  long total=0;
  jsonReader.readNext(OJSONReader.BEGIN_COLLECTION);
  long totalRecords=0;
  System.out.print("\nImporting records...");
  ORID rid;
  int lastClusterId=0;
  long clusterRecords=0;
  while (jsonReader.lastChar() != ']') {
    rid=importRecord();
    if (rid != null) {
      ++clusterRecords;
      if (rid.getClusterId() != lastClusterId || jsonReader.lastChar() == ']') {
        System.out.print("\n- Imported records into cluster '" + database.getClusterNameById(lastClusterId) + "' (id="+ lastClusterId+ "): "+ clusterRecords+ " records");
        clusterRecords=0;
        lastClusterId=rid.getClusterId();
      }
      ++totalRecords;
    }
 else     lastClusterId=0;
  }
  listener.onMessage("\n\nDone. Imported " + totalRecords + " records\n");
  jsonReader.readNext(OJSONReader.COMMA_SEPARATOR);
  return total;
}
