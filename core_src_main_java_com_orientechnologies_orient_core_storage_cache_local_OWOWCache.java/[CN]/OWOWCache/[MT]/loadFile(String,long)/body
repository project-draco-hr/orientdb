{
  filesLock.acquireWriteLock();
  try {
    initNameIdMapping();
    OFileClassic fileClassic;
    Integer existingFileId=nameIdMap.get(fileName);
    if (existingFileId != null && fileId >= 0) {
      if (existingFileId == extractFileId(fileId))       fileClassic=files.get(existingFileId);
 else       throw new OStorageException("File with given name already exists but has different id " + existingFileId + " vs. proposed "+ fileId);
    }
 else {
      throw new OStorageException("File with name " + fileName + " does not exist in storage "+ storageLocal.getName());
    }
    loadFile(fileClassic);
  }
  finally {
    filesLock.releaseWriteLock();
  }
}
