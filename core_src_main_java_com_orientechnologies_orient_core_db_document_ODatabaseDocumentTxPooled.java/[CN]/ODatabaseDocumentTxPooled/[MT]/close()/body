{
  if (isClosed())   return;
  checkOpeness();
  try {
    rollback();
  }
 catch (  Exception e) {
    OLogManager.instance().error(this,"Error on releasing database '%s' in pool",e,getName());
  }
  try {
    ((ODatabaseRaw)((ODatabaseRecord)underlying).getUnderlying()).callOnCloseListeners();
  }
 catch (  Exception e) {
    OLogManager.instance().error(this,"Error on releasing database '%s' in pool",e,getName());
  }
  getLevel1Cache().clear();
  final ODatabaseDocumentPool localCopy=ownerPool;
  ownerPool=null;
  localCopy.release(this);
}
