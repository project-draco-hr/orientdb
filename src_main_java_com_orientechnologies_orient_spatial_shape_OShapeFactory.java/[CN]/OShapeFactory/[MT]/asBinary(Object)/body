{
  if (obj instanceof ODocument) {
    Shape shape=fromDoc((ODocument)obj);
    return asBinary(shape);
  }
  if (obj instanceof Map) {
    Map map=(Map)((Map)obj).get("shape");
    if (map == null) {
      map=(Map)obj;
    }
    Shape shape=fromMapGeoJson(map);
    return asBinary(shape);
  }
  throw new IllegalArgumentException("Error serializing to binary " + obj);
}
