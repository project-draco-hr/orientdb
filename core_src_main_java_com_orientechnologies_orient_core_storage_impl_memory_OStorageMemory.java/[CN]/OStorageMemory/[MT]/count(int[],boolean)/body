{
  lock.acquireSharedLock();
  try {
    long tot=0;
    for (    int iClusterId : iClusterIds) {
      if (iClusterId > -1) {
        final OCluster cluster=clusters.get(iClusterId);
        if (cluster != null)         tot+=cluster.getEntries() - (countTombstones ? 0L : cluster.getTombstonesCount());
      }
    }
    return tot;
  }
  finally {
    lock.releaseSharedLock();
  }
}
