{
  final int[] clusterIds;
  String firstCluster=compiledFilter.getTargetClusters().keySet().iterator().next();
  if (firstCluster == null || firstCluster.length() == 0)   throw new OCommandExecutionException("No cluster or schema class selected in query");
  if (Character.isDigit(firstCluster.charAt(0)))   clusterIds=OStringSerializerHelper.splitIntArray(firstCluster);
 else   clusterIds=new int[]{database.getClusterIdByName(firstCluster.toLowerCase())};
  database.checkSecurity(ODatabaseSecurityResources.CLUSTER,ORole.PERMISSION_READ,firstCluster.toLowerCase(),clusterIds[0]);
  scanEntireClusters(clusterIds);
}
