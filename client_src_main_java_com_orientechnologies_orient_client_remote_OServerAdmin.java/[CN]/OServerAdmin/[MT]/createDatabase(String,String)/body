{
  storage.checkConnection();
  try {
    if (storage.getName() == null || storage.getName().length() <= 0) {
      OLogManager.instance().error(this,"Cannot create unnamed remote storage. Check your syntax",OStorageException.class);
    }
 else {
      if (iStorageMode == null)       iStorageMode="csv";
      final OChannelBinaryClient network=storage.beginRequest(OChannelBinaryProtocol.REQUEST_DB_CREATE);
      try {
        network.writeString(storage.getName());
        if (network.getSrvProtocolVersion() >= 8)         network.writeString(iDatabaseType);
        network.writeString(iStorageMode);
      }
  finally {
        storage.endRequest(network);
      }
      storage.getResponse(network);
    }
  }
 catch (  Exception e) {
    OLogManager.instance().error(this,"Cannot create the remote storage: " + storage.getName(),e,OStorageException.class);
    storage.close(true);
  }
  return this;
}
