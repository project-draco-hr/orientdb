{
  database.open("admin","admin");
  OGraphVertex lucaNode=database.createVertex().set("name","Luca").set("surname","Garulli").save();
  OGraphVertex carNode=database.createVertex("GraphCar").set("brand","Hyundai").set("model","Coupe").set("year",2003).save();
  OGraphVertex motoNode=database.createVertex("GraphMotocycle").set("brand","Yamaha").set("model","X-City 250").set("year",2009).save();
  lucaNode.link(carNode).setLabel("drives");
  lucaNode.link(carNode).setLabel("owns");
  lucaNode.link(motoNode).setLabel("owns");
  lucaNode.save();
  database.close();
  database.open("admin","admin");
  List<OGraphElement> result=database.query(new OSQLSynchQuery<OGraphElement>("select from V where name = 'Luca'"));
  Assert.assertEquals(result.size(),1);
  lucaNode=(OGraphVertex)result.get(0);
  Assert.assertNotNull(lucaNode.getOutEdges("drives"));
  Assert.assertFalse(lucaNode.getOutEdges("drives").isEmpty());
  Assert.assertEquals(lucaNode.getOutEdgeCount(),3);
  Assert.assertEquals(lucaNode.getInEdgeCount(),0);
  lucaNode.unlink(carNode);
  Assert.assertEquals(lucaNode.getOutEdgeCount(),1);
  Assert.assertEquals(lucaNode.getInEdgeCount(),0);
  database.close();
}
