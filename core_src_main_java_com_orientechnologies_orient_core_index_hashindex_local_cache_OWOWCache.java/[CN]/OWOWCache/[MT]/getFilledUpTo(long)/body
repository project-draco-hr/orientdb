{
  filesLock.acquireReadLock();
  try {
    return files.get(fileId).getFilledUpTo() / pageSize;
  }
  finally {
    filesLock.releaseReadLock();
  }
}
