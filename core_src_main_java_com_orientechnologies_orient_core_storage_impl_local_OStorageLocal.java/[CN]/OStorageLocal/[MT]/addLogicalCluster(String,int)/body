{
  lock.acquireExclusiveLock();
  try {
    final OClusterLogical cluster;
    if (iClusterName != null) {
      final OStorageLogicalClusterConfiguration config=new OStorageLogicalClusterConfiguration(iClusterName,clusters.length,iPhysicalCluster,null);
      configuration.setCluster(config);
      cluster=new OClusterLogical(this,clusters.length,iClusterName,iPhysicalCluster);
      config.map=cluster.getRID();
    }
 else     cluster=null;
    final int id=registerCluster(cluster);
    if (iClusterName != null)     configuration.update();
    return id;
  }
  finally {
    lock.releaseExclusiveLock();
  }
}
