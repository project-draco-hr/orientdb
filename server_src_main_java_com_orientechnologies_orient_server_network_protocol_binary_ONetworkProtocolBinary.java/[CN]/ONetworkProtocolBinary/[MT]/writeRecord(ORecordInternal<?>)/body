{
  if (iRecord == null) {
    channel.writeInt(OChannelBinaryProtocol.RECORD_NULL);
  }
 else {
    channel.writeInt((iRecord instanceof ORecordSchemaAware<?> && ((ORecordSchemaAware<?>)iRecord).getSchemaClass() != null ? ((ORecordSchemaAware<?>)iRecord).getSchemaClass().getId() : -1));
    channel.writeByte(iRecord.getRecordType());
    channel.writeShort((short)iRecord.getIdentity().getClusterId());
    channel.writeLong(iRecord.getIdentity().getClusterPosition());
    channel.writeInt(iRecord.getVersion());
    try {
      channel.writeBytes(iRecord.toStream());
    }
 catch (    Exception e) {
      channel.writeBytes(null);
      OLogManager.instance().error(this,"Error on unmarshalling record #" + iRecord.getIdentity().toString(),OSerializationException.class);
    }
  }
}
