{
  final ExecutorService service=Executors.newSingleThreadExecutor(new CloseTaskFactory());
  final List<OCloseable> resourcesToClose=new ArrayList<OCloseable>();
  for (  Object resource : sharedResources.values()) {
    if (resource instanceof OCloseable)     resourcesToClose.add(((OCloseable)resource));
  }
  sharedResources.clear();
  service.submit(new CloseTask(resourcesToClose));
}
