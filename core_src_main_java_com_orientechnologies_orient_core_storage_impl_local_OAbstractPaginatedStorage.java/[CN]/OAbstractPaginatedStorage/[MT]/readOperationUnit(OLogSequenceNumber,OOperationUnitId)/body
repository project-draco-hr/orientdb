{
  final OLogSequenceNumber beginSequence=writeAheadLog.begin();
  if (startLSN == null)   startLSN=beginSequence;
  if (startLSN.compareTo(beginSequence) < 0)   startLSN=beginSequence;
  List<OLogSequenceNumber> operationUnit=new ArrayList<OLogSequenceNumber>();
  OLogSequenceNumber lsn=startLSN;
  while (lsn != null) {
    OWALRecord record=writeAheadLog.read(lsn);
    if (!(record instanceof OOperationUnitRecord)) {
      lsn=writeAheadLog.next(lsn);
      continue;
    }
    OOperationUnitRecord operationUnitRecord=(OOperationUnitRecord)record;
    if (operationUnitRecord.getOperationUnitId().equals(unitId)) {
      operationUnit.add(lsn);
      if (record instanceof OAtomicUnitEndRecord)       break;
    }
    lsn=writeAheadLog.next(lsn);
  }
  return operationUnit;
}
