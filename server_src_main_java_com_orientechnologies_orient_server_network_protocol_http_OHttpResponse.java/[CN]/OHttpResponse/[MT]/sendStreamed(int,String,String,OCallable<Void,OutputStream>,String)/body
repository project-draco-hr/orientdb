{
  keepAlive=false;
  if (sendStarted) {
    return;
  }
  sendStarted=true;
  if (contentType == null || contentType.length() == 0) {
    contentType=iContentType;
  }
  writeStatus(iCode,iReason);
  writeHeaders(contentType,keepAlive);
  if (iHeaders != null) {
    writeLine(iHeaders);
  }
  if (sessionId != null)   writeLine("Set-Cookie: " + OHttpUtils.OSESSIONID + "="+ sessionId+ "; Path=/; HttpOnly");
  writeLine(null);
  if (contentEncoding != null && contentEncoding.equals(OHttpUtils.CONTENT_ACCEPT_GZIP_ENCODED)) {
    GZIPOutputStream gout=new GZIPOutputStream(out,16384);
    stream.call(gout);
    gout.finish();
  }
 else {
    stream.call(out);
  }
  flush();
}
