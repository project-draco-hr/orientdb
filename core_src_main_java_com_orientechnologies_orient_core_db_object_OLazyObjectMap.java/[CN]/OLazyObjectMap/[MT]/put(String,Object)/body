{
  if (e instanceof ODocument) {
    converted=false;
    underlying.put(iKey,e);
  }
 else {
    if (database.getRecordByUserObject(e,false) == null) {
      underlying.put(iKey,database.pojo2Stream((TYPE)e,new ODocument((ODatabaseRecord)database.getUnderlying())));
    }
 else {
      underlying.put(iKey,database.getRecordByUserObject(e,false));
    }
  }
  setDirty();
  return super.put(iKey,e);
}
