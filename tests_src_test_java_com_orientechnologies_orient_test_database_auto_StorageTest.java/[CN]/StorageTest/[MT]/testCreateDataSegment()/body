{
  if (url.startsWith("plocal:"))   return;
  database=new ODatabaseDocumentTx(url);
  if (!ODatabaseHelper.existsDatabase(database,"plocal"))   ODatabaseHelper.createDatabase(database,url,"plocal");
  database.open("admin","admin");
  File tempDir=new File(System.getProperty("java.io.tmpdir") + "/binary-Segment");
  tempDir.mkdirs();
  tempDir.deleteOnExit();
  final int segmentId=database.addDataSegment("binary",tempDir.toString());
  Assert.assertEquals(database.getStorage().getDataSegmentById(segmentId).getSize(),0);
  if (database.getStorage() instanceof OStorageLocal) {
    Assert.assertTrue(new File(tempDir.toString() + "/binary.0.oda").exists());
    Assert.assertTrue(new File(tempDir.toString() + "/binary.odh").exists());
  }
  database.setDataSegmentStrategy(new ODataSegmentStrategy(){
    @Override public int assignDataSegmentId(    ODatabase iDatabase,    ORecord<?> iRecord){
      return 1;
    }
  }
);
  ODocument record=database.newInstance().field("name","data-segment-test").save();
  Assert.assertNotNull(record);
  Assert.assertTrue(database.getStorage().getDataSegmentById(1).getSize() > 0);
  record.delete();
  database.dropDataSegment("binary");
  try {
    database.getDataSegmentIdByName("binary");
    Assert.assertTrue(false);
  }
 catch (  IllegalArgumentException e) {
    Assert.assertTrue(true);
  }
  final int newSegmentId=database.addDataSegment("binary",tempDir.toString());
  Assert.assertEquals(segmentId,newSegmentId);
  database.dropDataSegment("binary");
  try {
    database.getDataSegmentIdByName("binary");
    Assert.assertTrue(false);
  }
 catch (  IllegalArgumentException e) {
    Assert.assertTrue(true);
  }
}
