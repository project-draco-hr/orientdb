{
  final String[] params=iHash.split(":");
  if (params.length != 3)   throw new IllegalArgumentException("Hash does not contain the requested parts: <hash>:<salt>:<iterations>");
  final byte[] hash=hexToByteArray(params[0]);
  final byte[] salt=hexToByteArray(params[1]);
  final int iterations=Integer.parseInt(params[2]);
  if (iPassword.split(":").length == 1) {
    final byte[] testHash=getPbkdf2(iPassword,salt,iterations,hash.length);
    return compareHash(hash,testHash);
  }
  final String[] passwordParts=iPassword.split(":");
  final byte[] passwrodHash=hexToByteArray(passwordParts[0]);
  final byte[] passwordSalt=hexToByteArray(passwordParts[1]);
  final int passwordIterations=Integer.parseInt(passwordParts[2]);
  return compareHash(hash,passwrodHash);
}
