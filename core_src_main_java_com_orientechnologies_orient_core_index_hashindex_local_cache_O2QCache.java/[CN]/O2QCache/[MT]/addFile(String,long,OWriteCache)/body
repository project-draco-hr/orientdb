{
  cacheLock.acquireWriteLock();
  try {
    writeCache.addFile(fileName,fileId);
    filePages.put(fileId,Collections.newSetFromMap(new ConcurrentHashMap<Long,Boolean>()));
  }
  finally {
    cacheLock.releaseWriteLock();
  }
}
