{
synchronized (syncObject) {
    int order=lsn.getSegment();
    int index=order - logSegments.get(0).getOrder();
    if (index < 0 || index >= logSegments.size())     return null;
    LogSegment logSegment=logSegments.get(index);
    OLogSequenceNumber nextLSN=logSegment.getNextLSN(lsn);
    if (nextLSN == null) {
      index++;
      if (index >= logSegments.size())       return null;
      LogSegment nextSegment=logSegments.get(index);
      if (nextSegment.filledUpTo() == 0)       return null;
      nextLSN=nextSegment.begin();
    }
    return nextLSN;
  }
}
