{
  if (iRangeFrom.getClass() != iRangeTo.getClass())   throw new IllegalArgumentException("Range from-to parameters are of different types");
  checkForOptimization();
  acquireExclusiveLock();
  try {
    final Set<ODocument> result=new HashSet<ODocument>();
    final ONavigableMap<Object,Set<OIdentifiable>> subSet=map.subMap(iRangeFrom,iInclusive,iRangeTo,iInclusive);
    if (subSet != null) {
      for (      Entry<Object,Set<OIdentifiable>> v : subSet.entrySet()) {
        for (        OIdentifiable id : v.getValue()) {
          final ODocument document=new ODocument();
          document.field("key",v.getKey());
          document.field("rid",id.getIdentity());
          document.unsetDirty();
          result.add(document);
        }
      }
    }
    return result;
  }
  finally {
    releaseExclusiveLock();
  }
}
