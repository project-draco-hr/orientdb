{
  final String dbDirectory=serverInstance.getDatabaseDirectory();
  if (!iDatabase.getURL().substring(iDatabase.getURL().indexOf(":") + 1).startsWith(dbDirectory))   return;
synchronized (databaseJsonConfiguration) {
    final ODistributedConfiguration cfg=getDatabaseConfiguration(iDatabase.getName());
    if (cfg == null)     return;
    if (cfg.isReplicationActive(null)) {
      final OStorageSynchronizer dbSynchronizer=getDatabaseSynchronizer(iDatabase.getName());
      if (dbSynchronizer != null && iDatabase instanceof ODatabaseComplex<?> && !(iDatabase.getStorage() instanceof ODistributedStorage))       ((ODatabaseComplex<?>)iDatabase).replaceStorage(new ODistributedStorage(serverInstance,dbSynchronizer,(OStorageEmbedded)((ODatabaseComplex<?>)iDatabase).getStorage()));
    }
  }
}
