{
  if (rec == null)   return;
  if (rec.getIdentity().isValid())   rec.reload();
  if (recordExported > 0)   writer.append(",");
  writer.append(rec.toJSON("rid,type,version,class,attribSameRow,indent:4,keepTypes"));
  recordExported++;
  recordNum++;
  if (recordTot > 10 && (recordNum + 1) % (recordTot / 10) == 0)   listener.onMessage(".");
}
