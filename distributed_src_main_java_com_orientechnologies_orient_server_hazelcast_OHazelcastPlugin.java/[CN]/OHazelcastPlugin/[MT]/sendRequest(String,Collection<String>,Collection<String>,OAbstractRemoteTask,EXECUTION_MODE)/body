{
  checkForClusterRebalance(iDatabaseName);
  final OHazelcastDistributedRequest req=new OHazelcastDistributedRequest(nodeName,iDatabaseName,iTask,iExecutionMode);
  final ODatabaseDocument currentDatabase=ODatabaseRecordThreadLocal.INSTANCE.getIfDefined();
  if (currentDatabase != null && currentDatabase.getUser() != null)   req.setUserRID(currentDatabase.getUser().getIdentity().getIdentity());
  final OHazelcastDistributedDatabase db=messageService.getDatabase(iDatabaseName);
  if (iTargetNodes == null || iTargetNodes.isEmpty()) {
    ODistributedServerLog.error(this,nodeName,null,DIRECTION.OUT,"No nodes configured for partition '%s.%s' request: %s",iDatabaseName,iClusterNames,req);
    throw new ODistributedException("No nodes configured for partition '" + iDatabaseName + "."+ iClusterNames+ "' request: "+ req);
  }
  if (db == null) {
    ODistributedServerLog.error(this,nodeName,null,DIRECTION.OUT,"Distributed database '%s' not found",iDatabaseName);
    throw new ODistributedException("Distributed database '" + iDatabaseName + "' not found on server '"+ nodeName+ "'");
  }
  final ODistributedResponse response=db.send2Nodes(req,iClusterNames,iTargetNodes,iExecutionMode);
  if (response != null)   return response.getPayload();
  return null;
}
