{
  final OClientConnection connection;
  connection=new OClientConnection(connectionSerial.incrementAndGet(),iProtocol);
  connections.put(connection.id,connection);
  OHashToken key=new OHashToken(tokenBytes);
  OClientSessions sess;
synchronized (sessions) {
    sess=sessions.get(key);
    if (sess == null) {
      sess=new OClientSessions(tokenBytes,token);
      sessions.put(new OHashToken(tokenBytes),sess);
    }
  }
  connection.tokenBytes=tokenBytes;
  connection.tokenBased=true;
  connection.token=token;
  sess.addConnection(connection);
  return connection;
}
