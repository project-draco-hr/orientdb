{
  iDatabase.create();
  if (dbUser != null) {
    OUser oUser=iDatabase.getMetadata().getSecurity().getUser(dbUser);
    if (oUser == null) {
      iDatabase.getMetadata().getSecurity().createUser(dbUser,dbPasswd,new String[]{ORole.ADMIN});
    }
 else {
      oUser.setPassword(dbPasswd);
      oUser.save();
    }
  }
  OLogManager.instance().info(this,"Created database '%s' of type '%s'",iDatabase.getURL(),iDatabase.getStorage() instanceof OStorageLocal ? "local" : "memory");
  if (iDatabase.getStorage() instanceof OStorageLocal) {
    iDatabase.close();
  }
 else {
    OServerMain.server().getMemoryDatabases().put(iDatabase.getName(),iDatabase);
  }
  connection.rawDatabase=((ODatabaseRaw)((ODatabaseComplex<?>)iDatabase.getUnderlying()).getUnderlying());
}
