{
  if (rid.isNew())   throw new OStorageException("Passed record with id " + rid + " is new and can not be stored.");
  checkOpeness();
  final OCluster cluster=getClusterById(rid.getClusterId());
  lockManager.acquireLock(rid,OLockManager.LOCK.SHARED);
  try {
    lock.acquireSharedLock();
    try {
      checkOpeness();
      final OPhysicalPosition ppos=cluster.getPhysicalPosition(new OPhysicalPosition(rid.getClusterPosition()));
      if (ppos == null)       return null;
      return new ORecordMetadata(rid,ppos.recordVersion);
    }
  finally {
      lock.releaseSharedLock();
    }
  }
 catch (  IOException ioe) {
    OLogManager.instance().error(this,"Retrieval of record  '" + rid + "' cause: "+ ioe.getMessage(),ioe);
  }
 finally {
    lockManager.releaseLock(this,rid,OLockManager.LOCK.SHARED);
  }
  return null;
}
