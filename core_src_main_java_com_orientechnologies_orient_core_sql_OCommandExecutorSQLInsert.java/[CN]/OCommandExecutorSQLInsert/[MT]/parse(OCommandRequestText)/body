{
  iRequest.getDatabase().checkSecurity(ODatabaseSecurityResources.COMMAND,ORole.PERMISSION_CREATE);
  init(iRequest.getDatabase(),iRequest.getText());
  className=null;
  fields=null;
  StringBuilder word=new StringBuilder();
  int pos=OSQLHelper.nextWord(text,textUpperCase,0,word,true);
  if (pos == -1 || !word.toString().equals(OCommandExecutorSQLInsert.KEYWORD_INSERT))   throw new OCommandSQLParsingException("Keyword " + OCommandExecutorSQLInsert.KEYWORD_INSERT + " not found",text,0);
  pos=OSQLHelper.nextWord(text,textUpperCase,pos,word,true);
  if (pos == -1 || !word.toString().equals(KEYWORD_INTO))   throw new OCommandSQLParsingException("Keyword " + KEYWORD_INTO + " not found",text,0);
  pos=OSQLHelper.nextWord(text,textUpperCase,pos,word,true);
  if (pos == -1)   throw new OCommandSQLParsingException("Invalid subject name. Expected cluster, class or index",text,pos);
  String subjectName=word.toString();
  if (subjectName.startsWith(OCommandExecutorSQLAbstract.CLUSTER_PREFIX))   clusterName=subjectName.substring(OCommandExecutorSQLAbstract.CLUSTER_PREFIX.length());
 else   if (subjectName.startsWith(OCommandExecutorSQLAbstract.INDEX_PREFIX))   indexName=subjectName.substring(OCommandExecutorSQLAbstract.INDEX_PREFIX.length());
 else {
    if (subjectName.startsWith(OCommandExecutorSQLAbstract.CLASS_PREFIX))     subjectName=subjectName.substring(OCommandExecutorSQLAbstract.CLASS_PREFIX.length());
    final OClass cls=database.getMetadata().getSchema().getClass(subjectName);
    if (cls == null)     throw new OCommandSQLParsingException("Class " + subjectName + " not found in database",text,pos);
    className=cls.getName();
  }
  final int beginFields=OStringParser.jumpWhiteSpaces(text,pos);
  if (beginFields == -1 || text.charAt(beginFields) != '(')   throw new OCommandSQLParsingException("Set of fields is missed. Example: (name, surname)",text,pos);
  final int endFields=text.indexOf(')',beginFields + 1);
  if (endFields == -1)   throw new OCommandSQLParsingException("Missed closed brace",text,beginFields);
  final ArrayList<String> fieldNames=new ArrayList<String>();
  OStringSerializerHelper.getParameters(text,beginFields,fieldNames);
  if (fieldNames.size() == 0)   throw new OCommandSQLParsingException("Set of fields is empty. Example: (name, surname)",text,endFields);
  for (int i=0; i < fieldNames.size(); ++i)   fieldNames.set(i,OStringSerializerHelper.removeQuotationMarks(fieldNames.get(i)));
  pos=OSQLHelper.nextWord(text,textUpperCase,endFields + 1,word,true);
  if (pos == -1 || !word.toString().equals(KEYWORD_VALUES))   throw new OCommandSQLParsingException("Missed VALUES keyword",text,endFields);
  final int beginValues=OStringParser.jumpWhiteSpaces(text,pos + 1);
  if (pos == -1 || text.charAt(beginValues) != '(')   throw new OCommandSQLParsingException("Set of values is missed. Example: ('Bill', 'Stuart', 300)",text,pos);
  final int endValues=text.lastIndexOf(')');
  if (endValues == -1)   throw new OCommandSQLParsingException("Missed closed brace",text,beginValues);
  final List<String> values=OStringSerializerHelper.smartSplit(text,new char[]{','},beginValues + 1,endValues,true);
  if (values.size() == 0)   throw new OCommandSQLParsingException("Set of values is empty. Example: ('Bill', 'Stuart', 300)",text,beginValues);
  if (values.size() != fieldNames.size())   throw new OCommandSQLParsingException("Fields not match with values",text,beginValues);
  final Object[] fieldValues=new Object[values.size()];
  for (int i=0; i < values.size(); ++i)   fieldValues[i]=OSQLHelper.parseValue(database,this,OStringSerializerHelper.decode(values.get(i).trim()));
  fields=new LinkedHashMap<String,Object>();
  for (int i=0; i < fieldNames.size(); ++i)   fields.put(fieldNames.get(i),fieldValues[i]);
  return this;
}
