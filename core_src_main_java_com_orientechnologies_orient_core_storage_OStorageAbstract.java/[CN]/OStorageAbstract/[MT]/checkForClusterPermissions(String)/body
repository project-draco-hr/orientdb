{
  final Set<OClass> classes=ODatabaseRecordThreadLocal.INSTANCE.get().getMetadata().getSchema().getClassesRelyOnCluster(iClusterName);
  for (  OClass c : classes) {
    if (c.isSubClassOf(OSecurityShared.RESTRICTED_CLASSNAME))     throw new OSecurityException("Class " + c.getName() + " cannot be truncated because has record level security enabled (extends "+ OSecurityShared.RESTRICTED_CLASSNAME+ ")");
  }
}
