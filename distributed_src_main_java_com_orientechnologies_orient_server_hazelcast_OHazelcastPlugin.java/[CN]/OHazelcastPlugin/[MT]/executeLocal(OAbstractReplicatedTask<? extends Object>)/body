{
  while (true) synchronized (executionQueue) {
    final Long last=executionQueue.get(iTask.getRunId());
    if (last != null && last < iTask.getOperationSerial() - 1) {
      try {
        ODistributedServerLog.debug(this,getLocalNodeId(),iTask.getNodeSource(),DIRECTION.NONE,"waiting for %d tasks in queue %s. current=%d my=%d",(iTask.getOperationSerial() - last - 1),iTask.getRunId(),last,iTask.getOperationSerial());
        executionQueue.wait(1000);
      }
 catch (      InterruptedException e) {
      }
    }
 else     break;
  }
  ODistributedThreadLocal.INSTANCE.set(iTask.getNodeSource());
  try {
    return iTask.executeOnLocalNode();
  }
  finally {
synchronized (executionQueue) {
      executionQueue.put(iTask.getRunId(),iTask.getOperationSerial());
      executionQueue.notifyAll();
    }
    ODistributedThreadLocal.INSTANCE.set(null);
  }
}
