{
  final LinkedList<Long> result=new LinkedList<Long>();
  final Set<ORID> rids=new HashSet<ORID>();
  lock.acquireExclusiveLock();
  try {
    long fileOffset=file.getFilledUpTo();
    long[] localOperationId=getOperationId(fileOffset);
    while ((localOperationId[0] > iRemoteLastOperationId[0]) || (localOperationId[0] == iRemoteLastOperationId[0] && localOperationId[1] > iRemoteLastOperationId[1])) {
      final ORID rid=getOperationRID(fileOffset);
      if ((rid == null || !rids.contains(rid)) && (iStatus == null || iStatus == getOperationStatus(fileOffset))) {
        result.add(fileOffset);
        rids.add(rid);
        if (iMax > -1 && result.size() >= iMax)         break;
      }
      final long prevOffset=getPreviousOperation(fileOffset);
      localOperationId=getOperationId(prevOffset);
      fileOffset=prevOffset;
    }
    return result.descendingIterator();
  }
  finally {
    lock.releaseExclusiveLock();
  }
}
