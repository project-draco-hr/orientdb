{
  final ORecordInternal<?> replicaToAdd;
  if (rid == null)   replicaToAdd=new ODocument();
 else   replicaToAdd=load(rid,"*:0",false,true);
  ((ODocument)replicaToAdd).merge((ODocument)record,false,false);
  replicaToAdd.getRecordVersion().copyFrom(record.getRecordVersion());
  replicaToAdd.setIdentity(this.rid);
  return replicaToAdd;
}
