{
  database.open("admin","admin");
  OSQLEngine.getInstance().registerFunction("max",new OSQLFunctionAbstract("max",2,2){
    public String getSyntax(){
      return "max(<first>, <second>)";
    }
    public Object execute(    ORecordInternal<?> iRecord,    Object[] iParameters){
      if (iParameters[0] == null || iParameters[1] == null)       return null;
      if (!(iParameters[0] instanceof Number) || !(iParameters[1] instanceof Number))       return null;
      final double v1=((Number)iParameters[0]).doubleValue();
      final double v2=((Number)iParameters[1]).doubleValue();
      return Math.max(v1,v2);
    }
  }
);
  List<ODocument> result=database.command(new OSQLSynchQuery<ODocument>("select from Account where max(nr,1000) > 0")).execute();
  Assert.assertTrue(result.size() != 0);
  OSQLEngine.getInstance().unregisterFunction("max");
  database.close();
}
