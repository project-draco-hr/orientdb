{
  database.open("admin","admin");
  final Long total=database.countClass("Profile");
  final List<ODocument> resultset=database.query(new OSQLSynchQuery<Object>("select from Profile set sex = 'male' where salary > 100"));
  final Number records=(Number)database.command(new OCommandSQL("delete from Profile set sex = 'male' where salary > 100")).execute();
  Assert.assertEquals(records.intValue(),resultset.size());
  Assert.assertEquals(database.countClass("Profile"),total - records.intValue());
  database.close();
}
