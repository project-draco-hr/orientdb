{
  final OLocalPaginatedCluster cluster;
  if (clusterName != null) {
    clusterName=clusterName.toLowerCase();
    cluster=new OLocalPaginatedCluster();
    cluster.configure(this,clusterPos,clusterName,location,-1,parameters);
  }
 else {
    cluster=null;
  }
  final int createdClusterId=registerCluster(cluster);
  if (cluster != null) {
    if (!cluster.exists()) {
      cluster.create(-1);
      if (OGlobalConfiguration.STORAGE_MAKE_FULL_CHECKPOINT_AFTER_CLUSTER_CREATE.getValueAsBoolean() && fullCheckPoint)       makeFullCheckpoint();
    }
 else {
      cluster.open();
    }
    configuration.update();
  }
  return createdClusterId;
}
