{
  listener.onMessage("\nExporting clusters...");
  writer.beginObject(1,true,"clusters");
  Collection<String> clusterNames=database.getClusterNames();
  for (  String clusterName : clusterNames) {
    long recordTot=database.countClusterElements(clusterName);
    listener.onMessage("\n- Exporting cluster '" + clusterName + "' (records="+ recordTot+ ") -> ");
    writer.beginObject(2,true,"cluster");
    writer.writeAttribute(3,true,"name",clusterName);
    writer.writeAttribute(0,false,"id",database.getClusterIdByName(clusterName));
    if (recordTot > 0) {
      writer.beginCollection(3,true,"records");
      long recordNum=0;
      for (      ORecord<?> rec : database.browseCluster(clusterName))       exportRecord(recordTot,recordNum,rec);
      writer.endCollection(3,true);
    }
    listener.onMessage("OK");
    writer.endObject(2,true);
  }
  writer.endObject(1,true);
}
