{
  ODistributedServerLog.info(this,getDistributedServerManager().getLocalNodeName(),getNodeSource(),DIRECTION.OUT,"flushing aligning %d operations db=%s...",tasks.getTasks(),databaseName);
  final Future<Object> future=dManager.sendTask2Node(getNodeSource(),tasks,EXECUTION_MODE.SYNCHRONOUS,new HashMap<String,Object>());
  if (future != null) {
    try {
      future.get(getTimeout(),TimeUnit.MILLISECONDS);
    }
 catch (    TimeoutException e) {
      ODistributedServerLog.error(this,getDistributedServerManager().getLocalNodeName(),getNodeSource(),DIRECTION.OUT,"timeout on flushing alignment operations db=%s...",databaseName);
      future.cancel(true);
    }
  }
  final int aligned=tasks.getTasks();
  ODistributedServerLog.info(this,getDistributedServerManager().getLocalNodeName(),getNodeSource(),DIRECTION.OUT," flushed aligning %d operations db=%s...",aligned,databaseName);
  tasks.clearTasks();
  positions.clear();
  return aligned;
}
