{
  OSessionStoragePerformanceStatistic sessionStoragePerformanceStatistic=new OSessionStoragePerformanceStatistic(1024,new OSessionStoragePerformanceStatistic.NanoTimer(){
    private long counter=0;
    @Override public long getNano(){
      return counter+=100;
    }
  }
);
  Assert.assertEquals(sessionStoragePerformanceStatistic.getAmountOfPagesWrittenInCache(),0);
  Assert.assertEquals(sessionStoragePerformanceStatistic.getWriteSpeedInCacheInPages(),-1);
  Assert.assertEquals(sessionStoragePerformanceStatistic.getWriteSpeedInCacheInMB(),-1);
  sessionStoragePerformanceStatistic.startCommitTimer();
  for (int i=0; i < 100; i++) {
    sessionStoragePerformanceStatistic.startPageWriteInCacheTimer();
    sessionStoragePerformanceStatistic.stopPageWriteInCacheTimer();
  }
  sessionStoragePerformanceStatistic.stopCommitTimer();
  Assert.assertEquals(sessionStoragePerformanceStatistic.getAmountOfPagesWrittenInCache(),100);
  Assert.assertEquals(sessionStoragePerformanceStatistic.getWriteSpeedInCacheInPages(),10000000);
  Assert.assertEquals(sessionStoragePerformanceStatistic.getWriteSpeedInCacheInMB(),10000000 / 1024);
  ODocument doc=sessionStoragePerformanceStatistic.toDocument();
  Assert.assertEquals(doc.field("amountOfPagesWrittenInCache"),100L);
  Assert.assertEquals(doc.field("writeSpeedInCacheInPages"),10000000L);
  Assert.assertEquals(doc.field("writeSpeedInCacheInMB"),10000000 / 1024L);
}
