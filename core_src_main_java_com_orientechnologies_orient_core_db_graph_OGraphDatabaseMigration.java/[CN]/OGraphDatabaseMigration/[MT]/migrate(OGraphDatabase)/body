{
  System.out.println("Migration of database started...");
  final long start=System.currentTimeMillis();
  try {
    long convertedVertices=0;
    for (    ODocument doc : db.browseVertices()) {
      boolean converted=false;
      if (doc.containsField(OGraphDatabase.VERTEX_FIELD_IN_OLD)) {
        doc.field(OGraphDatabase.VERTEX_FIELD_IN,doc.field(OGraphDatabase.VERTEX_FIELD_IN_OLD));
        doc.removeField(OGraphDatabase.VERTEX_FIELD_IN_OLD);
        converted=true;
      }
      if (doc.containsField(OGraphDatabase.VERTEX_FIELD_OUT_OLD)) {
        doc.field(OGraphDatabase.VERTEX_FIELD_OUT,doc.field(OGraphDatabase.VERTEX_FIELD_OUT_OLD));
        doc.removeField(OGraphDatabase.VERTEX_FIELD_OUT_OLD);
        converted=true;
      }
      if (converted) {
        doc.save();
        convertedVertices++;
      }
    }
    System.out.println(String.format("Migration complete in %d seconds. Vertices converted: %d",(System.currentTimeMillis() - start) / 1000,convertedVertices));
  }
  finally {
    db.close();
  }
}
