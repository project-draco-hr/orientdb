{
  if (fields.length == 0) {
    throw new OIndexException("List of fields to index cannot be empty.");
  }
  final Set<String> existingFieldNames=properties.keySet();
  for (  final String fieldToIndex : fields) {
    final String fieldName=OIndexDefinitionFactory.extractFieldName(fieldToIndex);
    if (!existingFieldNames.contains(fieldName.toLowerCase()))     throw new OIndexException("Index with name : '" + iName + "' cannot be created on class : '"+ name+ "' because field: '"+ fieldName+ "' is absent in class definition.");
  }
  final OIndexDefinition indexDefinition=OIndexDefinitionFactory.createIndexDefinition(this,Arrays.asList(fields),extractFieldTypes(fields));
  return getDatabase().getMetadata().getIndexManager().createIndex(iName,iType,indexDefinition,polymorphicClusterIds,iProgressListener);
}
