{
  final long timer=OProfiler.getInstance().startChrono();
  lock.acquireSharedLock();
  try {
    final ODataSegmentMemory data=(ODataSegmentMemory)getDataSegmentById(iDataSegmentId);
    final long offset=data.createRecord(iContent);
    final OCluster cluster=getClusterById(iRid.clusterId);
    final OPhysicalPosition ppos=new OPhysicalPosition(iDataSegmentId,offset,iRecordType);
    cluster.addPhysicalPosition(ppos);
    iRid.clusterPosition=ppos.clusterPosition;
    if (iCallback != null)     iCallback.call(iRid,iRid.clusterPosition);
    return ppos;
  }
 catch (  IOException e) {
    throw new OStorageException("Error on create record in cluster: " + iRid.clusterId,e);
  }
 finally {
    lock.releaseSharedLock();
    OProfiler.getInstance().stopChrono("OStorageMemory.createRecord",timer);
  }
}
