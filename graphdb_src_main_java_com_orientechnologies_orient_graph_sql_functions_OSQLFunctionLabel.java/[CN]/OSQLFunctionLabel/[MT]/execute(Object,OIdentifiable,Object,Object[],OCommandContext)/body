{
  final OModifiableBoolean shutdownFlag=new OModifiableBoolean();
  ODatabaseDocumentInternal curDb=ODatabaseRecordThreadLocal.INSTANCE.get();
  final OrientBaseGraph graph=OGraphCommandExecutorSQLFactory.getGraph(false,shutdownFlag);
  try {
    if (iCurrentResult != null) {
      return OSQLEngine.foreachRecord(new OCallable<Object,OIdentifiable>(){
        @Override public Object call(        final OIdentifiable iArgument){
          return getLabel(graph,iArgument);
        }
      }
,iCurrentResult,iContext);
    }
 else     return getLabel(graph,iCurrentRecord);
  }
  finally {
    if (shutdownFlag.getValue())     graph.shutdown(false);
    ODatabaseRecordThreadLocal.INSTANCE.set(curDb);
  }
}
