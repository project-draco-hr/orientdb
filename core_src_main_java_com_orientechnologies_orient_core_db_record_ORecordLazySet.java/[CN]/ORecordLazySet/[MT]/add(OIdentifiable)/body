{
  if (e.getIdentity().isNew()) {
    if (!(e instanceof ORecord<?>))     throw new IllegalArgumentException("Can't add invalid RID");
    final ORecord<?> record=(ORecord<?>)e;
    if (newItems == null)     newItems=new IdentityHashMap<ORecord<?>,Object>();
    newItems.put(record,NEWMAP_VALUE);
    setDirty();
    return true;
  }
 else   if (OGlobalConfiguration.LAZYSET_WORK_ON_STREAM.getValueAsBoolean() && getStreamedContent() != null) {
    final StringBuilder buffer=getStreamedContent();
    if (buffer.length() > 0)     buffer.append(',');
    e.getIdentity().toString(buffer);
    setDirty();
    return true;
  }
 else {
    final int pos=indexOf(e);
    if (pos < 0) {
      delegate.add(pos * -1 - 1,e);
      return true;
    }
    return false;
  }
}
