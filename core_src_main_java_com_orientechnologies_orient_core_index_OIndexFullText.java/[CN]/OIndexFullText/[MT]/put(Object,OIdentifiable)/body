{
  checkForRebuild();
  if (key == null)   return this;
  key=getCollatingValue(key);
  modificationLock.requestModificationLock();
  try {
    final List<String> words=splitIntoWords(key.toString());
    for (    final String word : words) {
      acquireExclusiveLock();
      try {
        Set<OIdentifiable> refs;
        refs=indexEngine.get(word);
        if (refs == null) {
          if (ODefaultIndexFactory.SBTREEBONSAI_VALUE_CONTAINER.equals(valueContainerAlgorithm)) {
            refs=new OIndexRIDContainer(getName());
          }
 else {
            refs=new OMVRBTreeRIDSet();
            ((OMVRBTreeRIDSet)refs).setAutoConvertToRecord(false);
          }
        }
        refs.add(iSingleValue);
        indexEngine.put(word,refs);
      }
  finally {
        releaseExclusiveLock();
      }
    }
    return this;
  }
  finally {
    modificationLock.releaseModificationLock();
  }
}
