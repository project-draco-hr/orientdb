{
  lock.acquireSharedLock();
  try {
    long size=0;
    for (    OCluster c : clusters)     if (c != null)     size+=c.getRecordsSize();
    return size;
  }
 catch (  IOException ioe) {
    throw new OStorageException("Can not calculate records size");
  }
 finally {
    lock.releaseSharedLock();
  }
}
