{
  database=ODatabaseDocumentPool.global().acquire(url,"admin","admin");
  ODocument doc=database.newInstance();
  doc.field("test","test");
  doc.save();
  ORID docRid=doc.getIdentity().copy();
  try {
    doc=database.load(docRid,"*:-1");
    doc=testInvalidFetchPlanInvalidateL1Cache(doc,docRid);
    doc=testInvalidFetchPlanInvalidateL1Cache(doc,new ORecordId(1,OClusterPositionFactory.INSTANCE.valueOf(0)));
    doc=testInvalidFetchPlanInvalidateL1Cache(doc,new ORecordId(1,OClusterPositionFactory.INSTANCE.valueOf(1)));
    doc=testInvalidFetchPlanInvalidateL1Cache(doc,new ORecordId(1,OClusterPositionFactory.INSTANCE.valueOf(2)));
    doc=testInvalidFetchPlanInvalidateL1Cache(doc,new ORecordId(2,OClusterPositionFactory.INSTANCE.valueOf(0)));
    doc=testInvalidFetchPlanInvalidateL1Cache(doc,new ORecordId(2,OClusterPositionFactory.INSTANCE.valueOf(1)));
    doc=testInvalidFetchPlanInvalidateL1Cache(doc,new ORecordId(2,OClusterPositionFactory.INSTANCE.valueOf(2)));
    doc=testInvalidFetchPlanInvalidateL1Cache(doc,new ORecordId(3,OClusterPositionFactory.INSTANCE.valueOf(0)));
    doc=testInvalidFetchPlanInvalidateL1Cache(doc,new ORecordId(3,OClusterPositionFactory.INSTANCE.valueOf(1)));
    doc=testInvalidFetchPlanInvalidateL1Cache(doc,new ORecordId(3,OClusterPositionFactory.INSTANCE.valueOf(2)));
    doc=testInvalidFetchPlanInvalidateL1Cache(doc,new ORecordId(4,OClusterPositionFactory.INSTANCE.valueOf(0)));
    doc=testInvalidFetchPlanInvalidateL1Cache(doc,new ORecordId(4,OClusterPositionFactory.INSTANCE.valueOf(1)));
  }
  finally {
    database.close();
  }
  database=null;
  database=ODatabaseDocumentPool.global().acquire(url,"admin","admin");
  try {
    doc=testInvalidFetchPlanClearL1Cache(doc,docRid);
    doc=testInvalidFetchPlanClearL1Cache(doc,new ORecordId(1,OClusterPositionFactory.INSTANCE.valueOf(0)));
    doc=testInvalidFetchPlanClearL1Cache(doc,new ORecordId(1,OClusterPositionFactory.INSTANCE.valueOf(1)));
    doc=testInvalidFetchPlanClearL1Cache(doc,new ORecordId(1,OClusterPositionFactory.INSTANCE.valueOf(2)));
    doc=testInvalidFetchPlanClearL1Cache(doc,new ORecordId(2,OClusterPositionFactory.INSTANCE.valueOf(0)));
    doc=testInvalidFetchPlanClearL1Cache(doc,new ORecordId(2,OClusterPositionFactory.INSTANCE.valueOf(1)));
    doc=testInvalidFetchPlanClearL1Cache(doc,new ORecordId(2,OClusterPositionFactory.INSTANCE.valueOf(2)));
    doc=testInvalidFetchPlanClearL1Cache(doc,new ORecordId(3,OClusterPositionFactory.INSTANCE.valueOf(0)));
    doc=testInvalidFetchPlanClearL1Cache(doc,new ORecordId(3,OClusterPositionFactory.INSTANCE.valueOf(1)));
    doc=testInvalidFetchPlanClearL1Cache(doc,new ORecordId(3,OClusterPositionFactory.INSTANCE.valueOf(2)));
    doc=testInvalidFetchPlanClearL1Cache(doc,new ORecordId(4,OClusterPositionFactory.INSTANCE.valueOf(0)));
    doc=testInvalidFetchPlanClearL1Cache(doc,new ORecordId(4,OClusterPositionFactory.INSTANCE.valueOf(1)));
    doc=database.load(docRid);
    doc.delete();
  }
  finally {
    database.close();
  }
}
