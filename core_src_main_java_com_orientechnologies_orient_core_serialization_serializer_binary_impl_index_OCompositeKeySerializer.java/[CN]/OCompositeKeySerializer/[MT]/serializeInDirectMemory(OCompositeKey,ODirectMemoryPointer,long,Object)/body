{
  final OType[] types;
  if (hints != null && hints.length > 0)   types=(OType[])hints;
 else   types=new OType[0];
  final List<Object> keys=compositeKey.getKeys();
  final int keysSize=keys.size();
  final long oldStartOffset=offset;
  offset+=OIntegerSerializer.INT_SIZE;
  pointer.setInt(offset,keysSize);
  offset+=OIntegerSerializer.INT_SIZE;
  final OBinarySerializerFactory factory=OBinarySerializerFactory.INSTANCE;
  for (int i=0; i < keys.size(); i++) {
    final Object key=keys.get(i);
    final OType type;
    if (types.length > i)     type=types[i];
 else     type=OType.getTypeByClass(key.getClass());
    @SuppressWarnings("unchecked") OBinarySerializer<Object> binarySerializer=(OBinarySerializer<Object>)factory.getObjectSerializer(type);
    pointer.setByte(offset,binarySerializer.getId());
    offset+=OBinarySerializerFactory.TYPE_IDENTIFIER_SIZE;
    binarySerializer.serializeInDirectMemory(key,pointer,offset);
    offset+=binarySerializer.getObjectSize(key);
  }
  pointer.setInt(oldStartOffset,(int)(offset - oldStartOffset));
}
