{
  lock.acquireExclusiveLock();
  try {
    final OClusterLocal cluster;
    if (iClusterName != null) {
      int clusterPos=clusters.length;
      for (int i=0; i < clusters.length; ++i)       if (clusters[i] == null) {
        clusterPos=i;
        break;
      }
      final OStoragePhysicalClusterConfiguration config=new OStoragePhysicalClusterConfiguration(configuration,iClusterName,clusterPos);
      if (clusterPos >= configuration.clusters.size())       configuration.clusters.add(config);
 else       configuration.clusters.set(clusterPos,config);
      cluster=new OClusterLocal(this,config);
    }
 else     cluster=null;
    final int id=registerCluster(cluster);
    if (iClusterName != null) {
      clusters[id].create(iStartSize);
      configuration.update();
    }
    return id;
  }
  finally {
    lock.releaseExclusiveLock();
  }
}
