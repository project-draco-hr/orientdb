{
  storage.checkForClusterPermissions(getName());
  acquireExclusiveLock();
  try {
    final long begin=getFirstEntryPosition();
    if (begin > -1) {
      final long end=getLastEntryPosition();
      final OPhysicalPosition ppos=new OPhysicalPosition();
      for (ppos.clusterPosition=OClusterPositionFactory.INSTANCE.valueOf(begin); ppos.clusterPosition.longValue() <= end; ppos.clusterPosition=ppos.clusterPosition.inc()) {
        getPhysicalPosition(ppos);
        if (storage.checkForRecordValidity(ppos))         storage.getDataSegmentById(ppos.dataSegmentId).deleteRecord(ppos.dataSegmentPos);
      }
    }
    fileSegment.truncate();
    holeSegment.truncate();
  }
  finally {
    releaseExclusiveLock();
  }
}
