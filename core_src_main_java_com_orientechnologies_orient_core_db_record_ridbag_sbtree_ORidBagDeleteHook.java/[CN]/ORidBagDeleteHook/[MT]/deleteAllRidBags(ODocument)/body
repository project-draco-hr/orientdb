{
  final ORecordVersion version=document.getRecordVersion();
  if (document.fields() == 0) {
    document.reload();
    if (version.getCounter() > -1 && document.getRecordVersion().compareTo(version) != 0)     if (OFastConcurrentModificationException.enabled())     throw OFastConcurrentModificationException.instance();
 else     throw new OConcurrentModificationException(document.getIdentity(),document.getRecordVersion(),version,ORecordOperation.DELETED);
  }
  final ODocumentFieldWalker documentFieldWalker=new ODocumentFieldWalker();
  final RidBagDeleter ridBagDeleter=new RidBagDeleter();
  documentFieldWalker.walkDocument(document,ridBagDeleter);
}
