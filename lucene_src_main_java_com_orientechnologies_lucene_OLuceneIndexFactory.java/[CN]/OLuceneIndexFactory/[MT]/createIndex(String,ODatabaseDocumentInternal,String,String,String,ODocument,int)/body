{
  OAbstractPaginatedStorage storage=(OAbstractPaginatedStorage)database.getStorage().getUnderlying();
  if (metadata == null)   metadata=new ODocument().field("analyzer",StandardAnalyzer.class.getName());
  if (OClass.INDEX_TYPE.FULLTEXT.toString().equals(indexType)) {
    return new OLuceneFullTextIndex(name,indexType,LUCENE_ALGORITHM,version,storage,valueContainerAlgorithm,metadata);
  }
 else   if (OClass.INDEX_TYPE.FULLTEXTEXP.toString().equals(indexType)) {
    OLogManager.instance().info(this,"create index - database:: %s , indexName:: %s , algo:: %s , valuecontalgo:: %s",database.getName(),name,algorithm,valueContainerAlgorithm);
    if (!db2luceneindexes.containsKey(database.getName()))     db2luceneindexes.put(name,new OLuceneFullTextExpIndex(name,indexType,LUCENEEXP_ALGORITHM,version,storage,valueContainerAlgorithm,metadata));
    return new OLuceneFullTextExpIndex(name,indexType,LUCENEEXP_ALGORITHM,version,storage,valueContainerAlgorithm,metadata);
  }
  throw new OConfigurationException("Unsupported type : " + algorithm);
}
