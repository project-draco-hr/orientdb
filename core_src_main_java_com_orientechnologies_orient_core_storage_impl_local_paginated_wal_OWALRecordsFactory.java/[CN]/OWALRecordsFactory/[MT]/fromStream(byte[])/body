{
  OWALRecord walRecord;
switch (content[0]) {
case 0:
    walRecord=new OSetPageDataRecord();
  break;
case 1:
walRecord=new OStartAtomicPageUpdateRecord();
break;
case 2:
walRecord=new OEndAtomicPageUpdateRecord();
break;
case 3:
walRecord=new OFuzzyCheckpointStartRecord();
break;
case 4:
walRecord=new OFuzzyCheckpointEndRecord();
break;
case 5:
walRecord=new ODirtyPagesRecord();
break;
case 6:
walRecord=new OCheckpointStartRecord();
break;
case 7:
walRecord=new OCheckpointEndRecord();
break;
case 8:
walRecord=new OAddNewPageRecord();
break;
case 9:
walRecord=new OClusterStateRecord();
break;
default :
throw new IllegalStateException("Can not deserialize passed in wal record.");
}
walRecord.fromStream(content,1);
return walRecord;
}
