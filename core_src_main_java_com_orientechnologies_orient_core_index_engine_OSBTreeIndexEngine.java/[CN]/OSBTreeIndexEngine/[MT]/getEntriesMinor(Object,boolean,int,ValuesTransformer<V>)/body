{
  acquireSharedLock();
  try {
    final Set<ODocument> result=new ODocumentFieldsHashSet();
    sbTree.loadEntriesMinor(toKey,isInclusive,new OTree.RangeResultListener<Object,V>(){
      @Override public boolean addResult(      Map.Entry<Object,V> entry){
        final Object key=entry.getKey();
        final V value=entry.getValue();
        addToEntriesResult(transformer,result,key,value,maxEntriesToFetch);
        if (maxEntriesToFetch > -1 && result.size() == maxEntriesToFetch)         return false;
        return true;
      }
    }
);
    return result;
  }
  finally {
    releaseSharedLock();
  }
}
