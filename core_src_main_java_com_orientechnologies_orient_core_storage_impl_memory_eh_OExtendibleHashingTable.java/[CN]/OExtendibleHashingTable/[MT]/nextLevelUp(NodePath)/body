{
  if (nodePath.parent == null)   return null;
  final int nodeLocalDepth=nodesMetadata[nodePath.nodeIndex].getNodeLocalDepth();
  final int pointersSize=1 << (maxLevelDepth - nodeLocalDepth);
  final NodePath parent=nodePath.parent;
  if (parent.itemIndex < maxLevelSize / 2) {
    final int nextParentIndex=(parent.itemIndex / pointersSize + 1) * pointersSize;
    return new NodePath(parent.parent,0,nextParentIndex,parent.nodeIndex,nodeLocalDepth,parent.nodeGlobalDepth);
  }
  final int nextParentIndex=((parent.itemIndex - maxLevelSize / 2) / pointersSize + 1) * pointersSize + maxLevelSize / 2;
  if (nextParentIndex < maxLevelSize)   return new NodePath(parent.parent,0,nextParentIndex,parent.nodeIndex,nodeLocalDepth,parent.nodeGlobalDepth);
  return nextLevelUp(new NodePath(parent.parent,0,maxLevelSize - 1,parent.nodeIndex,nodeLocalDepth,parent.nodeGlobalDepth));
}
