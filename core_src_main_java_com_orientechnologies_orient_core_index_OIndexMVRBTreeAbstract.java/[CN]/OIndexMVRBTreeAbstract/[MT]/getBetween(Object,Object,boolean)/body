{
  if (iRangeFrom.getClass() != iRangeTo.getClass())   throw new IllegalArgumentException("Range from-to parameters are of different types");
  acquireExclusiveLock();
  try {
    final ONavigableMap<Object,ORecordLazySet> subSet=map.subMap(iRangeFrom,iInclusive,iRangeTo,iInclusive);
    if (subSet == null)     return ORecordLazySet.EMPTY_SET;
    final ORecordLazySet result=new ORecordLazySet(configuration.getDatabase(),ODocument.RECORD_TYPE);
    for (    ORecordLazySet v : subSet.values()) {
      result.addAll(v);
    }
    return result;
  }
  finally {
    releaseExclusiveLock();
  }
}
