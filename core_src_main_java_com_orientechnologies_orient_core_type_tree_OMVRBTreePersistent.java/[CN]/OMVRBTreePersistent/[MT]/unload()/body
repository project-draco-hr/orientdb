{
  final long timer=PROFILER.startChrono();
  try {
    for (    OMVRBTreeEntryPersistent<K,V> entryPoint : entryPoints.values())     entryPoint.disconnectLinked(true);
    entryPoints.clear();
    cache.clear();
    recordsToCommit.clear();
    root=null;
    final ODatabaseDocumentInternal db=ODatabaseRecordThreadLocal.INSTANCE.getIfDefined();
    if (db != null && !db.isClosed() && db.getStorage().getUnderlying() instanceof OAbstractPaginatedStorage) {
      try {
        load();
      }
 catch (      Exception e) {
      }
    }
  }
 catch (  Exception e) {
    final String message="Error on unload the tree: " + dataProvider;
    OLogManager.instance().error(this,message,e);
    throw OException.wrapException(new OStorageException(message),e);
  }
 finally {
    PROFILER.stopChrono(PROFILER.getProcessMetric("mvrbtree.unload"),"Unload a MVRBTree",timer);
  }
}
