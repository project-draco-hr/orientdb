{
  checkDirection(false);
  ORecordInternal<?> record=getRecord();
  while (currentClusterIdx > -1) {
    while (hasPrevious()) {
      if (record == null)       record=readCurrentRecord(null,-1);
      if (record != null)       if (record instanceof ODocument) {
        final ODocument doc=(ODocument)record;
        if (targetClass.isSuperClassOf(doc.getSchemaClass()))         return (REC)record;
      }
    }
    currentClusterIdx--;
    updateClusterRange();
    current.clusterPosition=lastClusterPosition + 1;
  }
  throw new NoSuchElementException();
}
