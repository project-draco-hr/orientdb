{
  if (!getDatabase().getMetadata().getSchema().getClasses().isEmpty())   return null;
  final OUser adminUser=createMetadata();
  final ORole readerRole=createRole("reader",ORole.ALLOW_MODES.DENY_ALL_BUT);
  readerRole.addRule(ORule.ResourceGeneric.DATABASE,null,ORole.PERMISSION_READ);
  readerRole.addRule(ORule.ResourceGeneric.SCHEMA,null,ORole.PERMISSION_READ);
  readerRole.addRule(ORule.ResourceGeneric.CLUSTER,OMetadataDefault.CLUSTER_INTERNAL_NAME,ORole.PERMISSION_READ);
  readerRole.addRule(ORule.ResourceGeneric.CLUSTER,"orole",ORole.PERMISSION_NONE);
  readerRole.addRule(ORule.ResourceGeneric.CLUSTER,"ouser",ORole.PERMISSION_NONE);
  readerRole.addRule(ORule.ResourceGeneric.CLASS,null,ORole.PERMISSION_READ);
  readerRole.addRule(ORule.ResourceGeneric.CLASS,"OUser",ORole.PERMISSION_NONE);
  readerRole.addRule(ORule.ResourceGeneric.CLUSTER,null,ORole.PERMISSION_READ);
  readerRole.addRule(ORule.ResourceGeneric.COMMAND,null,ORole.PERMISSION_READ);
  readerRole.addRule(ORule.ResourceGeneric.RECORD_HOOK,null,ORole.PERMISSION_READ);
  readerRole.addRule(ORule.ResourceGeneric.FUNCTION,null,ORole.PERMISSION_READ);
  readerRole.save();
  createUser("reader","reader",new String[]{readerRole.getName()});
  final ORole writerRole=createRole("writer",ORole.ALLOW_MODES.DENY_ALL_BUT);
  writerRole.addRule(ORule.ResourceGeneric.DATABASE,null,ORole.PERMISSION_READ);
  writerRole.addRule(ORule.ResourceGeneric.SCHEMA,null,ORole.PERMISSION_READ + ORole.PERMISSION_CREATE + ORole.PERMISSION_UPDATE);
  writerRole.addRule(ORule.ResourceGeneric.CLUSTER,OMetadataDefault.CLUSTER_INTERNAL_NAME,ORole.PERMISSION_READ);
  readerRole.addRule(ORule.ResourceGeneric.CLUSTER,"orole",ORole.PERMISSION_NONE);
  readerRole.addRule(ORule.ResourceGeneric.CLUSTER,"ouser",ORole.PERMISSION_NONE);
  writerRole.addRule(ORule.ResourceGeneric.CLASS,null,ORole.PERMISSION_ALL);
  writerRole.addRule(ORule.ResourceGeneric.CLASS,"OUser",ORole.PERMISSION_NONE);
  writerRole.addRule(ORule.ResourceGeneric.CLUSTER,null,ORole.PERMISSION_ALL);
  writerRole.addRule(ORule.ResourceGeneric.COMMAND,null,ORole.PERMISSION_ALL);
  writerRole.addRule(ORule.ResourceGeneric.RECORD_HOOK,null,ORole.PERMISSION_ALL);
  readerRole.addRule(ORule.ResourceGeneric.FUNCTION,null,ORole.PERMISSION_READ);
  writerRole.save();
  createUser("writer","writer",new String[]{writerRole.getName()});
  return adminUser;
}
