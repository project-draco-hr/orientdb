{
  while (true) {
    final long ts=System.currentTimeMillis();
    try {
      ODatabaseDocumentTx base_db=poolFactory.get(URL_BASE,"admin","admin").acquire();
      ODocument base_document=addDocument(ts);
      base_db.close();
      ODatabaseDocumentTx test_db=poolFactory.get(URL_TEST,"admin","admin").acquire();
      ODocument test_document=addDocument(ts);
      test_db.close();
      Assert.assertEquals(base_document,test_document);
      lastClusterPosition=base_document.getIdentity().getClusterPosition();
    }
 catch (    RuntimeException e) {
      e.printStackTrace();
      throw e;
    }
  }
}
