{
  disconnect();
  if (iUserPassword == null) {
    if (reader.hasPromptSupport()) {
      iUserPassword=reader.readLine("Enter password: ");
    }
 else {
      message("Enter password: ");
      final BufferedReader br=new BufferedReader(new InputStreamReader(System.in));
      iUserPassword=br.readLine();
      message("\n");
    }
  }
  currentDatabaseUserName=iUserName;
  currentDatabaseUserPassword=iUserPassword;
  if (iURL.contains("/")) {
    message("Connecting to database [" + iURL + "] with user '"+ iUserName+ "'...");
    currentDatabase=new ODatabaseDocumentTx(iURL);
    if (currentDatabase == null)     throw new OException("Database " + iURL + " not found");
    currentDatabase.registerListener(new OConsoleDatabaseListener(this));
    currentDatabase.open(iUserName,iUserPassword);
    currentDatabaseName=currentDatabase.getName();
    if (currentDatabase.getStorage() instanceof OStorageProxy)     serverAdmin=new OServerAdmin(currentDatabase.getStorage().getURL());
  }
 else {
    message("Connecting to remote Server instance [" + iURL + "] with user '"+ iUserName+ "'...");
    serverAdmin=new OServerAdmin(iURL).connect(iUserName,iUserPassword);
    currentDatabase=null;
    currentDatabaseName=null;
  }
  message("\nOK");
}
