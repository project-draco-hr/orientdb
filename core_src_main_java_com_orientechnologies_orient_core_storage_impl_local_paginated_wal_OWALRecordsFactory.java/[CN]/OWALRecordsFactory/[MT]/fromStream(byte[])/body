{
  OWALRecord walRecord;
switch (content[0]) {
case 0:
    walRecord=new OSetPageDataRecord();
  break;
case 1:
walRecord=new OShiftPageDataRecord();
break;
case 2:
walRecord=new OStartAtomicPageUpdate();
break;
case 3:
walRecord=new OEndAtomicPageUpdate();
break;
default :
throw new IllegalStateException("Can not deserialize passed in wal record.");
}
walRecord.fromStream(content,1);
return walRecord;
}
