{
  if (database == null) {
    for (int retry=0; retry < 100; ++retry) {
      try {
        database=distributed.getDatabaseInstance();
        break;
      }
 catch (      OConfigurationException e) {
        if (!waitForDatabaseIsOpen)         break;
        try {
          Thread.sleep(100);
        }
 catch (        InterruptedException e1) {
          Thread.currentThread().interrupt();
          return;
        }
      }
    }
    if (database == null)     throw new ODistributedException("Cannot open database '" + databaseName + "'");
  }
 else   if (database.isClosed()) {
    manager.getServerInstance().openDatabase(database,"internal","internal",null,true);
  }
}
