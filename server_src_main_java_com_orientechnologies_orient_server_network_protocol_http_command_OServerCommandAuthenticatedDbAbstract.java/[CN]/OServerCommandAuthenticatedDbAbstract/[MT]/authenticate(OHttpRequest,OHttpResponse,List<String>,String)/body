{
  ODatabaseDocumentTx db=null;
  try {
    db=(ODatabaseDocumentTx)server.openDatabase("document",iDatabaseName,iAuthenticationParts.get(0),iAuthenticationParts.get(1));
    iRequest.data.currentUserId=db.getUser() == null ? "<server user>" : db.getUser().getDocument().getIdentity().toString();
    iRequest.sessionId=OHttpSessionManager.getInstance().createSession(iDatabaseName,iAuthenticationParts.get(0),iAuthenticationParts.get(1));
    iResponse.sessionId=iRequest.sessionId;
    return true;
  }
 catch (  OSecurityAccessException e) {
  }
catch (  OLockException e) {
    OLogManager.instance().error(this,"Cannot access to the database '" + iDatabaseName + "'",ODatabaseException.class,e);
  }
 finally {
    if (db == null)     sendAuthorizationRequest(iRequest,iResponse,iDatabaseName);
  }
  return false;
}
