{
  if (lsn == null)   return;
synchronized (syncObject) {
    ListIterator<LogSegment> iterator=logSegments.listIterator(logSegments.size());
    while (iterator.hasPrevious()) {
      final LogSegment logSegment=iterator.previous();
      if (logSegment.end() == null || logSegment.end().compareTo(lsn) >= 0)       continue;
      logSegment.delete(false);
      iterator.remove();
    }
  }
}
