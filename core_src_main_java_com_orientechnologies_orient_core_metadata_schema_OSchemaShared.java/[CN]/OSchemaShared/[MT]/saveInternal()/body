{
  final ODatabaseRecord db=getDatabase();
  if (db.getTransaction().isActive())   throw new OSchemaException("Cannot change the schema while a transaction is active. Schema changes are not transactional");
  readWriteLock.writeLock().lock();
  try {
    document.setDirty();
    try {
      super.save(OMetadataDefault.CLUSTER_INTERNAL_NAME);
    }
 catch (    OConcurrentModificationException e) {
      reload(null,true);
    }
  }
  finally {
    readWriteLock.writeLock().unlock();
  }
}
