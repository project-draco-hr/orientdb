{
  if (iRecordId == null)   return null;
  ODocument doc=getRecordById(iRecordId);
  if (doc == null) {
    doc=(ODocument)underlying.load(iRecordId);
    if (doc == null)     return null;
  }
  if (doc.getClassName() == null)   throw new OGraphException("The document loaded has no class, while it should be a OGraphVertex, OGraphEdge or any subclass of its");
  return newInstance(doc.getClassName()).setDocument(doc);
}
