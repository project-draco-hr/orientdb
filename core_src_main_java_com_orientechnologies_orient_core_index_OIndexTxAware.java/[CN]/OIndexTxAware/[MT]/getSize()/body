{
  long tot=delegate.getSize();
  final OTransactionIndexChanges indexChanges=database.getTransaction().getIndexChanges(delegate.getName());
  if (indexChanges != null) {
    if (indexChanges.cleared)     tot=0;
    for (    Entry<Object,OTransactionIndexChangesPerKey> entry : indexChanges.changesPerKey.entrySet()) {
      for (      OTransactionIndexEntry e : entry.getValue().entries) {
        if (e.operation == OPERATION.REMOVE) {
          if (e.value == null)           tot--;
        }
 else         if (e.operation == OPERATION.PUT) {
        }
      }
    }
  }
  return tot;
}
