{
  final String name=Integer.toString(threadId);
  for (int i=0; i < count; i++) {
    final ODatabaseDocumentTx database=poolFactory.get(databaseUrl,"admin","admin").acquire();
    try {
      final int id=baseCount + i;
      int retry=0;
      for (retry=0; retry < maxRetries; retry++) {
        if ((i + 1) % 100 == 0)         System.out.println("\nWriter " + database.getURL() + "(thread="+ threadId+ ") managed "+ (i + 1)+ "/"+ count+ " records so far");
        if (useTransactions)         database.begin();
        try {
          ODocument person=createRecord(database,id);
          updateRecord(database,person);
          checkRecord(database,person);
          deleteRecord(database,person);
          checkRecordIsDeleted(database,person);
          person=createRecord(database,id);
          updateRecord(database,person);
          checkRecord(database,person);
          if (useTransactions)           database.commit();
          if (delayWriter > 0)           Thread.sleep(delayWriter);
          break;
        }
 catch (        InterruptedException e) {
          System.out.println("Writer received interrupt (db=" + database.getURL());
          Thread.currentThread().interrupt();
          break;
        }
catch (        ORecordDuplicatedException e) {
        }
catch (        OTransactionException e) {
          if (e.getCause() instanceof ORecordDuplicatedException)           ;
 else           throw e;
        }
catch (        ONeedRetryException e) {
          System.out.println("Writer received exception (db=" + database.getURL());
          if (retry >= maxRetries)           e.printStackTrace();
          break;
        }
catch (        ODistributedException e) {
          if (!(e.getCause() instanceof ORecordDuplicatedException)) {
            database.rollback();
            throw e;
          }
        }
catch (        Throwable e) {
          System.out.println("Writer received exception (db=" + database.getURL());
          e.printStackTrace();
          return null;
        }
      }
    }
  finally {
      runningWriters.countDown();
      database.close();
    }
  }
  System.out.println("\nWriter " + name + " END");
  return null;
}
