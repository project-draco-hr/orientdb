{
  if (iRequest.sessionId == null) {
    if (iRequest.authorization == null) {
      sendTextContent(iRequest,OHttpUtils.STATUS_AUTH_CODE,OHttpUtils.STATUS_AUTH_DESCRIPTION,"WWW-Authenticate: Basic realm=\"OrientDB Server\"",OHttpUtils.CONTENT_TEXT_PLAIN,null);
      return false;
    }
 else {
      iRequest.sessionId=OHttpSessionManager.getInstance().createSession();
    }
  }
 else {
    if (iRequest.sessionId.length() > 1 && OHttpSessionManager.getInstance().getSession(iRequest.sessionId) == null) {
      iRequest.sessionId=null;
      sendTextContent(iRequest,OHttpUtils.STATUS_AUTH_CODE,OHttpUtils.STATUS_AUTH_DESCRIPTION,"WWW-Authenticate: Basic realm=\"OrientDB Server\"",OHttpUtils.CONTENT_TEXT_PLAIN,"401 Unauthorized.");
      return false;
    }
  }
  return true;
}
