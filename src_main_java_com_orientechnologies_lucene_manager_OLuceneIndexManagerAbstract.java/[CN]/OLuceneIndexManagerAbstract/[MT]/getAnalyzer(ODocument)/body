{
  Analyzer analyzer=null;
  if (metadata != null) {
    final String analyzerString=metadata.field("analyzer");
    if (analyzerString != null) {
      try {
        final Class classAnalyzer=Class.forName(analyzerString);
        final Constructor constructor=classAnalyzer.getConstructor(Version.class);
        analyzer=(Analyzer)constructor.newInstance(getVersion(metadata));
      }
 catch (      ClassNotFoundException e) {
        throw new OIndexException("Analyzer: " + analyzerString + " not found",e);
      }
catch (      NoSuchMethodException e) {
        Class classAnalyzer=null;
        try {
          classAnalyzer=Class.forName(analyzerString);
          analyzer=(Analyzer)classAnalyzer.newInstance();
        }
 catch (        Throwable e1) {
          throw new OIndexException("Couldn't instantiate analyzer:  public constructor  not found",e1);
        }
      }
catch (      Exception e) {
        OLogManager.instance().error(this,"Error on getting analyzer for Lucene index",e);
      }
    }
  }
 else {
    analyzer=new StandardAnalyzer(getVersion(metadata));
  }
  return analyzer;
}
