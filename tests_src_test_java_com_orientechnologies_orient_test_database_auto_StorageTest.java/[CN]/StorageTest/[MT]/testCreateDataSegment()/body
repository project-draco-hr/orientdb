{
  database=new ODatabaseDocumentTx(url);
  if (!ODatabaseHelper.existsDatabase(database))   ODatabaseHelper.createDatabase(database,url);
  database.open("admin","admin");
  final int segmentId=database.addDataSegment("binary",null);
  Assert.assertEquals(segmentId,1);
  Assert.assertEquals(database.getStorage().getDataSegmentById(1).getSize(),0);
  database.setDataSegmentStrategy(new ODataSegmentStrategy(){
    public int assignDataSegmentId(    ODatabase iDatabase,    ORecord<?> iRecord){
      return 1;
    }
  }
);
  ODocument record=database.newInstance().field("name","data-segment-test").save();
  Assert.assertNotNull(record);
  Assert.assertTrue(database.getStorage().getDataSegmentById(1).getSize() > 0);
}
