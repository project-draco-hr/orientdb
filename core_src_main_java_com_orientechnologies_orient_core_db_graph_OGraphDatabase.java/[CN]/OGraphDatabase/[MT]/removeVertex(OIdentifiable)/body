{
  if (iVertex == null)   return false;
  final ODocument vertex=(ODocument)iVertex.getRecord();
  if (vertex == null)   return false;
  final boolean safeMode=beginBlock();
  try {
    ODocument otherVertex;
    Set<OIdentifiable> otherEdges;
    acquireWriteLock(vertex);
    try {
      Set<OIdentifiable> edges=getEdgeSet(vertex,VERTEX_FIELD_OUT);
      if (edges != null) {
        for (        OIdentifiable e : edges) {
          if (e != null) {
            final ODocument edge=e.getRecord();
            if (edge != null) {
              otherVertex=edge.field(EDGE_FIELD_IN);
              if (otherVertex != null) {
                otherEdges=getEdgeSet(otherVertex,VERTEX_FIELD_IN);
                if (otherEdges != null && otherEdges.remove(edge))                 save(otherVertex);
              }
              delete(edge);
            }
          }
        }
      }
      edges=getEdgeSet(vertex,VERTEX_FIELD_IN);
      if (edges != null) {
        for (        OIdentifiable e : edges) {
          if (e != null) {
            if (e != null) {
              final ODocument edge=e.getRecord();
              otherVertex=edge.field(EDGE_FIELD_OUT);
              if (otherVertex != null) {
                otherEdges=getEdgeSet(otherVertex,VERTEX_FIELD_OUT);
                if (otherEdges != null && otherEdges.remove(edge))                 save(otherVertex);
              }
              delete(edge);
            }
          }
        }
      }
      delete(vertex);
    }
  finally {
      releaseWriteLock(vertex);
    }
    commitBlock(safeMode);
    return true;
  }
 catch (  RuntimeException e) {
    rollbackBlock(safeMode);
    throw e;
  }
}
