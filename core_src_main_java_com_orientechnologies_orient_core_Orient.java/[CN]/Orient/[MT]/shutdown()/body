{
  try {
    acquireExclusiveLock();
    if (!active)     return;
    OLogManager.instance().debug(this,"Orient Engine is shutdowning...");
    for (    OStorage stg : storages.values()) {
      OLogManager.instance().debug(this,"Shutdowning storage: " + stg.getName() + "...");
      stg.close();
    }
    OMMapManager.shutdown();
    active=false;
    OLogManager.instance().debug(this,"Orient Engine shutdown complete");
  }
  finally {
    releaseExclusiveLock();
  }
}
