{
  if (returnDistributedResult()) {
    final Map<String,Object> doc=new HashMap<String,Object>();
    doc.put("sum",sum);
    doc.put("total",total);
    return doc;
  }
 else {
    if (sum instanceof Integer)     return sum.intValue() / total;
 else     if (sum instanceof Long)     return sum.longValue() / total;
 else     if (sum instanceof Float)     return sum.floatValue() / total;
 else     if (sum instanceof Double)     return sum.doubleValue() / total;
 else     if (sum instanceof BigDecimal)     return ((BigDecimal)sum).divide(new BigDecimal(total),RoundingMode.HALF_EVEN);
  }
  return null;
}
