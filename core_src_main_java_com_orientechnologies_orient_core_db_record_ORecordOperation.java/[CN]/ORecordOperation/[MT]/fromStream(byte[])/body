{
  try {
    final OMemoryStream stream=new OMemoryStream(iStream);
    serial=stream.getAsLong();
    type=stream.getAsByte();
    final ORecordId rid=new ORecordId().fromStream(stream);
switch (type) {
case CREATED:
      record=Orient.instance().getRecordFactoryManager().newInstance(stream.getAsByte());
    ((ORecordInternal<?>)record).fill(rid,0,stream.getAsByteArray(),true);
  clusterName=stream.getAsString();
break;
case UPDATED:
record=Orient.instance().getRecordFactoryManager().newInstance(stream.getAsByte());
((ORecordInternal<?>)record).fill(rid,0,stream.getAsByteArray(),true);
break;
}
return this;
}
 catch (Exception e) {
throw new OSerializationException("Cannot deserialize record operation",e);
}
}
