{
  storage.checkForClusterPermissions(getName());
  acquireExclusiveLock();
  try {
    OHashIndexBucket.Entry<OClusterPosition,OPhysicalPosition> entry=localHashTable.firstEntry();
    while (entry != null) {
      if (storage.checkForRecordValidity(entry.value)) {
        storage.getDataSegmentById(entry.value.dataSegmentId).deleteRecord(entry.value.dataSegmentPos);
      }
      final OHashIndexBucket.Entry<OClusterPosition,OPhysicalPosition>[] entries=localHashTable.higherEntries(entry.key,1);
      if (entries.length > 0)       entry=entries[0];
 else       entry=null;
    }
    localHashTable.clear();
    tombstonesCount=0;
  }
  finally {
    releaseExclusiveLock();
  }
}
