{
  super.fromStream(iBuffer);
  int schemaVersion=field("schemaVersion");
  if (schemaVersion != CURRENT_VERSION_NUMBER) {
    throw new OConfigurationException("Database schema is different. Please export your old database with the previous verison of Orient and reimport it using the current one.");
  }
  OClass cls;
  List<ODocument> storedClasses=field("classes");
  for (  ODocument c : storedClasses) {
    cls=new OClass(this).fromDocument(c);
    classes.put(cls.getName().toLowerCase(),cls);
  }
  return this;
}
