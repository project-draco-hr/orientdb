{
  filesLock.acquireWriteLock();
  try {
    this.id=id;
    this.files=new ConcurrentHashMap<Integer,OFileClassic>();
    this.syncOnPageFlush=syncOnPageFlush;
    this.pageSize=pageSize;
    this.groupTTL=groupTTL;
    this.writeAheadLog=writeAheadLog;
    this.cacheMaxSize=normalizeMemory(cacheMaxSize,pageSize);
    this.storageLocal=storageLocal;
    this.storagePath=storageLocal.getVariableParser().resolveVariables(storageLocal.getStoragePath());
    final OBinarySerializerFactory binarySerializerFactory=storageLocal.getComponentsFactory().binarySerializerFactory;
    this.stringSerializer=binarySerializerFactory.getObjectSerializer(OType.STRING);
    if (checkMinSize && this.cacheMaxSize < MIN_CACHE_SIZE)     this.cacheMaxSize=MIN_CACHE_SIZE;
    commitExecutor=Executors.newSingleThreadScheduledExecutor(new FlushThreadFactory(storageLocal.getName()));
    lowSpaceEventsPublisher=Executors.newCachedThreadPool(new LowSpaceEventsPublisherFactory(storageLocal.getName()));
    if (pageFlushInterval > 0)     commitExecutor.scheduleWithFixedDelay(new PeriodicFlushTask(),pageFlushInterval,pageFlushInterval,TimeUnit.MILLISECONDS);
  }
  finally {
    filesLock.releaseWriteLock();
  }
}
