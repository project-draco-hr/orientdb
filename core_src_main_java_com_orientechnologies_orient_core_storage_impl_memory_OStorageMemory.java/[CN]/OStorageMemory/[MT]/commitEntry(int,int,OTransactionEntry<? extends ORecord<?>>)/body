{
  final ORecordId rid=(ORecordId)txEntry.record.getIdentity();
  final OCluster cluster=txEntry.clusterName != null ? getClusterByName(txEntry.clusterName) : getClusterById(rid.clusterId);
switch (txEntry.status) {
case OTransactionEntry.LOADED:
    break;
case OTransactionEntry.CREATED:
  if (rid.isNew()) {
    final byte[] stream=txEntry.record.toStream();
    if (rid.isNew()) {
      rid.clusterPosition=createRecord(cluster.getId(),stream,txEntry.record.getRecordType());
      rid.clusterId=cluster.getId();
    }
 else {
      txEntry.record.setVersion(updateRecord(iRequesterId,rid,stream,txEntry.record.getVersion(),txEntry.record.getRecordType()));
    }
  }
break;
case OTransactionEntry.UPDATED:
txEntry.record.setVersion(updateRecord(iRequesterId,rid,txEntry.record.toStream(),txEntry.record.getVersion(),txEntry.record.getRecordType()));
break;
case OTransactionEntry.DELETED:
deleteRecord(iRequesterId,rid,txEntry.record.getVersion());
break;
}
}
