{
  if (OUniqueHashIndex.TYPE_ID.equals(iIndexType)) {
    if (BUFFER.get() == null) {
      final ODirectMemory directMemory=ODirectMemoryFactory.INSTANCE.directMemory();
      if (directMemory == null)       throw new OConfigurationException("There is no suitable direct memory implementation for this platform." + " Index creation was canceled.");
      if (!(iDatabase.getStorage() instanceof OStorageLocal))       throw new OConfigurationException("Given configuration works only for local storage.");
      final long bufferMaxMemory=OGlobalConfiguration.HASH_INDEX_BUFFER_SIZE.getValueAsLong() * 1024 * 1024;
      OLRUBuffer buffer=new OLRUBuffer(bufferMaxMemory,directMemory,OHashIndexBucket.MAX_BUCKET_SIZE_BYTES,(OStorageLocal)iDatabase.getStorage(),false);
      BUFFER.compareAndSet(null,buffer);
    }
    return new OUniqueHashIndex(BUFFER.get(),(OStorageLocal)iDatabase.getStorage());
  }
  throw new OConfigurationException("Unsupported type : " + iIndexType);
}
