{
  if (storage.getClusterIdByName(iNewName) > -1)   throw new IllegalArgumentException("Cluster with name '" + iNewName + "' already exists");
  for (int i=0; i < fileSegment.files.length; i++) {
    final String osFileName=fileSegment.files[i].getName();
    if (osFileName.startsWith(name)) {
      final File newFile=new File(storage.getStoragePath() + '/' + iNewName+ osFileName.substring(osFileName.lastIndexOf(name) + name.length()));
      for (      OStorageFileConfiguration conf : config.infoFiles) {
        if (conf.parent.name.equals(name))         conf.parent.name=iNewName;
        if (conf.path.endsWith(osFileName))         conf.path=conf.path.replace(osFileName,newFile.getName());
      }
      boolean renamed=fileSegment.files[i].renameTo(newFile);
      while (!renamed) {
        OMemoryWatchDog.freeMemory(100);
        renamed=fileSegment.files[i].renameTo(newFile);
      }
    }
  }
  config.name=iNewName;
  for (int i=0; i < overflowSegment.files.length; i++) {
    final String osFileName=overflowSegment.files[i].getName();
    if (osFileName.startsWith(name)) {
      final File newFile=new File(storage.getStoragePath() + '/' + iNewName+ osFileName.substring(osFileName.lastIndexOf(name) + name.length()));
      for (      OStorageFileConfiguration conf : config.infoFiles) {
        if (conf.parent.name.equals(name))         conf.parent.name=iNewName;
        if (conf.path.endsWith(osFileName))         conf.path=conf.path.replace(osFileName,newFile.getName());
      }
      boolean renamed=overflowSegment.files[i].renameTo(newFile);
      while (!renamed) {
        OMemoryWatchDog.freeMemory(100);
        renamed=overflowSegment.files[i].renameTo(newFile);
      }
    }
  }
  overflowStatistic.rename(name,iNewName);
  storage.renameCluster(name,iNewName);
  name=iNewName;
  storage.getConfiguration().update();
}
