{
  acquireExclusiveLock();
  try {
    long offset=holeSegment.popLastEntryPosition();
    final long[] pos;
    if (offset > -1)     pos=getRelativePosition(offset);
 else {
      pos=allocateSpace(RECORD_SIZE);
      offset=getAbsolutePosition(pos);
    }
    OFile file=files[(int)pos[0]];
    long p=pos[1];
    file.writeShort(p,(short)iDataSegmentId);
    file.writeLong(p+=OConstants.SIZE_SHORT,iPosition);
    file.writeByte(p+=OConstants.SIZE_LONG,iRecordType);
    final long returnedPosition=offset / RECORD_SIZE;
    updateBoundsAfterInsertion(returnedPosition);
    return returnedPosition;
  }
  finally {
    releaseExclusiveLock();
  }
}
