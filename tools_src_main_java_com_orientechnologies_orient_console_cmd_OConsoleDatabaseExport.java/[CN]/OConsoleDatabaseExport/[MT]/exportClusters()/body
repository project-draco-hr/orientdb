{
  listener.onMessage("\nExporting clusters...");
  writer.beginCollection(1,true,"clusters");
  int totalClusters=0;
  for (  String clusterName : database.getClusterNames()) {
    if (includeClusters != null) {
      if (!includeClusters.contains(clusterName))       continue;
    }
 else     if (excludeClusters != null) {
      if (excludeClusters.contains(clusterName))       continue;
    }
    writer.beginObject(2,true,null);
    writer.writeAttribute(0,false,"name",clusterName);
    writer.writeAttribute(0,false,"id",database.getClusterIdByName(clusterName));
    writer.writeAttribute(0,false,"type",database.getClusterType(clusterName));
    if (database.getStorage() instanceof OStorageLocal)     if (database.getClusterType(clusterName).equals("LOGICAL")) {
      OClusterLogical cluster=(OClusterLogical)database.getStorage().getClusterById(database.getClusterIdByName(clusterName));
      writer.writeAttribute(0,false,"rid",cluster.getRID());
    }
    totalClusters++;
    writer.endObject(2,false);
  }
  listener.onMessage("OK (" + totalClusters + " clusters)");
  writer.endCollection(1,true);
}
