{
synchronized (syncObject) {
    final String fullName=fileName + fileExtension;
    final OMultiFileSegment multiFileSegment=files.get(fullName);
    final long startPosition=pageIndex * pageSize;
    final long endPosition=startPosition + pageSize;
    if (multiFileSegment.getFilledUpTo() < endPosition)     multiFileSegment.allocateSpaceContinuously((int)(endPosition - multiFileSegment.getFilledUpTo()));
    long dataPointer=directMemory.allocate(new byte[pageSize]);
    updateCache(fullName,pageIndex,dataPointer);
    lockManager.acquireLock(Thread.currentThread(),new FileLockKey(fullName,pageIndex),OLockManager.LOCK.EXCLUSIVE);
    return dataPointer;
  }
}
