{
  listener.onMessage("\nExporting index info...");
  writer.beginCollection(1,true,"indexes");
  final OIndexManagerProxy indexManager=database.getMetadata().getIndexManager();
  indexManager.reload();
  final Collection<? extends OIndex> indexes=indexManager.getIndexes();
  for (  OIndex index : indexes) {
    listener.onMessage("\nIndex " + index.getName() + "...");
    writer.beginObject(2,true,null);
    writer.writeAttribute(3,true,"name",index.getName());
    writer.writeAttribute(3,true,"type",index.getType());
    if (!index.getClusters().isEmpty())     writer.writeAttribute(3,true,"clustersToIndex",index.getClusters());
    if (index.getDefinition() != null) {
      writer.beginObject(4,true,"definition");
      writer.writeAttribute(5,true,"defClass",index.getDefinition().getClass().getName());
      writer.writeAttribute(5,true,"stream",index.getDefinition().toStream());
      writer.endObject(4,true);
    }
    writer.endObject(2,true);
    listener.onMessage("OK");
  }
  writer.endCollection(1,true);
  listener.onMessage("OK (" + indexes.size() + " indexes)");
}
