{
  OBinarySerializer<?> objectSerializer=storage.getComponentsFactory().binarySerializerFactory.getObjectSerializer(OLuceneMockSpatialSerializer.INSTANCE.getId());
  if (objectSerializer == null) {
    storage.getComponentsFactory().binarySerializerFactory.registerSerializer(OLuceneMockSpatialSerializer.INSTANCE,OType.EMBEDDED);
  }
  if (OClass.INDEX_TYPE.FULLTEXT.toString().equals(type)) {
    return new OLuceneFullTextIndex(name,type,LUCENE_ALGORITHM,version,storage,valueContainerAlgorithm,metadata);
  }
 else   if (OClass.INDEX_TYPE.SPATIAL.toString().equals(type)) {
    return new OLuceneSpatialIndex(name,type,LUCENE_ALGORITHM,version,storage,valueContainerAlgorithm,metadata);
  }
  throw new OConfigurationException("Unsupported type : " + indexType);
}
