{
  checkOpeness();
  final OCluster cluster=getClusterById(iRid.clusterId);
  final ODataLocal dataSegment=getDataSegmentById(iDataSegmentId);
  final OPhysicalPosition ppos;
  modificationLock.requestModificationLock();
  try {
    lock.acquireExclusiveLock();
    try {
      if (txManager.isCommitting()) {
        ppos=txManager.createRecord(txManager.getCurrentTransaction().getId(),dataSegment,cluster,iRid,iContent,iRecordVersion,iRecordType);
      }
 else {
        ppos=createRecord(dataSegment,cluster,iContent,iRecordType,iRid,iRecordVersion);
        if (OGlobalConfiguration.NON_TX_RECORD_UPDATE_SYNCH.getValueAsBoolean() || clustersToSyncImmediately.contains(cluster.getName()))         synchRecordUpdate(cluster,ppos);
        if (iCallback != null)         iCallback.call(iRid,ppos.clusterPosition);
      }
    }
  finally {
      lock.releaseExclusiveLock();
    }
  }
  finally {
    modificationLock.releaseModificationLock();
  }
  return new OStorageOperationResult<OPhysicalPosition>(ppos);
}
