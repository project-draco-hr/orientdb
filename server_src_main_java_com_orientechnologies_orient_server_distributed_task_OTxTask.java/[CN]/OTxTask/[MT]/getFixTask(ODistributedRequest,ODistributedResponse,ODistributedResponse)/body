{
  final OFixTxTask fixTask=new OFixTxTask();
  for (  OAbstractRecordReplicatedTask t : tasks) {
    final ORecordId rid=t.getRid();
    final ORecordInternal<?> rec=rid.getRecord();
    if (rec == null)     fixTask.add(new ODeleteRecordTask(rid,null));
 else {
      final ORecordVersion v=rec.getRecordVersion();
      v.setRollbackMode();
      fixTask.add(new OUpdateRecordTask(rid,rec.toStream(),v,rec.getRecordType()));
    }
  }
  return fixTask;
}
