{
  return new Iterable<OTransactionEntryProxy>(){
    public Iterator<OTransactionEntryProxy> iterator(){
      return new Iterator<OTransactionEntryProxy>(){
        private int current=1;
        public boolean hasNext(){
          if (exhausted)           return false;
          exhausted=current > size;
          return !exhausted;
        }
        public OTransactionEntryProxy next(){
          try {
            OTransactionEntryProxy entry=new OTransactionEntryProxy();
            if (entries.size() < size) {
              final ORecordId rid=(ORecordId)entry.getRecord().getIdentity();
              entry.status=channel.readByte();
              rid.clusterId=channel.readShort();
              entry.getRecord().recordType=channel.readByte();
switch (entry.status) {
case OTransactionEntry.CREATED:
                rid.clusterPosition=-1;
              entry.clusterName=channel.readString();
            entry.getRecord().stream=channel.readBytes();
          break;
case OTransactionEntry.UPDATED:
        rid.clusterPosition=channel.readLong();
      entry.getRecord().version=channel.readInt();
    entry.getRecord().stream=channel.readBytes();
  updatedRecords.put(rid,entry.getRecord());
break;
case OTransactionEntry.DELETED:
rid.clusterPosition=channel.readLong();
entry.getRecord().version=channel.readInt();
break;
default :
throw new OTransactionException("Unrecognized tx command: " + entry.status);
}
entries.add(entry);
}
 else entry=entries.get(current - 1);
current++;
return entry;
}
 catch (IOException e) {
throw new OSerializationException("Can't read transaction record from the network",e);
}
}
public void remove(){
throw new UnsupportedOperationException("remove");
}
}
;
}
}
;
}
