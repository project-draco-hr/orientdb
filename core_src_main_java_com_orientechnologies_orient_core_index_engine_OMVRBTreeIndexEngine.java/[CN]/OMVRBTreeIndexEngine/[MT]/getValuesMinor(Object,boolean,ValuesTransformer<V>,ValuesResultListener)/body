{
  acquireExclusiveLock();
  try {
    final OMVRBTreeEntry<Object,V> lastEntry;
    if (isInclusive)     lastEntry=map.getFloorEntry(toKey,OMVRBTree.PartialSearchMode.HIGHEST_BOUNDARY);
 else     lastEntry=map.getLowerEntry(toKey);
    if (lastEntry == null)     return;
    OMVRBTreeEntry<Object,V> entry=lastEntry;
    while (entry != null) {
      V value=entry.getValue();
      boolean cont=addToResult(transformer,valuesResultListener,value);
      if (!cont)       return;
      entry=OMVRBTree.previous(entry);
    }
  }
  finally {
    releaseExclusiveLock();
  }
}
