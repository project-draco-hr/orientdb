{
  OGlobalConfiguration.SERVER_CACHE_2Q_INCREASE_ON_DEMAND.setValue(true);
  long fileId=buffer.openFile(fileName);
  long[] pointers;
  pointers=new long[20];
  for (int i=0; i < 6; i++) {
    pointers[i]=buffer.load(fileId,i);
    buffer.markDirty(fileId,i);
    directMemory.set(pointers[i] + systemOffset,new byte[]{(byte)i,1,2,seed,4,5,6,7},0,8);
    buffer.release(fileId,i);
  }
  for (int i=0; i < 4; i++) {
    pointers[i]=buffer.load(fileId,i);
    buffer.markDirty(fileId,i);
    directMemory.set(pointers[i] + systemOffset,new byte[]{(byte)i,1,2,seed,4,5,6,7},0,8);
  }
  for (int i=0; i < 4; i++) {
    buffer.release(fileId,i);
  }
  int maxSize=buffer.getMaxSize();
  Assert.assertEquals(maxSize,5);
  OGlobalConfiguration.SERVER_CACHE_2Q_INCREASE_ON_DEMAND.setValue(false);
}
