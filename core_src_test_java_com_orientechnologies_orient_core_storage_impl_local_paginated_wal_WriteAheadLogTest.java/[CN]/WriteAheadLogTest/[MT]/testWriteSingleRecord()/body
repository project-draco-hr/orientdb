{
  writeAheadLog.logRecord(new OSetPageDataRecord(20,"test"));
  OWALRecord walRecord=writeAheadLog.read(writeAheadLog.begin());
  Assert.assertTrue(walRecord instanceof OSetPageDataRecord);
  OSetPageDataRecord setPageDataRecord=(OSetPageDataRecord)walRecord;
  Assert.assertEquals(setPageDataRecord.getPageIndex(),20);
  Assert.assertEquals(setPageDataRecord.getFileName(),"test");
  Assert.assertNull(writeAheadLog.next(walRecord.getLsn()));
  writeAheadLog.close();
  writeAheadLog=createWAL();
  walRecord=writeAheadLog.read(writeAheadLog.begin());
  Assert.assertEquals(walRecord.getLsn(),writeAheadLog.begin());
  Assert.assertTrue(walRecord instanceof OSetPageDataRecord);
  setPageDataRecord=(OSetPageDataRecord)walRecord;
  Assert.assertEquals(setPageDataRecord.getPageIndex(),20);
  Assert.assertEquals(setPageDataRecord.getFileName(),"test");
  Assert.assertNull(writeAheadLog.next(writeAheadLog.begin()));
}
