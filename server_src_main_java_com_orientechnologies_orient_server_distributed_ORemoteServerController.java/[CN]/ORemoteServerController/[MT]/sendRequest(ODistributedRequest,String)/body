{
  networkAdminOperation(new OStorageRemoteOperation<Object>(){
    @Override public Object execute(    final OChannelBinaryAsynchClient network) throws IOException {
      storage.beginRequest(network,OChannelBinaryProtocol.DISTRIBUTED_REQUEST);
      try {
        final byte[] serializedRequest;
        final ByteArrayOutputStream out=new ByteArrayOutputStream();
        try {
          final ObjectOutputStream outStream=new ObjectOutputStream(out);
          try {
            req.writeExternal(outStream);
            serializedRequest=out.toByteArray();
            ODistributedServerLog.debug(this,manager.getLocalNodeName(),node,ODistributedServerLog.DIRECTION.OUT,"Sending request %s (%d bytes)",req,serializedRequest.length);
            network.writeBytes(serializedRequest);
          }
  finally {
            outStream.close();
          }
        }
  finally {
          out.close();
        }
      }
  finally {
        storage.endRequest(network);
        storage.getEngine().getConnectionManager().release(network);
      }
      return null;
    }
  }
,"Cannot send distributed request");
}
