{
  if (!isEnabled() || iRID.getClusterId() == excludedCluster)   return null;
  ORecordInternal<?> record;
  underlying.lock(iRID);
  try {
    record=underlying.remove(iRID);
    if (record == null || record.isDirty()) {
      Orient.instance().getProfiler().updateCounter(CACHE_MISS,1);
      return null;
    }
    if (strategy == STRATEGY.COPY_RECORD) {
      final ORecordInternal<?> resident=OGlobalConfiguration.ENVIRONMENT_CONCURRENT.getValueAsBoolean() ? (ORecordInternal<?>)record.flatCopy() : record;
      underlying.put(resident);
    }
  }
  finally {
    underlying.unlock(iRID);
  }
  Orient.instance().getProfiler().updateCounter(CACHE_HIT,1);
  return record;
}
