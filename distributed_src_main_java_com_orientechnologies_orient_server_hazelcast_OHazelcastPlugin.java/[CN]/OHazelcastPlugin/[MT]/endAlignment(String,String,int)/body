{
synchronized (pendingAlignments) {
    if (pendingAlignments.remove(iNode + "/" + iDatabaseName) == null) {
      ODistributedServerLog.error(this,getLocalNodeName(),iNode,DIRECTION.OUT,"received response for an alignment against an unknown node %s database %s",iDatabaseName);
    }
    if (pendingAlignments.isEmpty()) {
      setStatus(STATUS.ONLINE);
    }
 else {
      for (      Entry<String,Boolean> entry : pendingAlignments.entrySet()) {
        final String[] parts=entry.getKey().split("/");
        final String node=parts[0];
        final String databaseName=parts[1];
        if (entry.getValue()) {
          final OStorageSynchronizer synch=synchronizers.get(databaseName);
          long[] lastOperationId;
          try {
            lastOperationId=synch.getLog().getLastJournaledOperationId(null);
            ODistributedServerLog.info(this,getLocalNodeName(),node,DIRECTION.OUT,"resend alignment request db=%s from %d:%d",databaseName,lastOperationId[0],lastOperationId[1]);
            sendRequest(databaseName,new OAlignRequestTask(lastOperationId[0],lastOperationId[1]));
          }
 catch (          IOException e) {
            ODistributedServerLog.warn(this,getLocalNodeName(),null,DIRECTION.OUT,"error on retrieve last operation id from the log for db=%s",databaseName);
          }
        }
 else         ODistributedServerLog.info(this,getLocalNodeName(),node,DIRECTION.NONE,"db=%s is in alignment status yet, the node is not online yet",databaseName);
      }
    }
  }
}
