{
  Map<String,Object> geometry=(Map<String,Object>)query.get(SHAPE);
  if (geometry == null) {
    throw new OIndexEngineException("Invalid spatial query. Missing shape field " + query,null);
  }
  ODocument doc=new ODocument((String)geometry.get(SHAPE_TYPE));
  doc.field(COORDINATES,geometry.get(COORDINATES));
  return factory.fromDoc(doc);
}
