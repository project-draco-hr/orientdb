{
  if (iRequest.authorization == null)   throw new OSecurityAccessException(iRequest.databaseName,"No user and password received");
  final List<String> parts=OStringSerializerHelper.split(iRequest.authorization,':');
  final ODatabaseDocumentTx db=(ODatabaseDocumentTx)server.openDatabase("graph",iRequest.databaseName,parts.get(0),parts.get(1));
  if (db != null) {
    iRequest.data.lastDatabase=db.getName();
    iRequest.data.lastUser=db.getUser() != null ? db.getUser().getName() : null;
  }
 else {
    iRequest.data.lastDatabase=null;
    iRequest.data.lastUser=null;
  }
  return db;
}
