{
  lock.acquireExclusiveLock();
  try {
    final OClusterMemory cluster;
    if (iClusterName != null) {
      final OStorageMemoryClusterConfiguration config=new OStorageMemoryClusterConfiguration(iClusterName,clusters.length);
      configuration.setCluster(config);
      cluster=new OClusterMemory(clusters.length,iClusterName);
    }
 else     cluster=null;
    final int id=registerCluster(cluster);
    if (iClusterName != null)     configuration.update();
    return id;
  }
  finally {
    lock.releaseExclusiveLock();
  }
}
