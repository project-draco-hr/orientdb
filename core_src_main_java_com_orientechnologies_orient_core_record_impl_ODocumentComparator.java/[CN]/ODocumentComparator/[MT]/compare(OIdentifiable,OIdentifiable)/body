{
  if (iDoc1 != null && iDoc1.equals(iDoc2))   return 0;
  Object fieldValue1;
  Object fieldValue2;
  int partialResult=0;
  for (  OPair<String,String> field : orderCriteria) {
    final String fieldName=field.getKey();
    final String ordering=field.getValue();
    fieldValue1=((ODocument)iDoc1.getRecord()).field(fieldName);
    fieldValue2=((ODocument)iDoc2.getRecord()).field(fieldName);
    if (fieldValue1 == null && fieldValue2 == null) {
      continue;
    }
    if (fieldValue1 == null)     return factor(Integer.MIN_VALUE,ordering);
    if (fieldValue2 == null)     return factor(Integer.MAX_VALUE,ordering);
    if (!(fieldValue1 instanceof Comparable<?>))     throw new IllegalArgumentException("Cannot sort documents because the field '" + fieldName + "' is not comparable");
    partialResult=((Comparable<Object>)fieldValue1).compareTo(fieldValue2);
    partialResult=factor(partialResult,ordering);
    if (partialResult != 0)     break;
  }
  return partialResult;
}
