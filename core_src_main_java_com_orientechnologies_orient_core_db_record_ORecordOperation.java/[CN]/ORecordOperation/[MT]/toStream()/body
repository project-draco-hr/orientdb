{
  try {
    final OMemoryStream stream=new OMemoryStream();
    stream.set(type);
    ((ORecordId)record.getIdentity()).toStream(stream);
switch (type) {
case CREATED:
case UPDATED:
      stream.set(ORecordInternal.getRecordType(record.getRecord()));
    stream.set(record.getRecord().toStream());
  break;
}
return stream.toByteArray();
}
 catch (Exception e) {
throw OException.wrapException(new OSerializationException("Cannot serialize record operation"),e);
}
}
