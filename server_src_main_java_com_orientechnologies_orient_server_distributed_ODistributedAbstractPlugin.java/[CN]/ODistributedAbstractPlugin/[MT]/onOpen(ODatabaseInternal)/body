{
  final String dbUrl=OSystemVariableResolver.resolveSystemVariables(iDatabase.getURL());
  if (dbUrl.startsWith("plocal:")) {
    final String dbDirectory=serverInstance.getDatabaseDirectory();
    if (!dbUrl.substring("plocal:".length()).startsWith(dbDirectory))     return;
  }
synchronized (cachedDatabaseConfiguration) {
    final ODistributedConfiguration cfg=getDatabaseConfiguration(iDatabase.getName());
    if (cfg == null)     return;
    final OStorage dbStorage=iDatabase.getStorage();
    if (iDatabase instanceof ODatabase<?> && dbStorage instanceof OAbstractPaginatedStorage) {
      ODistributedStorage storage=storages.get(iDatabase.getURL());
      if (storage == null) {
        storage=new ODistributedStorage(serverInstance,(OAbstractPaginatedStorage)dbStorage);
        final ODistributedStorage oldStorage=storages.putIfAbsent(iDatabase.getURL(),storage);
        if (oldStorage != null)         storage=oldStorage;
      }
      iDatabase.replaceStorage(storage);
    }
  }
}
