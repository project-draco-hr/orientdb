{
  acquireExclusiveLock();
  try {
    this.storage=storageLocal;
    this.diskCache=storage.getDiskCache();
    if (this.diskCache == null)     throw new IllegalStateException("Disk cache was not initialized on storage level");
    this.name=name;
    this.keySerializer=keySerializer;
    this.valueSerializer=valueSerializer;
    initStores(metadataConfigurationFileExtension,treeStateFileExtension);
    metadataStore.create(-1);
    treeStateStore.create(-1);
    metadataStore.setRecordsCount(size);
    treeStateStore.setHashTreeSize(hashTreeSize);
    treeStateStore.setHashTreeTombstone(hashTreeTombstone);
    treeStateStore.setBucketTombstonePointer(bucketTombstonePointer);
    filesMetadata[0]=createFileMetadata(0);
    initHashTreeState();
  }
 catch (  IOException e) {
    throw new OIndexException("Error during local hash table creation.",e);
  }
 finally {
    releaseExclusiveLock();
  }
}
