{
  if (iRecord == null)   return null;
  boolean originalSaved=false;
  ODirtyManager dirtyManager=ORecordInternal.getDirtyManager(iRecord);
  Set<ORecord> newRecord=dirtyManager.getNewRecord();
  Set<ORecord> updatedRecord=dirtyManager.getUpdateRecord();
  dirtyManager.cleanForSave();
  if (newRecord != null) {
    for (    ORecord rec : newRecord) {
      addRecord(rec,ORecordOperation.CREATED,getClusterName(rec));
      if (rec == iRecord)       originalSaved=true;
    }
  }
  if (updatedRecord != null) {
    for (    ORecord rec : updatedRecord) {
      addRecord(rec,ORecordOperation.UPDATED,getClusterName(rec));
      if (rec == iRecord)       originalSaved=true;
    }
  }
  if (!originalSaved && iRecord.isDirty()) {
    final byte operation=iForceCreate ? ORecordOperation.CREATED : iRecord.getIdentity().isValid() ? ORecordOperation.UPDATED : ORecordOperation.CREATED;
    addRecord(iRecord,operation,iClusterName);
  }
  return iRecord;
}
