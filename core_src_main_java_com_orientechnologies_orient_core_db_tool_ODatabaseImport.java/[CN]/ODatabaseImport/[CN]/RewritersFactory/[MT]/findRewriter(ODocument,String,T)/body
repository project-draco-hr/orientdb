{
  if (value == null)   return new IdentityRewriter<T>();
  OType fieldType=null;
  if (document != null) {
    OClass docClass=document.getSchemaClass();
    if (docClass != null) {
      OProperty property=docClass.getProperty(fieldName);
      if (property != null)       fieldType=property.getType();
    }
 else {
      fieldType=document.fieldType(fieldName);
    }
  }
  if (fieldType == null) {
    if (value instanceof ODocument)     return (FieldRewriter<T>)new DocumentRewriter();
 else     if (value instanceof List)     return (FieldRewriter<T>)new ListRewriter();
 else     if (value instanceof Map)     return (FieldRewriter<T>)new MapRewriter();
 else     if (value instanceof OMVRBTreeRIDSet)     return (FieldRewriter<T>)new LinkSetRewriter();
 else     if (value instanceof ORID)     return (FieldRewriter<T>)new LinkRewriter(exportImportHashTable);
 else     if (value instanceof Set)     return (FieldRewriter<T>)new SetRewriter();
 else     return new IdentityRewriter<T>();
  }
switch (fieldType) {
case EMBEDDED:
    return (FieldRewriter<T>)new DocumentRewriter();
case LINKLIST:
  return (FieldRewriter<T>)new ListRewriter();
case LINKMAP:
return (FieldRewriter<T>)new MapRewriter();
case LINKSET:
return (FieldRewriter<T>)new LinkSetRewriter();
case LINK:
return (FieldRewriter<T>)new LinkRewriter(exportImportHashTable);
case EMBEDDEDLIST:
return (FieldRewriter<T>)new ListRewriter();
case EMBEDDEDMAP:
return (FieldRewriter<T>)new MapRewriter();
case EMBEDDEDSET:
return (FieldRewriter<T>)new SetRewriter();
}
return new IdentityRewriter<T>();
}
