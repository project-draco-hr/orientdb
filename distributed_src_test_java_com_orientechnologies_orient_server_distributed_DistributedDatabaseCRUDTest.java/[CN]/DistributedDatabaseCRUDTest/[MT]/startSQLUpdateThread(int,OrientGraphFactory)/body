{
  Runnable th=new Runnable(){
    @Override public void run(){
      long st=System.currentTimeMillis();
      try {
        boolean isRunning=true;
        for (int i=1; i < 10000000 && isRunning; i++) {
          if ((i % 250) == 0) {
            long et=System.currentTimeMillis();
            log(" [" + id + "]["+ new Date()+ "] Total Records Processed: ["+ i+ "] Time taken for [250] records: ["+ (et - st) / 1000 + "] seconds");
            st=System.currentTimeMillis();
          }
          OrientGraph graph=graphFactory.getTx();
          try {
            boolean update=true;
            boolean isException=false;
            Exception tex=null;
            String sql="Update TestNode set prop5='" + String.valueOf(System.currentTimeMillis()) + "', updateTime='"+ new Date().toString()+ "' where property4='value4-1'";
            int k=1;
            for (; k <= 100 && update; k++) {
              try {
                graph.command(new OCommandSQL(sql)).execute();
                if (isException) {
                }
                update=false;
                break;
              }
 catch (              Exception ex) {
                tex=ex;
                if (ex instanceof ODatabaseException || ex instanceof ONeedRetryException || ex instanceof ODistributedException) {
                  if (ex instanceof ONeedRetryException || ex.getCause() instanceof ONeedRetryException) {
                    Thread.sleep(new Random().nextInt(500));
                  }
 else {
                    log("[" + id + "][ Retry: "+ k+ "] Failed to update. OrientDB Exception ["+ ex+ "]");
                  }
                  isException=true;
                }
 else                 log("[" + id + "]["+ k+ "] Failed non OrientDB Exception ["+ ex+ "]");
              }
            }
            if (update) {
              log("*******#################******* [" + id + "][ Retry: "+ k+ "] Failed to update after Exception ["+ ((tex != null) ? tex : "----")+ "]for vertex with property4='value4-1'");
            }
          }
  finally {
            graph.shutdown();
          }
        }
      }
 catch (      Exception ex) {
        System.out.println("ID: [" + id + "]********** Exception "+ ex+ " \n\n");
        ex.printStackTrace();
      }
 finally {
        log("[" + id + "] Done................>>>>>>>>>>>>>>>>>>");
      }
    }
  }
;
  return th;
}
