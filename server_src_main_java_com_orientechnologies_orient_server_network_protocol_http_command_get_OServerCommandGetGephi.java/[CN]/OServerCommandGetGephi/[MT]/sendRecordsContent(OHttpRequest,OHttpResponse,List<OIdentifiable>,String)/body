{
  final StringWriter buffer=new StringWriter();
  final OJSONWriter json=new OJSONWriter(buffer,OHttpResponse.JSON_FORMAT);
  json.setPrettyPrint(true);
  if (iRecords.size() > 0) {
    final ORecord<?> firstRecord=iRecords.get(0).getRecord();
    final OClass vertexBaseClass=firstRecord.getDatabase().getMetadata().getSchema().getClass(OGraphDatabase.VERTEX_CLASS_NAME);
    if (firstRecord instanceof ODocument && ((ODocument)firstRecord).getSchemaClass().isSubClassOf(vertexBaseClass))     generateGraphDbOutput(iRecords,json);
 else     generateDefaultOutput(iRecords,json);
  }
  iResponse.send(OHttpUtils.STATUS_OK_CODE,"OK",OHttpUtils.CONTENT_JSON,buffer.toString(),null);
}
