{
  Boolean merge=iValue instanceof ODocument ? getFieldOfClass(iContext,(ODocument)iValue,"merge",Boolean.class) : Boolean.FALSE;
  if (merge == null)   merge=Boolean.FALSE;
  Object result;
  if (isBlock(iValue)) {
    final ODocument value=(ODocument)iValue;
    result=delegate(iName,iManager,value,iContext,iOutput,iReadOnly);
    if (value.containsField("return"))     return returnValue;
  }
 else {
    try {
      result=iManager.processFromFile(iName,iContext,iReadOnly);
    }
 catch (    Exception e) {
      throw new OProcessException("Error on processing '" + iName + "' field of '"+ getName()+ "' block",e);
    }
  }
  if ("last".equalsIgnoreCase(returnType))   returnValue=result;
 else   if (result != null && ("list".equalsIgnoreCase(returnType) || "set".equalsIgnoreCase(returnType))) {
    if (result instanceof Collection<?> && merge) {
      debug(iContext,"Merging content of collection with size %d with the master with size %d",((Collection<? extends Object>)result).size(),((Collection<? extends Object>)returnValue).size());
      ((Collection<Object>)returnValue).addAll((Collection<? extends Object>)result);
    }
 else     ((Collection<Object>)returnValue).add(result);
  }
  return returnValue;
}
