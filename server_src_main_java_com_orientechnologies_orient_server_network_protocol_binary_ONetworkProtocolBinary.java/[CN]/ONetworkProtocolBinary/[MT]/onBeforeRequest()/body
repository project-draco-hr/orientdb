{
  connection=OClientConnectionManager.instance().getConnection(channel.socket,clientTxId);
  if (clientTxId < 0) {
    short protocolId=0;
    if (connection != null)     protocolId=connection.data.protocolVersion;
    connection=OClientConnectionManager.instance().connect(channel.socket,this);
    if (connection != null)     connection.data.protocolVersion=protocolId;
  }
  if (connection != null) {
    ODatabaseRecordThreadLocal.INSTANCE.set(connection.database);
    ++connection.data.totalRequests;
    setDataCommandInfo("Listening");
    connection.data.commandDetail="-";
    connection.data.lastCommandReceived=System.currentTimeMillis();
  }
 else {
    if (requestType != OChannelBinaryProtocol.REQUEST_DB_CLOSE)     throw new OIOException("Found unknown session " + clientTxId);
  }
  OServerHandlerHelper.invokeHandlerCallbackOnBeforeClientRequest(connection,(byte)requestType);
}
