{
  List<OWALRecord> writtenRecords=new ArrayList<OWALRecord>();
  OWALRecord walRecord=new TestRecord(1024);
  writeAheadLog.logRecord(walRecord);
  writtenRecords.add(walRecord);
  walRecord=new TestRecord(1024);
  writeAheadLog.logRecord(walRecord);
  writtenRecords.add(walRecord);
  walRecord=new TestRecord(OWALPage.PAGE_SIZE - OWALPage.RECORDS_OFFSET - 2048- OWALPage.MIN_RECORD_SIZE + 1);
  writeAheadLog.logRecord(walRecord);
  writtenRecords.add(walRecord);
  walRecord=new TestRecord(1024);
  writeAheadLog.logRecord(walRecord);
  writtenRecords.add(walRecord);
  walRecord=new TestRecord(1024);
  writeAheadLog.logRecord(walRecord);
  writtenRecords.add(walRecord);
  walRecord=new TestRecord(OWALPage.PAGE_SIZE - OWALPage.RECORDS_OFFSET - 2048- OWALPage.MIN_RECORD_SIZE);
  writeAheadLog.logRecord(walRecord);
  writtenRecords.add(walRecord);
  walRecord=new TestRecord(1024);
  writeAheadLog.logRecord(walRecord);
  writtenRecords.add(walRecord);
  walRecord=new TestRecord(1024);
  writeAheadLog.logRecord(walRecord);
  writtenRecords.add(walRecord);
  walRecord=new TestRecord(OWALPage.PAGE_SIZE - OWALPage.RECORDS_OFFSET - 2047- OWALPage.MIN_RECORD_SIZE);
  writeAheadLog.logRecord(walRecord);
  writtenRecords.add(walRecord);
  walRecord=new TestRecord(1024);
  writeAheadLog.logRecord(walRecord);
  writtenRecords.add(walRecord);
  walRecord=new TestRecord(1024);
  writeAheadLog.logRecord(walRecord);
  writtenRecords.add(walRecord);
  walRecord=new TestRecord(OWALPage.PAGE_SIZE - OWALPage.RECORDS_OFFSET - 2047);
  writeAheadLog.logRecord(walRecord);
  writtenRecords.add(walRecord);
  walRecord=new TestRecord(1024);
  writeAheadLog.logRecord(walRecord);
  writtenRecords.add(walRecord);
  assertLogContent(writeAheadLog,writtenRecords);
  writeAheadLog.close();
  writeAheadLog=createWAL();
  assertLogContent(writeAheadLog,writtenRecords);
}
