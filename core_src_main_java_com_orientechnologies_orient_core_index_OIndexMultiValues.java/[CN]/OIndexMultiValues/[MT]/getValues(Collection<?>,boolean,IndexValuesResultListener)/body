{
  checkForRebuild();
  final List<Object> sortedKeys=new ArrayList<Object>(keys);
  final Comparator<Object> comparator;
  if (ascSortOrder)   comparator=ODefaultComparator.INSTANCE;
 else   comparator=Collections.reverseOrder(ODefaultComparator.INSTANCE);
  Collections.sort(sortedKeys,comparator);
  acquireSharedLock();
  try {
    for (    Object key : sortedKeys) {
      key=getCollatingValue(key);
      final Set<OIdentifiable> values=indexEngine.get(key);
      if (values == null)       continue;
      if (!values.isEmpty()) {
        for (        final OIdentifiable value : values) {
          if (!resultListener.addResult(value))           return;
        }
      }
    }
  }
  finally {
    releaseSharedLock();
  }
}
