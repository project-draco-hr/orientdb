{
  if (records.isEmpty())   throw new OCommandExecutionException("Cannot execute the command because it has not been parsed yet");
  final ODatabaseRecord database=getDatabase();
  for (  String rec : records) {
    try {
      final ORecordId rid=new ORecordId(rec);
      database.getStorage().deleteRecord(rid,OVersionFactory.instance().createUntrackedVersion(),0,null);
      database.getLocalCache().deleteRecord(rid);
    }
 catch (    Throwable e) {
      throw new OCommandExecutionException("Error on executing command",e);
    }
  }
  return records.size();
}
