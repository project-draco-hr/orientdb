{
  Object joinValue=((ODocument)input).field(joinFieldName);
  final Object result=lookup(joinValue);
  if (result == null) {
switch (unresolvedLinkAction) {
case NOTHING:
      break;
case ERROR:
    processor.getStats().incrementErrors();
  log("%s: ERROR Cannot resolve join for value '%s'",getName(),joinValue);
break;
case WARNING:
processor.getStats().incrementWarnings();
log("%s: WARN Cannot resolve join for value '%s'",getName(),joinValue);
break;
case SKIP:
return null;
case HALT:
throw new OETLProcessHaltedException("[Merge transformer] Cannot resolve join for value '" + joinValue + "'");
}
}
 else {
((ODocument)result).merge((ODocument)input,true,false);
return result;
}
return input;
}
