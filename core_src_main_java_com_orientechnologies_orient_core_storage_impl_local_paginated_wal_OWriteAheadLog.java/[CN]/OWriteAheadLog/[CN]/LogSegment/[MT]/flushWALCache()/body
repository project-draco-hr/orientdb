{
  if (pages.isEmpty())   return;
  rndFile.seek(lastFlushedPosition);
  for (int i=0; i < pages.size() - 1; i++) {
    final OWALPage page=pages.get(i);
    flushPage(page);
    directMemory.free(page.getPagePointer());
  }
  OWALPage lastPage=pages.get(pages.size() - 1);
  pages.clear();
  lastFlushedPosition=rndFile.getFilePointer();
  flushPage(lastPage);
  if (lastPage.getFreeSpace() > OWALPage.MIN_RECORD_SIZE) {
    pages.add(lastPage);
  }
 else {
    filledUpTo+=lastPage.getFreeSpace();
    directMemory.free(lastPage.getPagePointer());
    lastFlushedPosition=rndFile.getFilePointer();
  }
  rndFile.getFD().sync();
}
