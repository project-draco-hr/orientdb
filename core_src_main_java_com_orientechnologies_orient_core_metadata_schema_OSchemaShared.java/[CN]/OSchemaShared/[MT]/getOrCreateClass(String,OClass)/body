{
  acquireSchemaReadLock();
  try {
    OClass cls=classes.get(className.toLowerCase());
    if (cls != null)     return cls;
  }
  finally {
    releaseSchemaReadLock();
  }
  OClass cls;
  acquireSchemaWriteLock();
  try {
    cls=classes.get(className.toLowerCase());
    if (cls != null)     return cls;
    cls=createClass(className,superClass);
    if (superClass != null && !cls.isSubClassOf(superClass))     throw new IllegalArgumentException("Class '" + className + "' is not an instance of "+ superClass.getShortName());
    addClusterClassMap(cls);
  }
  finally {
    releaseSchemaWriteLock();
  }
  return cls;
}
