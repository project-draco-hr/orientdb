{
  Lock fileLock;
  cacheLock.readLock().lock();
  try {
    fileLock=fileLockManager.acquireExclusiveLock(fileId);
    try {
      if (isOpen(fileId))       truncateFile(fileId);
      writeCache.deleteFile(fileId);
      filePages.remove(fileId);
    }
  finally {
      fileLockManager.releaseLock(fileLock);
    }
  }
  finally {
    cacheLock.readLock().unlock();
  }
}
