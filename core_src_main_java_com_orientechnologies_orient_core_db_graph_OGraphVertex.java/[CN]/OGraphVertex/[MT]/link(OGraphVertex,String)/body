{
  if (iTargetVertex == null)   throw new IllegalArgumentException("Missed the target vertex");
  final OGraphEdge edge=new OGraphEdge(database,iClassName,this,iTargetVertex);
  getOutEdges().add(edge);
  Set<ODocument> recordEdges=((Set<ODocument>)document.field(OGraphDatabase.VERTEX_FIELD_OUT_EDGES));
  if (recordEdges == null) {
    recordEdges=new HashSet<ODocument>();
    document.field(OGraphDatabase.VERTEX_FIELD_OUT_EDGES,recordEdges);
  }
  recordEdges.add(edge.getDocument());
  document.setDirty();
  iTargetVertex.getInEdges().add(edge);
  recordEdges=((Set<ODocument>)iTargetVertex.getDocument().field(OGraphDatabase.VERTEX_FIELD_IN_EDGES));
  if (recordEdges == null) {
    recordEdges=new HashSet<ODocument>();
    iTargetVertex.getDocument().field(OGraphDatabase.VERTEX_FIELD_IN_EDGES,recordEdges);
  }
  recordEdges.add(edge.getDocument());
  iTargetVertex.getDocument().setDirty();
  return edge;
}
