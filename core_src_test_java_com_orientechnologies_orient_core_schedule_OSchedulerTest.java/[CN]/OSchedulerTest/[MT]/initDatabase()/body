{
  final ODatabaseDocumentTx db=new ODatabaseDocumentTx("memory:scheduler");
  db.create();
  db.getMetadata().getSchema().createClass("scheduler_log");
  OFunction func=db.getMetadata().getFunctionLibrary().createFunction("testFunction");
  func.setLanguage("SQL");
  func.setCode("insert into scheduler_log set timestamp = sysdate()");
  func.save();
  db.getMetadata().getScheduler().scheduleEvent(new OScheduledEventBuilder().setName("test").setRule("0/1 * * * * ?").setFunction(func).build());
  return db;
}
