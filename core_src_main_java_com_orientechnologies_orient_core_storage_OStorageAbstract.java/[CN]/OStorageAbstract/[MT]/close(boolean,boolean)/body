{
  lock.acquireExclusiveLock();
  try {
    for (    Object resource : sharedResources.values()) {
      if (resource instanceof OSharedResource)       ((OSharedResource)resource).releaseExclusiveLock();
      if (resource instanceof OCloseable)       ((OCloseable)resource).close(onDelete);
    }
    sharedResources.clear();
  }
  finally {
    lock.releaseExclusiveLock();
  }
}
