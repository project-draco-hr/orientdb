{
  OGlobalConfiguration.DB_POOL_MIN.setValue(1);
  OGlobalConfiguration.DB_POOL_MAX.setValue(MAX_CONNS);
  final Thread thread=new Thread(new Runnable(){
    @Override public void run(){
      ODatabaseDocumentTx db=new ODatabaseDocumentTx(url).open("admin","admin");
      try {
        System.out.println("Start sleeping...");
        db.command(new OCommandScript("SQL","sleep 5000")).execute();
        System.out.println("Sleeping done!");
      }
  finally {
        db.close();
      }
    }
  }
,"Test long sleep");
  thread.start();
  Thread.sleep(1000);
  int commandExecuted=0;
  int iterations=MAX_CONNS * 5;
  for (int i=0; i < iterations; ++i) {
    System.out.println("Open database " + i);
    ODatabaseDocumentTx db=new ODatabaseDocumentTx(url).open("admin","admin");
    try {
      db.command(new OCommandSQL("select from OUser")).execute();
      System.out.println("Command executed " + i);
      commandExecuted++;
    }
  finally {
      db.close();
    }
  }
  System.out.println("Waiting for the sleeping thread...");
  thread.join();
  System.out.println("Done!");
  Assert.assertEquals(commandExecuted,iterations);
}
