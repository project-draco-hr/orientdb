{
  try {
    boolean isStart=iDocument.field(OScheduledEvent.PROP_STARTED) == null ? false : ((Boolean)iDocument.field(OScheduledEvent.PROP_STARTED));
    final String schedulerName=iDocument.field(OScheduledEvent.PROP_NAME);
    OScheduledEvent event=database.getMetadata().getScheduler().getEvent(schedulerName);
    if (isStart) {
      if (event == null) {
        event=new OScheduledEvent(iDocument);
        database.getMetadata().getScheduler().scheduleEvent(event);
      }
      String currentStatus=iDocument.field(OScheduledEvent.PROP_STATUS);
      if (currentStatus.equals(STATUS.STOPPED.name())) {
        iDocument.field(OScheduledEvent.PROP_STATUS,STATUS.WAITING.name());
      }
    }
 else {
      if (event != null) {
        iDocument.field(OScheduledEvent.PROP_STATUS,STATUS.STOPPED.name());
      }
    }
    if (event != null)     event.fromStream(iDocument);
  }
 catch (  Exception ex) {
    OLogManager.instance().error(this,"Error when updating scheduler - " + ex.getMessage());
    return RESULT.RECORD_NOT_CHANGED;
  }
  return RESULT.RECORD_CHANGED;
}
