{
  checkForRebuild();
  key=getCollatingValue(key);
  final OIdentifiable indexedRID=get(key);
  if (indexedRID != null && !indexedRID.getIdentity().equals(record.getIdentity())) {
    final Boolean mergeSameKey=metadata != null && (Boolean)metadata.field(OIndex.MERGE_KEYS);
    if (mergeSameKey != null && mergeSameKey)     return (ODocument)indexedRID.getRecord();
 else     throw new OIndexException("Cannot index record : " + record + " found duplicated key '"+ key+ "' in index "+ getName()+ " previously assigned to the record "+ indexedRID);
  }
  return null;
}
