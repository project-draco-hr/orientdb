{
  Object fieldValue;
  ODocument doc;
  clear();
  acquireExclusiveLock();
  try {
    int documentIndexed=0;
    int documentNum=0;
    final int[] clusterIds=owner.getOwnerClass().getClusterIds();
    final long documentTotal=map.getDatabase().countClusterElements(clusterIds);
    for (    int clusterId : clusterIds)     for (    Object record : map.getDatabase().browseCluster(map.getDatabase().getClusterNameById(clusterId))) {
      if (record instanceof ODocument) {
        doc=(ODocument)record;
        fieldValue=doc.field(owner.getName());
        if (fieldValue != null) {
          put(fieldValue.toString(),(ORecordId)doc.getIdentity());
          ++documentIndexed;
        }
      }
      documentNum++;
      if (iProgressListener != null)       iProgressListener.onProgress(this,documentNum,(int)(documentNum * 100 / documentTotal));
    }
    lazySave();
  }
  finally {
    releaseExclusiveLock();
  }
}
