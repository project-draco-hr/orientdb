{
synchronized (syncObject) {
    if (!files.containsKey(fileId))     return;
    final Set<Long> pageIndexes=filesPages.get(fileId);
    Long[] sortedPageIndexes=new Long[pageIndexes.size()];
    sortedPageIndexes=pageIndexes.toArray(sortedPageIndexes);
    Arrays.sort(sortedPageIndexes);
    for (    Long pageIndex : sortedPageIndexes) {
      LRUEntry lruEntry=get(fileId,pageIndex);
      if (lruEntry != null) {
        if (lruEntry.usageCounter == 0) {
          lruEntry=remove(fileId,pageIndex);
          flushData(fileId,pageIndex,lruEntry.dataPointer);
          directMemory.free(lruEntry.dataPointer);
        }
      }
 else {
        Long dataPointer=evictedPages.remove(new FileLockKey(fileId,pageIndex));
        if (dataPointer != null)         flushData(fileId,pageIndex,dataPointer);
      }
    }
    pageIndexes.clear();
    files.get(fileId).close();
  }
}
