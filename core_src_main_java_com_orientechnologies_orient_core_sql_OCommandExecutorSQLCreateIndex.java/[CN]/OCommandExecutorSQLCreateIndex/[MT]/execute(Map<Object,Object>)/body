{
  if (field == null)   throw new OCommandExecutionException("Can't execute the command because it hasn't been parsed yet");
  OClass cls=database.getMetadata().getSchema().getClass(sourceClassName);
  if (cls == null)   throw new OCommandExecutionException("Class '" + sourceClassName + "' not found");
  OProperty prop=cls.getProperty(field);
  if (prop == null)   throw new IllegalArgumentException("Property '" + field + "' was not found in class '"+ cls+ "'");
  prop.createIndex(indexType.toUpperCase(),progressListener);
  return prop.getIndex().getUnderlying().getSize();
}
