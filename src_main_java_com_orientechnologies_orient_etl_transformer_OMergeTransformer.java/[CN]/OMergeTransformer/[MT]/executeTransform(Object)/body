{
  Object joinValue=((ODocument)input).field(joinFieldName);
  final Object result=lookup(joinValue);
  log(OETLProcessor.LOG_LEVELS.DEBUG,"joinValue=%s, lookupResult=%s",joinValue,result);
  if (result == null) {
switch (unresolvedLinkAction) {
case NOTHING:
      break;
case ERROR:
    processor.getStats().incrementErrors();
  log(OETLProcessor.LOG_LEVELS.ERROR,"%s: ERROR Cannot resolve join for value '%s'",getName(),joinValue);
break;
case WARNING:
processor.getStats().incrementWarnings();
log(OETLProcessor.LOG_LEVELS.INFO,"%s: WARN Cannot resolve join for value '%s'",getName(),joinValue);
break;
case SKIP:
return null;
case HALT:
throw new OETLProcessHaltedException("[Merge transformer] Cannot resolve join for value '" + joinValue + "'");
}
}
 else {
((ODocument)result).merge((ODocument)input,true,false);
log(OETLProcessor.LOG_LEVELS.DEBUG,"merged record %s with found record=%s",result,input);
return result;
}
return input;
}
