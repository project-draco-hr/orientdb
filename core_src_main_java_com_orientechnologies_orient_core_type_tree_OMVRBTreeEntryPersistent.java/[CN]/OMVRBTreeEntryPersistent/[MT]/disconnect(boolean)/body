{
  if (record.isDirty() && !iForceDirty)   return 0;
  if (pTree.cache.remove(record.getIdentity()) == null) {
    System.out.println("CACHE INVALID?");
  }
  int totalDisconnected=1;
  if (this != tree.getRoot()) {
    keys=null;
    values=null;
    serializedKeys=null;
    serializedValues=null;
    pTree=null;
    record=null;
  }
  if (parent != null) {
    if (parent.left == this) {
      parent.left=null;
    }
 else {
      parent.right=null;
    }
    parent=null;
  }
  if (left != null) {
    left.parent=null;
    int disconnected=left.disconnect(iForceDirty);
    if (disconnected > 0) {
      totalDisconnected+=disconnected;
      left=null;
    }
  }
  if (right != null) {
    right.parent=null;
    int disconnected=right.disconnect(iForceDirty);
    if (disconnected > 0) {
      totalDisconnected+=disconnected;
      right=null;
    }
  }
  return totalDisconnected;
}
