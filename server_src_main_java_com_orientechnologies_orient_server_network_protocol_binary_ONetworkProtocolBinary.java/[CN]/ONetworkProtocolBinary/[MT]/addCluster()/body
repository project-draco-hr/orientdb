{
  setDataCommandInfo("Add cluster");
  checkDatabase();
  final String type=channel.readString();
  final String name=channel.readString();
  final int num;
  OStorage.CLUSTER_TYPE t=OStorage.CLUSTER_TYPE.valueOf(type);
switch (t) {
case PHYSICAL:
    num=connection.database.addPhysicalCluster(name,channel.readString(),channel.readInt());
  break;
case MEMORY:
num=connection.database.getStorage().addCluster(name,t);
break;
case LOGICAL:
num=connection.database.addLogicalCluster(name,channel.readInt());
break;
default :
throw new IllegalArgumentException("Cluster type " + type + " is not supported");
}
beginResponse();
try {
sendOk(clientTxId);
channel.writeShort((short)num);
}
  finally {
endResponse();
}
}
