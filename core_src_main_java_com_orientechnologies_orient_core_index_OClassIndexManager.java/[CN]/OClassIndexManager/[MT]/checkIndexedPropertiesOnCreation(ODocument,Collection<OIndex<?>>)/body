{
  ODocument replaced=null;
  for (  final OIndex<?> index : iIndexes) {
    final OIndexDefinition indexDefinition=index.getDefinition();
    final Object key=index.getDefinition().getDocumentValueToIndex(iRecord);
    if (key instanceof Collection) {
      for (      final Object keyItem : (Collection<?>)key) {
        if (!indexDefinition.isNullValuesIgnored() || keyItem != null) {
          final ODocument r=index.checkEntry(iRecord,keyItem);
          if (r != null)           if (replaced == null)           replaced=r;
 else           throw new OIndexException("Cannot merge record from multiple indexes. Use this strategy when you have only one index");
        }
      }
    }
 else {
      if (!indexDefinition.isNullValuesIgnored() || key != null) {
        final ODocument r=index.checkEntry(iRecord,key);
        if (r != null)         if (replaced == null)         replaced=r;
 else         throw new OIndexException("Cannot merge record from multiple indexes. Use this strategy when you have only one index");
      }
    }
  }
  return replaced;
}
