{
  ODatabaseDocumentTx dbServer=poolFactory.get(dbUrl,"admin","admin").acquire();
  ODatabaseRecordThreadLocal.INSTANCE.set(dbServer);
  try {
    List<ODocument> result=dbServer.query(new OSQLSynchQuery<ODocument>("select from Person where id = '" + uniqueId + "'"));
    if (result.size() == 0) {
      if (returnsMissingDocument) {
        return MISSING_DOCUMENT;
      }
      assertTrue("No record found with id = '" + uniqueId + "'!",false);
    }
 else     if (result.size() > 1)     assertTrue(result.size() + " records found with id = '" + uniqueId+ "'!",false);
    return (ODocument)result.get(0).reload();
  }
  finally {
    ODatabaseRecordThreadLocal.INSTANCE.set(null);
  }
}
