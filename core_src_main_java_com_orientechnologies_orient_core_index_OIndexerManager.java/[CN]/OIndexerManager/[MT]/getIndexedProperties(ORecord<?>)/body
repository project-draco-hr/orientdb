{
  if (!(iRecord instanceof ORecordSchemaAware<?>))   return null;
  final ORecordSchemaAware<?> record=(ORecordSchemaAware<?>)iRecord;
  final OClass cls=record.getSchemaClass();
  if (cls == null)   return null;
  OTreeMapDatabase<String,ODocument> index;
  Object fieldValue;
  String fieldValueString;
  final Map<OProperty,String> indexedProperties=new HashMap<OProperty,String>();
  for (  OProperty prop : cls.properties()) {
    index=prop.getIndex();
    if (index != null) {
      fieldValue=record.field(prop.getName());
      if (fieldValue != null) {
        fieldValueString=fieldValue.toString();
        if (index.containsKey(fieldValueString))         OLogManager.instance().exception("Found duplicated key '%s' for property '%s'",null,OIndexException.class,fieldValueString,prop);
        indexedProperties.put(prop,fieldValueString);
      }
    }
  }
  return indexedProperties;
}
