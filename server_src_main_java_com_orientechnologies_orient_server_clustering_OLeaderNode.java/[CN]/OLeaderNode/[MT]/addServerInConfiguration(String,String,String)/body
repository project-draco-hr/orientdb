{
  ODocument dbConfiguration=clusterDbConfigurations.field(iDatabaseName);
  final List<OIdentifiable> nodeList;
  if (dbConfiguration == null) {
    dbConfiguration=new ODocument().addOwner(clusterDbConfigurations);
    nodeList=new ORecordLazyList(dbConfiguration);
    dbConfiguration.field("nodes",nodeList);
    clusterDbConfigurations.field(iDatabaseName,dbConfiguration);
  }
 else {
    nodeList=dbConfiguration.field("nodes");
    for (    OIdentifiable d : nodeList) {
      if (((ODocument)d).field("id").equals(iNodeId))       return (ODocument)d;
    }
  }
  final ODocument node=new ODocument().addOwner(dbConfiguration);
  nodeList.add(node);
  node.field("id",iNodeId);
  node.field("mode",iReplicationMode);
  broadcastClusterConfiguration(iDatabaseName);
  return node;
}
