{
  database.open("admin","admin");
  List<ODocument> result=database.query(new OSQLSynchQuery<ODocument>("select from GraphVehicle"));
  Assert.assertEquals(result.size(),2);
  ODocument edge1=null;
  ODocument edge2=null;
  for (  ODocument v : result) {
    Assert.assertTrue(v.getSchemaClass().isSubClassOf("GraphVehicle"));
    if (v.getClassName().equals("GraphCar")) {
      Assert.assertEquals(database.getOutEdges(v).size(),1);
      edge1=(ODocument)database.getOutEdges(v).iterator().next();
    }
 else {
      Assert.assertEquals(database.getInEdges(v).size(),1);
      edge2=(ODocument)database.getInEdges(v).iterator().next();
    }
  }
  Assert.assertEquals(edge1,edge2);
  database.close();
}
