{
  long memory=getOverflowBufferCount();
  final long allocatedAreas=(getAllocatedBufferCount() + maxPagesPerSingleArea - 1) / maxPagesPerSingleArea;
  if (allocatedAreas < preallocatedAreas.length())   memory+=allocatedAreas * maxPagesPerSingleArea;
 else {
    final long lastAreaPages=preallocatedPages - (allocatedAreas - 1) * maxPagesPerSingleArea;
    memory+=(allocatedAreas - 1) * maxPagesPerSingleArea + lastAreaPages;
  }
  return memory * pageSize;
}
