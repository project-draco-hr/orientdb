{
  if (database.getStorage().isLHClustersAreUsed())   return;
  int clusterId=database.getClusterIdByName("profile");
  final OSQLSynchQuery<ODocument> query=new OSQLSynchQuery<ODocument>("select from Profile where @rid between #" + clusterId + ":2 and #"+ clusterId+ ":30 LIMIT 3");
  ORID last=new ORecordId();
  List<ODocument> resultset=database.query(query);
  Assert.assertEquals(resultset.get(0).getIdentity(),new ORecordId(clusterId,OClusterPositionFactory.INSTANCE.valueOf(2)));
  int iterationCount=0;
  while (!resultset.isEmpty()) {
    Assert.assertTrue(resultset.size() <= 3);
    for (    ODocument d : resultset) {
      Assert.assertTrue(d.getIdentity().getClusterId() >= last.getClusterId() && d.getIdentity().getClusterPosition().compareTo(last.getClusterPosition()) > 0);
    }
    last=resultset.get(resultset.size() - 1).getIdentity();
    iterationCount++;
    resultset=database.query(query);
  }
  Assert.assertEquals(last,new ORecordId(clusterId,OClusterPositionFactory.INSTANCE.valueOf(30)));
  Assert.assertTrue(iterationCount > 1);
}
