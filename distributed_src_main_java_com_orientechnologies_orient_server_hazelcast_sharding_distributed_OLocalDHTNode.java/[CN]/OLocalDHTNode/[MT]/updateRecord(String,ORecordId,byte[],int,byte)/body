{
  final ORecordInternal<?> record=Orient.instance().getRecordFactoryManager().newInstance(iRecordType);
  lockManager.acquireLock(Thread.currentThread(),iRecordId,OLockManager.LOCK.EXCLUSIVE);
  try {
    final ODatabaseDocumentTx database=openDatabase(storageName);
    try {
      record.fill(iRecordId,iVersion,iContent,true);
      if (iRecordId.getClusterId() == -1)       record.save();
 else       record.save(database.getClusterNameById(iRecordId.getClusterId()));
      return record.getVersion();
    }
  finally {
      closeDatabase(database);
    }
  }
  finally {
    lockManager.releaseLock(Thread.currentThread(),iRecordId,OLockManager.LOCK.EXCLUSIVE);
  }
}
