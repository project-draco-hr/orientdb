{
  if (projections != null) {
    final ODocument doc=(ODocument)iRecord.getRecord();
    final ODocument result=new ODocument(database).setOrdered(true);
    boolean canExcludeResult=false;
    Object value;
    for (    Entry<String,Object> projection : projections.entrySet()) {
      if (projection.getValue() instanceof OSQLFilterItemField)       value=((OSQLFilterItemField)projection.getValue()).getValue(doc);
 else       if (projection.getValue() instanceof OSQLFunctionRuntime) {
        final OSQLFunctionRuntime f=(OSQLFunctionRuntime)projection.getValue();
        canExcludeResult=f.filterResult();
        value=f.execute(doc);
      }
 else       value=projection.getValue();
      if (value != null)       result.field(projection.getKey(),value);
    }
    if (canExcludeResult && result.isEmpty())     return;
    if (!anyFunctionAggregates)     request.getResultListener().result(result);
  }
 else   request.getResultListener().result(iRecord);
}
