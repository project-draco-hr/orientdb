{
  if (prevVertex != null && !prevVertex.equals(currentVertex)) {
    String vertexFieldName=direction + "_" + edge.getClassName();
    ODocument prevOutDoc=((OIdentifiable)prevVertex).getRecord();
    ORidBag prevBag=prevOutDoc.field(vertexFieldName);
    if (prevBag != null) {
      prevBag.remove(edge);
    }
    ODocument currentVertexDoc=((OIdentifiable)currentVertex).getRecord();
    ORidBag currentBag=currentVertexDoc.field(vertexFieldName);
    if (currentBag == null) {
      currentBag=new ORidBag();
      currentVertexDoc.field(vertexFieldName,currentBag);
    }
    currentBag.add(edge);
  }
}
