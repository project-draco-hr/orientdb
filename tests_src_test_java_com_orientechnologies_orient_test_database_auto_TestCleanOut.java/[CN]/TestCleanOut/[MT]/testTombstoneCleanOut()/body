{
  if (!OGlobalConfiguration.USE_LHPEPS_MEMORY_CLUSTER.getValueAsBoolean())   return;
  ODocument document=new ODocument("TestCleanOut");
  document.field("prop","propvalue1");
  document.save();
  document=new ODocument("TestCleanOut");
  document.field("prop","propvalue2");
  document.save();
  final OIndex index=db.getMetadata().getIndexManager().getIndex("TestCleanUpIndex");
  Assert.assertEquals(index.getSize(),2);
  Assert.assertTrue(index.contains("propvalue1"));
  Assert.assertTrue(index.contains("propvalue2"));
  document.delete();
  Assert.assertEquals(index.getSize(),1);
  Assert.assertTrue(index.contains("propvalue1"));
  document=db.load(document.getIdentity(),"*:0",false,true);
  db.cleanOutRecord(document.getIdentity(),document.getRecordVersion());
  Assert.assertEquals(index.getSize(),1);
  Assert.assertTrue(index.contains("propvalue1"));
  Assert.assertNull(db.load(document.getIdentity(),"*:0",false,true));
}
