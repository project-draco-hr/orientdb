{
  acquireSharedLock();
  try {
    long size=fileSegment.getFilledUpTo();
    final OClusterEntryIterator it=absoluteIterator();
    while (it.hasNext()) {
      final OPhysicalPosition pos=it.next();
      if (pos.dataSegmentPos > -1 && !pos.recordVersion.isTombstone())       size+=storage.getDataSegmentById(pos.dataSegmentId).getRecordSize(pos.dataSegmentPos);
    }
    return size;
  }
 catch (  IOException e) {
    throw new OIOException("Error on calculating cluster size for: " + getName(),e);
  }
 finally {
    releaseSharedLock();
  }
}
