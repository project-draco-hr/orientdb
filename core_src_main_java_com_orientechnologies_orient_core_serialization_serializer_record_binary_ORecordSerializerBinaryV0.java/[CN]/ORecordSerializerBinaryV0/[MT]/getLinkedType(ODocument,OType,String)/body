{
  if (type != OType.EMBEDDEDLIST && type != OType.EMBEDDEDSET && type != OType.EMBEDDEDMAP)   return null;
  OClass clazz=ODocumentInternal.getImmutableSchemaClass(document);
  if (clazz != null) {
    OProperty prop=clazz.getProperty(key);
    if (prop != null) {
      return prop.getLinkedType();
    }
  }
  return null;
}
