{
  writer=null;
  try {
    writer=new OJSONWriter(new FileWriter(fileName));
    writer.beginObject();
    database.declareIntent(new OIntentMassiveRead());
    exportInfo();
    exportDictionary();
    exportSchema();
    exportClusters();
    database.declareIntent(new OIntentDefault());
    writer.endObject();
    listener.onMessage("\nExport of database completed.");
    writer.flush();
  }
 catch (  Exception e) {
    throw new ODatabaseExportException("Error on exporting database '" + database.getName() + " to: "+ fileName,e);
  }
 finally {
    if (writer != null)     try {
      writer.close();
    }
 catch (    IOException e) {
    }
  }
}
