{
  if (record == null)   return 1;
  int totalDisconnected=0;
  if ((!record.isDirty() || iForceDirty)) {
    if (!pTree.isEntryPoint(this)) {
      if (pTree.cache.remove(record.getIdentity()) == null)       OLogManager.instance().debug(this,"Can't find current node into the cache. Is the cache invalid?");
      totalDisconnected=1;
      clear();
    }
  }
  if (parent != null) {
    if (parent.left == this) {
      parent.left=null;
    }
 else     if (parent.right == this) {
      parent.right=null;
    }
 else     OLogManager.instance().warn(this,"Current node's parent doesn't link it correctly");
    totalDisconnected+=parent.disconnect(iForceDirty,iLevel + 1);
    parent=null;
  }
  if (left != null) {
    if (left.parent == this)     left.parent=null;
 else     OLogManager.instance().warn(this,"Current node's right doesn't link it correctly");
    totalDisconnected+=left.disconnect(iForceDirty,iLevel + 1);
    left=null;
  }
  if (right != null) {
    if (right.parent == this)     right.parent=null;
 else     OLogManager.instance().warn(this,"Current node's left doesn't link it correctly");
    totalDisconnected+=right.disconnect(iForceDirty,iLevel + 1);
    right=null;
  }
  return totalDisconnected;
}
