{
  super(iDatabase,iLowLevelDatabase);
  targetClass=database.getMetadata().getSchema().getClass(iClassName);
  if (targetClass == null)   throw new IllegalArgumentException("Class '" + iClassName + "' was not found in database schema");
  polymorphic=iPolymorphic;
  clusterIds=polymorphic ? targetClass.getPolymorphicClusterIds() : targetClass.getClusterIds();
  currentClusterIdx=0;
  updateClusterRange();
  current.clusterPosition=firstClusterPosition - 1;
  totalAvailableRecords=database.countClusterElements(clusterIds);
  txEntries=iDatabase.getTransaction().getRecordEntriesByClass(iClassName);
  if (txEntries != null)   for (  ORecordOperation entry : txEntries) {
    if (entry.getRecord().getIdentity().isTemporary())     totalAvailableRecords++;
 else     if (entry.type == ORecordOperation.DELETED)     totalAvailableRecords--;
  }
}
