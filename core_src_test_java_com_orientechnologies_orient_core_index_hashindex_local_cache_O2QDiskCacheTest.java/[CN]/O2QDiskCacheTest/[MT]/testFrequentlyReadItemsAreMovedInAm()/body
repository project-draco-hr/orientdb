{
  long fileId=buffer.openFile(fileName);
  long[] pointers;
  pointers=new long[10];
  for (int i=0; i < 10; i++) {
    pointers[i]=buffer.load(fileId,i);
    buffer.markDirty(fileId,i);
    directMemory.set(pointers[i] + systemOffset,new byte[]{(byte)i,1,2,seed,4,5,6,(byte)i},0,8);
    setLsn(pointers[i],new OLogSequenceNumber(1,i));
    buffer.release(fileId,i);
  }
  buffer.clear();
  for (int i=0; i < 10; i++)   assertFile(i,new byte[]{(byte)i,1,2,seed,4,5,6,(byte)i},new OLogSequenceNumber(1,i));
  for (int i=0; i < 8; i++) {
    pointers[i]=buffer.load(fileId,i);
    buffer.release(fileId,i);
  }
  for (int i=2; i < 4; i++) {
    pointers[i]=buffer.load(fileId,i);
    buffer.release(fileId,i);
  }
  LRUList am=buffer.getAm();
  LRUList a1in=buffer.getA1in();
  LRUList a1out=buffer.getA1out();
  Assert.assertEquals(am.size(),2);
  Assert.assertEquals(a1in.size(),2);
  Assert.assertEquals(a1out.size(),2);
  for (int i=2; i < 4; i++) {
    OCacheEntry lruEntry=generateEntry(fileId,i,pointers[i],false,new OLogSequenceNumber(1,i));
    Assert.assertEquals(am.get(fileId,i),lruEntry);
  }
  for (int i=4; i < 6; i++) {
    OCacheEntry lruEntry=generateEntry(fileId,i,ODirectMemory.NULL_POINTER,false,null);
    Assert.assertEquals(a1out.get(fileId,i),lruEntry);
  }
  for (int i=6; i < 8; i++) {
    OCacheEntry lruEntry=generateEntry(fileId,i,pointers[i],false,new OLogSequenceNumber(1,i));
    Assert.assertEquals(a1in.get(fileId,i),lruEntry);
  }
}
