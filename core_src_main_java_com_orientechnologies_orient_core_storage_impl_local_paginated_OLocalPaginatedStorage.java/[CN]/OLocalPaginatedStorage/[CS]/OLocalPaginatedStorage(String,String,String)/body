{
  super(name,filePath,mode);
  File f=new File(url);
  if (f.exists() || !exists(f.getParent())) {
    storagePath=OSystemVariableResolver.resolveSystemVariables(OFileUtils.getPath(new File(url).getPath()));
  }
 else {
    storagePath=OSystemVariableResolver.resolveSystemVariables(OFileUtils.getPath(new File(url).getParent()));
  }
  storagePath=OIOUtils.getPathFromDatabaseName(storagePath);
  variableParser=new OStorageVariableParser(storagePath);
  configuration=new OStorageConfigurationSegment(this);
  DELETE_MAX_RETRIES=OGlobalConfiguration.FILE_MMAP_FORCE_RETRY.getValueAsInteger();
  DELETE_WAIT_TIME=OGlobalConfiguration.FILE_MMAP_FORCE_DELAY.getValueAsInteger();
  final ODirectMemory directMemory=ODirectMemoryFactory.INSTANCE.directMemory();
  diskCache=new O2QCache(OGlobalConfiguration.DISK_CACHE_SIZE.getValueAsLong() * ONE_KB * ONE_KB,directMemory,OGlobalConfiguration.DISK_CACHE_PAGE_SIZE.getValueAsInteger() * ONE_KB,this,false);
  if (OGlobalConfiguration.USE_WAL.getValueAsBoolean())   writeAheadLog=new OWriteAheadLog(this);
 else   writeAheadLog=null;
}
