{
  if (iURL == null || iURL.length() == 0)   throw new IllegalArgumentException("URL missed");
  int pos=iURL.indexOf(':');
  if (pos <= 0)   throw new OConfigurationException("Error in database URL: the engine was not specified. Syntax is: " + URL_SYNTAX + ". URL was: "+ iURL);
  String engineName=iURL.substring(0,pos);
  try {
    acquireExclusiveLock();
    OEngine engine=engines.get(engineName.toLowerCase());
    if (engine == null)     throw new OConfigurationException("Error on opening database: the engine '" + engineName + "' was not found. URL was: "+ iURL);
    iURL=iURL.substring(pos + 1);
    pos=iURL.indexOf('?');
    Map<String,String> parameters=null;
    String dbName=null;
    if (pos > 0) {
      dbName=iURL.substring(0,pos);
      iURL=iURL.substring(pos + 1);
      parameters=new HashMap<String,String>();
      String[] pairs=iURL.split("&");
      String[] kv;
      for (      String pair : pairs) {
        kv=pair.split("=");
        if (kv.length < 2)         throw new OConfigurationException("Error on opening database: the parameter has no value. Syntax is: " + URL_SYNTAX + ". URL was: "+ iURL);
        parameters.put(kv[0],kv[1]);
      }
    }
 else     dbName=iURL;
    final OStorage storage=engine.getStorage(dbName,parameters);
    storages.put(dbName,storage);
    return storage;
  }
  finally {
    releaseExclusiveLock();
  }
}
