{
  final List<ORecordId> uncommittedRecords=new ArrayList<ORecordId>();
  long fileOffset=file.getFilledUpTo();
  while (fileOffset > 0) {
    if (getOperationStatus(fileOffset))     break;
    final OAbstractRemoteTask<?> op=getOperation(fileOffset);
    ODistributedServerLog.info(this,server.getDistributedManager().getLocalNodeId(),null,DIRECTION.NONE,"db '%s' found uncommitted operation %s",storage.getName(),op);
    if (op instanceof OAbstractRecordReplicatedTask<?>)     uncommittedRecords.add(((OAbstractRecordReplicatedTask<?>)op).getRid());
    fileOffset=getPreviousOperation(fileOffset);
  }
  return uncommittedRecords;
}
