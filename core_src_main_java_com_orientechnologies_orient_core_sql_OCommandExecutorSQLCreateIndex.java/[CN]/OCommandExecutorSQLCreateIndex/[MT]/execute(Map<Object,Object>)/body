{
  if (name == null)   throw new OCommandExecutionException("Can't execute the command because it hasn't been parsed yet");
  final OIndex idx;
  if (name.indexOf('.') > -1) {
    final String[] parts=name.split("\\.");
    final String className=parts[0];
    if (className == null)     throw new OCommandExecutionException("Class " + className + " not found");
    String fieldName=parts[1];
    final OClass cls=database.getMetadata().getSchema().getClass(className);
    if (cls == null)     throw new OCommandExecutionException("Class '" + className + "' not found");
    final OPropertyImpl prop=(OPropertyImpl)cls.getProperty(fieldName);
    if (prop == null)     throw new IllegalArgumentException("Property '" + fieldName + "' was not found in class '"+ cls+ "'");
    idx=prop.createIndexInternal(indexType.toUpperCase(),progressListener).getUnderlying();
  }
 else {
    idx=database.getMetadata().getIndexManager().createIndex(name,indexType.toUpperCase(),keyType,null,null,null,false);
  }
  if (idx != null)   return idx.getSize();
  return null;
}
