{
synchronized (syncObject) {
    if (writeAheadLog == null)     return Collections.emptySet();
    Set<ODirtyPage> logDirtyPages=new HashSet<ODirtyPage>(dirtyPages.size());
    for (    long fileId : dirtyPages.keySet()) {
      SortedMap<Long,OLogSequenceNumber> pages=dirtyPages.get(fileId);
      for (      Map.Entry<Long,OLogSequenceNumber> pageEntry : pages.entrySet()) {
        final ODirtyPage logDirtyPage=new ODirtyPage(files.get(fileId).getName(),pageEntry.getKey(),pageEntry.getValue());
        logDirtyPages.add(logDirtyPage);
      }
    }
    writeAheadLog.logDirtyPages(logDirtyPages);
    return logDirtyPages;
  }
}
