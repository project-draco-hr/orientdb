{
  if (getDatabase().getTransaction().isActive())   throw new IllegalStateException("Cannot drop a class inside a transaction");
  if (iClassName == null)   throw new IllegalArgumentException("Class name is null");
  getDatabase().checkSecurity(ODatabaseSecurityResources.SCHEMA,ORole.PERMISSION_DELETE);
  final String key=iClassName.toLowerCase();
  final OClass cls;
  rwLock.readLock().lock();
  try {
    cls=classes.get(key);
  }
  finally {
    rwLock.readLock().unlock();
  }
  if (cls == null)   throw new OSchemaException("Class " + iClassName + " was not found in current database");
  if (!cls.getBaseClasses().isEmpty())   throw new OSchemaException("Class " + iClassName + " cannot be dropped because it has sub classes. Remove the dependencies before trying to drop it again");
  StringBuilder cmd=new StringBuilder("drop class ");
  cmd.append(iClassName);
  Object result=getDatabase().command(new OCommandSQL(cmd.toString())).execute();
  rwLock.writeLock().lock();
  try {
    if (result instanceof Boolean && (Boolean)result) {
      classes.remove(key);
    }
    getDatabase().reload();
    reload();
    removeClusterClassMap(cls);
  }
  finally {
    rwLock.writeLock().unlock();
  }
}
