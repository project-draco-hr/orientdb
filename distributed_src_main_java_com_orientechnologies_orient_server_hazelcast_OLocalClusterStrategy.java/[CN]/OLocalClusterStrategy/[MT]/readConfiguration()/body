{
  if (cls.isAbstract())   throw new IllegalArgumentException("Cannot create a new instance of abstract class");
  final ODatabaseRecord db=ODatabaseRecordThreadLocal.INSTANCE.get();
  final int[] clusterIds=cls.getClusterIds();
  final List<String> clusterNames=new ArrayList<String>(clusterIds.length);
  for (  int c : clusterIds)   clusterNames.add(db.getClusterNameById(c));
  ODistributedConfiguration cfg=manager.getDatabaseConfiguration(databaseName);
  final String bestCluster=cfg.getLocalCluster(clusterNames,nodeName);
  bestClusterId=db.getClusterIdByName(bestCluster);
}
