{
  for (  List<OWALRecord> operationUnit : operationUnits.values()) {
    if (operationUnit.isEmpty())     continue;
    final OOperationUnitRecord operationUnitRecord=(OOperationUnitRecord)operationUnit.get(0);
    final OAtomicUnitEndRecord atomicUnitEndRecord=new OAtomicUnitEndRecord(operationUnitRecord.getOperationUnitId(),true);
    writeAheadLog.log(atomicUnitEndRecord);
    operationUnit.add(atomicUnitEndRecord);
    undoOperation(operationUnit);
  }
}
