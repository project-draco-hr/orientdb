{
  if (empty.compareAndSet(true,false))   try {
    sendOk(txId);
  }
 catch (  IOException e1) {
  }
  try {
    channel.writeByte((byte)1);
    writeIdentifiable((ORecordInternal<?>)((OIdentifiable)iRecord).getRecord());
    if (fetchPlan != null && iRecord instanceof ODocument) {
      final ODocument doc=(ODocument)iRecord;
      final OFetchListener listener=new ORemoteFetchListener(recordsToSend);
      final OFetchContext context=new ORemoteFetchContext();
      OFetchHelper.fetch(doc,iRecord,fetchPlan,listener,context);
    }
  }
 catch (  IOException e) {
    return false;
  }
  return true;
}
