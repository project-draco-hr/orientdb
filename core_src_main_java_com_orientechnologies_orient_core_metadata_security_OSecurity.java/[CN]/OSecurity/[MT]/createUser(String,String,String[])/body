{
  String key=iUserName.toLowerCase();
  if (users.containsKey(key))   throw new OSecurityException("User " + iUserName + " already exists in current database");
  OUser user=new OUser(database,iUserName);
  users.put(iUserName.toLowerCase(),user);
  user.setDatabase(database);
  user.setPassword(iUserPassword);
  if (iRoles != null)   for (  String r : iRoles) {
    user.addRole(r);
  }
  return user.save();
}
