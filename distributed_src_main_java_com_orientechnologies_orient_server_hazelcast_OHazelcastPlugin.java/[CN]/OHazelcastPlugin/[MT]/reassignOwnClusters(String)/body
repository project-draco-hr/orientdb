{
  for (  String databaseName : getManagedDatabases()) {
    ODistributedConfiguration cfg=getDatabaseConfiguration(databaseName);
    if (!isLocalNodeTheCoordinator(cfg))     continue;
    final Set<String> clustersWithNotAvailableOwner=cfg.getClustersOwnedByServer(nodeLeftName);
    if (!clustersWithNotAvailableOwner.isEmpty()) {
      final ODatabaseDocumentTx database=(ODatabaseDocumentTx)serverInstance.openDatabase(databaseName,"internal","internal",null,true);
      try {
        final boolean distribCfgDirty=rebalanceClusterOwnership(database,cfg,clustersWithNotAvailableOwner,false);
        if (distribCfgDirty) {
          OLogManager.instance().info(this,"Distributed configuration modified");
          updateCachedDatabaseConfiguration(databaseName,cfg.serialize(),true,true);
        }
      }
  finally {
        database.close();
      }
    }
  }
}
