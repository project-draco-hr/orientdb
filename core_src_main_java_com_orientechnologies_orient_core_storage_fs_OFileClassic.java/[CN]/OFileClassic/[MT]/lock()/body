{
  if (channel == null)   return;
  acquireWriteLock();
  try {
    for (int i=0; i < LOCK_MAX_RETRIES; ++i) {
      try {
        fileLock=channel.tryLock();
        if (fileLock != null)         break;
      }
 catch (      OverlappingFileLockException e) {
        OLogManager.instance().debug(this,"Cannot open file '" + osFile.getAbsolutePath() + "' because it is locked. Waiting %d ms and retrying %d/%d...",LOCK_WAIT_TIME,i,LOCK_MAX_RETRIES);
      }
      if (fileLock == null)       throw new OFileLockedByAnotherProcessException("File '" + osFile.getPath() + "' is locked by another process, maybe the database is in use by another process. Use the remote mode with a OrientDB server to allow multiple access to the same database");
    }
  }
  finally {
    releaseWriteLock();
  }
}
