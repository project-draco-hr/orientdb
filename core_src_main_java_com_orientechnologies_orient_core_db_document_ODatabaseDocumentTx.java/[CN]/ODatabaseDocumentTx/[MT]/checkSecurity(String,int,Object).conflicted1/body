{
  checkOpeness();
  if (user != null) {
    try {
      final StringBuilder keyBuffer=new StringBuilder(256);
      boolean ruleFound=false;
      if (iResourceSpecific != null) {
        keyBuffer.setLength(0);
        keyBuffer.append(iResourceGeneric);
        keyBuffer.append('.');
        keyBuffer.append(iResourceSpecific.toString());
        final String key=keyBuffer.toString();
        if (user.isRuleDefined(key)) {
          ruleFound=true;
          user.allow(key,iOperation);
        }
      }
      if (!ruleFound) {
        keyBuffer.setLength(0);
        keyBuffer.append(iResourceGeneric);
        keyBuffer.append('.');
        keyBuffer.append(ODatabaseSecurityResources.ALL);
        user.allow(keyBuffer.toString(),iOperation);
      }
    }
 catch (    OSecurityAccessException e) {
      if (OLogManager.instance().isDebugEnabled())       OLogManager.instance().debug(this,"[checkSecurity] User '%s' tried to access to the reserved resource '%s', target '%s', operation '%s'",getUser(),iResourceGeneric,iResourceSpecific,iOperation);
      throw e;
    }
  }
  return (DB)this;
}
