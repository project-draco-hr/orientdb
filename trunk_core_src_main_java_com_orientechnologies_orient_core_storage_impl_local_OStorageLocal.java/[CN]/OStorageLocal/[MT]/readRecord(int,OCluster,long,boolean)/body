{
  if (iPosition < 0)   throw new IllegalArgumentException("Can't read the record because the position #" + iPosition + " is invalid");
  final long timer=OProfiler.getInstance().startChrono();
  final boolean locked=iAtomicLock ? acquireSharedLock() : false;
  try {
    final OPhysicalPosition ppos=iClusterSegment.getPhysicalPosition(iPosition,new OPhysicalPosition());
    if (ppos == null || !checkForRecordValidity(ppos))     return null;
    final ODataLocal data=getDataSegment(ppos.dataSegment);
    return new Object[]{data.getRecord(ppos.dataPosition),ppos.version};
  }
 catch (  IOException e) {
    OLogManager.instance().error(this,"Error on reading record #" + iPosition + " in cluster: "+ iClusterSegment,e);
    return null;
  }
 finally {
    releaseSharedLock(locked);
    OProfiler.getInstance().stopChrono("OStorageLocal.readRecord",timer);
  }
}
