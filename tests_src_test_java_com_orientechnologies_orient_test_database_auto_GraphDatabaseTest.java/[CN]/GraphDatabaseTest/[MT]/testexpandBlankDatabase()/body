{
  String iUrl=url;
  iUrl.replace("\\","/");
  if (iUrl.endsWith("/"))   iUrl=iUrl.substring(0,iUrl.length() - 1);
  if (iUrl.contains("/")) {
    iUrl=iUrl.substring(0,iUrl.lastIndexOf("/") + 1) + "expandTest";
  }
 else {
    iUrl=iUrl.substring(0,iUrl.indexOf(":") + 1) + "expandTest";
  }
  ODatabaseDocument db=new ODatabaseDocumentTx(iUrl);
  ODatabaseHelper.createDatabase(db,iUrl,"plocal");
  db.close();
  OGraphDatabase database=new OGraphDatabase(iUrl);
  database.open("admin","admin");
  ODocument playerDoc=database.createVertex().field("surname","Torres").save();
  ODocument teamDoc=database.createVertex().field("team","Chelsea").save();
  database.createEdge(playerDoc,teamDoc).field("label","player").save();
  String query="select expand(out_[label='player'].in) from V where surname = 'Torres'";
  List<OIdentifiable> result=database.query(new OSQLSynchQuery<ODocument>(query));
  for (int i=0; i < result.size(); i++) {
    Assert.assertTrue(((ODocument)result.get(i).getRecord()).containsField("team"));
    Assert.assertTrue(((ODocument)result.get(i).getRecord()).field("team").equals("Chelsea"));
  }
  database.removeVertex(playerDoc);
  database.removeVertex(teamDoc);
  database.close();
  ODatabaseHelper.deleteDatabase(database,"plocal");
}
