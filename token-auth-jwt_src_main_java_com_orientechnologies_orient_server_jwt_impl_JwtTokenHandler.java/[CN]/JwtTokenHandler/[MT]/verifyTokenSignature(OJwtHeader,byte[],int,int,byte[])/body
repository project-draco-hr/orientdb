{
  Mac mac=threadLocalMac.get();
  try {
    mac.init(getKeyProvider().getKey(header));
    mac.update(base,baseOffset,baseLength);
    byte[] calculatedSignature=mac.doFinal();
    return Arrays.equals(calculatedSignature,signature);
  }
 catch (  RuntimeException e) {
    throw e;
  }
catch (  Exception e) {
    throw new OException(e);
  }
 finally {
    mac.reset();
  }
}
