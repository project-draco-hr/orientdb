{
  document.setInternalStatus(ORecordElement.STATUS.UNMARSHALLING);
  try {
    document.field("name",name);
    if (shortName != null)     document.field("shortName",shortName);
    document.field("defaultClusterId",defaultClusterId);
    document.field("clusterIds",clusterIds);
    if (overSize > 0)     document.field("overSize",overSize);
    if (strictMode)     document.field("strictMode",strictMode);
    if (abstractClass)     document.field("abstract",abstractClass);
    if (properties != null) {
      final Set<ODocument> props=new HashSet<ODocument>();
      for (      final OProperty p : properties.values()) {
        props.add(((OPropertyImpl)p).toStream());
      }
      document.field("properties",props,OType.EMBEDDEDSET);
    }
    document.field("superClass",superClass != null ? superClass.getName() : null);
    document.field("customFields",customFields != null && customFields.size() > 0 ? customFields : null,OType.EMBEDDEDMAP);
  }
  finally {
    document.setInternalStatus(ORecordElement.STATUS.LOADED);
  }
  return document;
}
