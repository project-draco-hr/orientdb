{
  final ODocument result=new ODocument();
  for (  Entry<String,OTransactionIndexChanges> indexEntry : indexEntries.entrySet()) {
    final ODocument indexDoc=new ODocument().addOwner(result);
    result.field(indexEntry.getKey(),indexDoc,OType.EMBEDDED);
    if (indexEntry.getValue().cleared)     indexDoc.field("clear",Boolean.TRUE);
    final List<ODocument> entries=new ArrayList<ODocument>();
    indexDoc.field("entries",entries,OType.EMBEDDEDLIST);
    if (indexEntry.getValue().changesCrossKey != null)     serializeIndexChangeEntry(indexEntry.getValue().changesCrossKey,indexDoc,entries);
    for (    OTransactionIndexChangesPerKey entry : indexEntry.getValue().changesPerKey.values())     serializeIndexChangeEntry(entry,indexDoc,entries);
  }
  indexEntries.clear();
  return result;
}
