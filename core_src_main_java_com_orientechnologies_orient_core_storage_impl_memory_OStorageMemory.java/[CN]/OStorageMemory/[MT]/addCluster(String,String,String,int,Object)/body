{
  lock.acquireExclusiveLock();
  try {
    int clusterId=clusters.size();
    for (int i=0; i < clusters.size(); ++i) {
      if (clusters.get(i) == null) {
        clusterId=i;
        break;
      }
    }
    final OClusterMemory cluster=new OClusterMemory();
    cluster.configure(this,clusterId,iClusterName.toLowerCase(),iLocation,iDataSegmentId,iParameters);
    if (clusterId == clusters.size())     clusters.add(cluster);
 else     clusters.set(clusterId,cluster);
    return clusterId;
  }
  finally {
    lock.releaseExclusiveLock();
  }
}
