{
  int entryPosition=OIntegerSerializer.INSTANCE.deserializeFromDirectMemory(bufferPointer,POSITIONS_ARRAY_OFFSET + index * OIntegerSerializer.INT_SIZE);
  entryPosition+=OLongSerializer.LONG_SIZE;
  entryPosition+=keySerializer.getObjectSizeInDirectMemory(bufferPointer,entryPosition);
  final int newSize=valueSerializer.getObjectSize(value);
  final int oldSize=valueSerializer.getObjectSizeInDirectMemory(bufferPointer,entryPosition);
  if (newSize != oldSize)   return -1;
  byte[] newSerializedValue=new byte[newSize];
  valueSerializer.serializeNative(value,newSerializedValue,0);
  byte[] oldSerializedValue=bufferPointer.get(entryPosition,oldSize);
  if (ODefaultComparator.INSTANCE.compare(oldSerializedValue,newSerializedValue) == 0)   return 0;
  bufferPointer.set(entryPosition,newSerializedValue,0,newSerializedValue.length);
  return 1;
}
