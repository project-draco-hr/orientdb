{
  listener.onMessage("\nExporting clusters...");
  writer.beginCollection(1,true,"clusters");
  int exportedClusters=0;
  int maxClusterId=getMaxClusterId();
  for (int clusterId=0; clusterId <= maxClusterId; ++clusterId) {
    final String clusterName=database.getClusterNameById(clusterId);
    if (clusterName != null) {
      if (includeClusters != null) {
        if (!includeClusters.contains(clusterName.toUpperCase()))         continue;
      }
 else       if (excludeClusters != null) {
        if (excludeClusters.contains(clusterName.toUpperCase()))         continue;
      }
    }
 else     if (includeClusters != null && !includeClusters.isEmpty())     continue;
    writer.beginObject(2,true,null);
    writer.writeAttribute(0,false,"name",clusterName != null ? clusterName : "");
    writer.writeAttribute(0,false,"id",clusterId);
    writer.writeAttribute(0,false,"type",clusterName != null ? database.getClusterType(clusterName) : "");
    exportedClusters++;
    writer.endObject(2,false);
  }
  listener.onMessage("OK (" + exportedClusters + " clusters)");
  writer.endCollection(1,true);
}
