{
  OStorage storage=database.getStorage();
  OIndexEngine indexEngine;
  if (storage instanceof OStorageMemory)   indexEngine=new OMemoryHashMapIndexEngine();
 else   if (storage instanceof OStorageLocalAbstract) {
    indexEngine=new OLocalHashTableIndexEngine();
  }
 else {
    throw new OIndexException("Unsupported storage type : " + storage.getType());
  }
  if (OClass.INDEX_TYPE.UNIQUE_HASH_INDEX.toString().equals(indexType)) {
    return new OIndexUnique(indexType,indexEngine);
  }
 else   if (OClass.INDEX_TYPE.NOTUNIQUE_HASH_INDEX.toString().equals(indexType)) {
    return new OIndexNotUnique(indexType,indexEngine);
  }
 else   if (OClass.INDEX_TYPE.FULLTEXT_HASH_INDEX.toString().equals(indexType)) {
    return new OIndexFullText(indexType,indexEngine);
  }
 else   if (OClass.INDEX_TYPE.DICTIONARY_HASH_INDEX.toString().equals(indexType)) {
    return new OIndexDictionary(indexType,indexEngine);
  }
  throw new OConfigurationException("Unsupported type : " + indexType);
}
