{
  NavigableMap<GroupKey,OWriteGroup> subMap=writeGroups.tailMap(lastGroupKey,false);
  if (!subMap.isEmpty()) {
    flushedGroups=iterateBySubRing(subMap,writeGroupsToFlush,0,forceFlush);
    if (flushedGroups < writeGroupsToFlush) {
      subMap=writeGroups.headMap(subMap.firstKey(),false);
      flushedGroups=iterateBySubRing(subMap,writeGroupsToFlush,flushedGroups,forceFlush);
    }
  }
 else   flushedGroups=iterateBySubRing(writeGroups,writeGroupsToFlush,flushedGroups,forceFlush);
  return flushedGroups;
}
