{
  final int intId=extractFileId(fileId);
  filesLock.acquireReadLock();
  try {
    return files.get(intId).getFileSize() / pageSize;
  }
  finally {
    filesLock.releaseReadLock();
  }
}
