{
  try {
    final List<ORecordOperation> newEntries;
    if (getTransaction().getCurrentRecordEntries() != null) {
      newEntries=new ArrayList<ORecordOperation>();
      for (      ORecordOperation entry : getTransaction().getCurrentRecordEntries())       if (entry.type == ORecordOperation.CREATED)       newEntries.add(entry);
    }
 else     newEntries=null;
    ((ODatabaseRecordTx)underlying.getUnderlying()).rollback();
    if (getTransaction().getCurrentRecordEntries() != null)     for (    ORecordOperation recordEntry : getTransaction().getCurrentRecordEntries()) {
      rid2Records.remove(recordEntry.getRecord().getIdentity());
    }
    if (getTransaction().getAllRecordEntries() != null)     for (    ORecordOperation recordEntry : getTransaction().getAllRecordEntries()) {
      rid2Records.remove(recordEntry.getRecord().getIdentity());
    }
  }
  finally {
    getTransaction().close();
  }
  return this;
}
