{
  Exception lastException=null;
  for (int retry=0; retry < 2; ++retry) {
    OChannelBinaryAsynchClient network=null;
    try {
      storage.pushSessionId(getURL(),sessionId,sessionToken,connections);
      network=storage.getAvailableNetwork(getURL());
      if (!storage.getServerURL().contains(network.getServerURL())) {
        storage.setSessionId(network.getServerURL(),-1,null);
        storage.openRemoteDatabase(network);
        if (!network.tryLock())         throw new OStorageException(errorMessage);
      }
      return operation.execute(network);
    }
 catch (    IOException e) {
      network.close();
      lastException=e;
    }
catch (    Exception e) {
      if (network != null)       network.close();
      storage.close(true,false);
      lastException=e;
      break;
    }
  }
  throw OException.wrapException(new OStorageException(errorMessage),lastException);
}
