{
  if (configuration.getContextConfiguration().getValueAsBoolean(OGlobalConfiguration.USE_WAL)) {
    checkpointExecutor=Executors.newSingleThreadExecutor(new FullCheckpointThreadFactory());
    writeAheadLog=new ODiskWriteAheadLog(this);
    writeAheadLog.addFullCheckpointListener(this);
  }
 else   writeAheadLog=null;
  long diskCacheSize=OGlobalConfiguration.DISK_CACHE_SIZE.getValueAsLong() * 1024 * 1024;
  long writeCacheSize=(long)Math.floor((((double)OGlobalConfiguration.DISK_WRITE_CACHE_PART.getValueAsInteger()) / 100.0) * diskCacheSize);
  long readCacheSize=diskCacheSize - writeCacheSize;
  diskCache=new OReadWriteDiskCache(name,readCacheSize,writeCacheSize,OGlobalConfiguration.DISK_CACHE_PAGE_SIZE.getValueAsInteger() * ONE_KB,OGlobalConfiguration.DISK_WRITE_CACHE_PAGE_TTL.getValueAsLong() * 1000,OGlobalConfiguration.DISK_WRITE_CACHE_PAGE_FLUSH_INTERVAL.getValueAsInteger(),this,writeAheadLog,false,true);
  diskCache.addLowDiskSpaceListener(this);
}
