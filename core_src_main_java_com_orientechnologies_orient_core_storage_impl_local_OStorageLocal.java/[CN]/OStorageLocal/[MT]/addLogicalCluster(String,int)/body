{
  lock.acquireExclusiveLock();
  try {
    final OStorageLogicalClusterConfiguration config=new OStorageLogicalClusterConfiguration(iClusterName,clusters.length,iPhysicalCluster,null);
    configuration.clusters.add(config);
    final OClusterLogical cluster=new OClusterLogical(this,clusters.length,iClusterName,iPhysicalCluster);
    config.map=cluster.getRID();
    final int id=registerCluster(cluster);
    configuration.update();
    return id;
  }
  finally {
    lock.releaseExclusiveLock();
  }
}
