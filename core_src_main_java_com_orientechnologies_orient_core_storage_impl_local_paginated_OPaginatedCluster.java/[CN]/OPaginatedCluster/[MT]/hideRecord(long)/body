{
  externalModificationLock.requestModificationLock();
  try {
    acquireExclusiveLock();
    try {
      OClusterPositionMapBucket.PositionEntry positionEntry=clusterPositionMap.get(position);
      if (positionEntry == null)       return false;
      long pageIndex=positionEntry.getPageIndex();
      OAtomicOperation atomicOperation=storage.getAtomicOperationsManager().getCurrentOperation();
      if (getFilledUpTo(atomicOperation,diskCache,fileId) <= pageIndex)       return false;
      startAtomicOperation();
      try {
        lockTillAtomicOperationCompletes();
        updateClusterState(-1,0);
        clusterPositionMap.remove(position);
        endAtomicOperation(false);
        return true;
      }
 catch (      Throwable e) {
        endAtomicOperation(true);
        throw new OStorageException(null,e);
      }
    }
  finally {
      releaseExclusiveLock();
    }
  }
  finally {
    externalModificationLock.releaseModificationLock();
  }
}
