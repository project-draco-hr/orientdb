{
  if (iVertex == null)   return;
  final Object fieldValue=iVertexToRemove != null ? iVertex.field(iFieldName) : iVertex.removeField(iFieldName);
  if (fieldValue == null)   return;
  if (fieldValue instanceof OIdentifiable) {
    if (iVertexToRemove != null) {
      if (!fieldValue.equals(iVertexToRemove)) {
        return;
      }
      iVertex.field(iFieldName,iNewVertex);
    }
  }
 else   if (fieldValue instanceof ORidBag) {
    final ORidBag bag=(ORidBag)fieldValue;
    if (bag.remove(iVertexToRemove))     bag.add(iNewVertex);
  }
 else   if (fieldValue instanceof Collection) {
    final Collection col=(Collection)fieldValue;
    if (col.remove(iVertexToRemove))     col.add(iNewVertex);
  }
  iVertex.save();
}
