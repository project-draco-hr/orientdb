{
  Query query=null;
  if (key instanceof String) {
    BooleanQuery booleanQ=new BooleanQuery();
    if (index.getFields().size() > 0) {
      for (      String idx : index.getFields()) {
        booleanQ.add(new TermQuery(new Term(idx,key.toString())),BooleanClause.Occur.SHOULD);
      }
    }
 else {
      booleanQ.add(new TermQuery(new Term(OLuceneIndexManagerAbstract.KEY,key.toString())),BooleanClause.Occur.SHOULD);
    }
    query=booleanQ;
  }
 else   if (key instanceof Number) {
    String idx=index.getFields().iterator().next();
    Number number=(Number)key;
    if (key instanceof Long) {
      query=NumericRangeQuery.newLongRange(idx,number.longValue(),number.longValue(),true,true);
    }
 else     if (key instanceof Float) {
      query=NumericRangeQuery.newFloatRange(idx,number.floatValue(),number.floatValue(),true,true);
    }
 else     if (key instanceof Double) {
      query=NumericRangeQuery.newDoubleRange(idx,number.doubleValue(),number.doubleValue(),true,true);
    }
 else {
      query=NumericRangeQuery.newIntRange(idx,number.intValue(),number.intValue(),true,true);
    }
  }
 else   if (key instanceof Date) {
    String idx=index.getFields().iterator().next();
    query=NumericRangeQuery.newLongRange(idx,((Date)key).getTime(),((Date)key).getTime(),true,true);
  }
  return query;
}
