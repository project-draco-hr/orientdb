{
  final String executorNode=response.getExecutorNodeName();
  if (!responses.containsKey(executorNode)) {
    ODistributedServerLog.warn(this,response.getSenderNodeName(),executorNode,DIRECTION.IN,"received response for message %d from unexpected node. Expected are: %s",messageId,getExpectedNodes());
    Orient.instance().getProfiler().updateCounter("distributed.replication.unexpectedNodeResponse","Number of responses from unexpected nodes",+1);
    return false;
  }
  Orient.instance().getProfiler().stopChrono("distributed.replication.responseTime","Response time from replication messages",sentOn,"distributed.replication.responseTime");
  Orient.instance().getProfiler().stopChrono("distributed.replication." + executorNode + ".responseTime","Response time from replication messages",sentOn,"distributed.replication.*.responseTime");
  if (firstResponse == null)   firstResponse=response;
  responses.put(executorNode,response);
  receivedResponses++;
  if (waitForLocalNode && response.isExecutedOnLocalNode())   receivedCurrentNode=true;
  return getExpectedResponses() == receivedResponses;
}
