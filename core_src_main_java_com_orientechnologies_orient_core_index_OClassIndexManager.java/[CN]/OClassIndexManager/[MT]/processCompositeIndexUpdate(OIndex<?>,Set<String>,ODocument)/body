{
  final OIndexDefinition indexDefinition=index.getDefinition();
  final List<String> indexFields=indexDefinition.getFields();
  for (  final String indexField : indexFields) {
    if (dirtyFields.contains(indexField)) {
      final List<Object> origValues=new ArrayList<Object>(indexFields.size());
      for (      final String field : indexFields) {
        if (dirtyFields.contains(field)) {
          origValues.add(iRecord.getOriginalValue(field));
        }
 else {
          origValues.add(iRecord.<Object>field(field));
        }
      }
      final Object origValue=indexDefinition.createValue(origValues);
      final Object newValue=indexDefinition.getDocumentValueToIndex(iRecord);
      if (origValue != null) {
        index.remove(origValue,iRecord);
      }
      if (newValue != null) {
        index.put(newValue,iRecord.placeholder());
      }
      return;
    }
  }
}
