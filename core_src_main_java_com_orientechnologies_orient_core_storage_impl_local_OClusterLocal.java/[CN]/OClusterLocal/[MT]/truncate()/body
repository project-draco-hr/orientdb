{
  storage.checkForClusterPermissions(getName());
  acquireExclusiveLock();
  try {
    final OClusterPosition begin=getFirstIdentity();
    if (begin.isPersistent()) {
      final OClusterPosition end=getLastIdentity();
      final OPhysicalPosition ppos=new OPhysicalPosition();
      for (ppos.clusterPosition=begin; ppos.clusterPosition.compareTo(end) <= 0; ppos.clusterPosition=ppos.clusterPosition.inc()) {
        getPhysicalPosition(ppos);
        if (storage.checkForRecordValidity(ppos))         storage.getDataSegmentById(ppos.dataSegmentId).deleteRecord(ppos.dataSegmentPos);
      }
    }
    fileSegment.truncate();
    holeSegment.truncate();
  }
  finally {
    releaseExclusiveLock();
  }
}
