{
  clearLock.readLock().lock();
  try {
    OCacheEntry cacheEntry;
    long index=-1;
    do {
      Long lastIndex=content.lastKey();
      if (lastIndex == null)       index=0;
 else       index=lastIndex + 1;
      final ODirectMemoryPointer directMemoryPointer=new ODirectMemoryPointer(pageSize);
      final OCachePointer cachePointer=new OCachePointer(directMemoryPointer,new OLogSequenceNumber(0,0));
      cachePointer.incrementReferrer();
      cacheEntry=new OCacheEntry(id,index,cachePointer,false);
      OCacheEntry oldCacheEntry=content.putIfAbsent(index,cacheEntry);
      if (oldCacheEntry != null) {
        cacheEntry.getCachePointer().decrementReferrer();
        index=-1;
      }
    }
 while (index < 0);
    return cacheEntry;
  }
  finally {
    clearLock.readLock().unlock();
  }
}
