{
  if (!isRelatedToLocalServer(iDatabase))   return;
  final ODatabaseDocumentInternal currDb=ODatabaseRecordThreadLocal.INSTANCE.getIfDefined();
  try {
    if (configurationMap.containsKey(OHazelcastPlugin.CONFIG_DATABASE_PREFIX + iDatabase.getName()))     throw new ODistributedException("Cannot create a new database with the same name of one available distributed");
    final ODistributedConfiguration cfg=getDatabaseConfiguration(iDatabase.getName());
    cfg.addNewNodeInServerList(nodeName);
    updateCachedDatabaseConfiguration(iDatabase.getName(),cfg.serialize(),true,true);
    final ODistributedDatabaseImpl distribDatabase=messageService.registerDatabase(iDatabase.getName());
    distribDatabase.setOnline();
    onOpen(iDatabase);
  }
  finally {
    ODatabaseRecordThreadLocal.INSTANCE.set(currDb);
  }
}
