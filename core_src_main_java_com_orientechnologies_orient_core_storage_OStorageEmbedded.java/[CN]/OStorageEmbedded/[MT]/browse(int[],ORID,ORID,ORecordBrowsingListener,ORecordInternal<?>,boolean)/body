{
  checkOpeness();
  final long timer=OProfiler.getInstance().startChrono();
  try {
    for (    int clusterId : iClusterId) {
      if (iBeginRange != null)       if (clusterId < iBeginRange.getClusterId())       continue;
      if (iEndRange != null)       if (clusterId > iEndRange.getClusterId())       break;
      final long beginClusterPosition=iBeginRange != null && iBeginRange.getClusterId() == clusterId ? iBeginRange.getClusterPosition() : 0;
      final long endClusterPosition=iEndRange != null && iEndRange.getClusterId() == clusterId ? iEndRange.getClusterPosition() : -1;
      ioRecord=browseCluster(iListener,ioRecord,getClusterById(clusterId),beginClusterPosition,endClusterPosition,iLockEntireCluster);
      if (ioRecord == null)       break;
    }
  }
 catch (  IOException e) {
    OLogManager.instance().error(this,"Error on browsing elements of cluster: " + iClusterId,e);
  }
 finally {
    OProfiler.getInstance().stopChrono("OStorageLocal.foreach",timer);
  }
}
