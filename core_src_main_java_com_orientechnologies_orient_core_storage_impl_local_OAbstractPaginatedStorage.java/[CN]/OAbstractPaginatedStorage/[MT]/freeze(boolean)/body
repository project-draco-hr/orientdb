{
  checkOpeness();
  stateLock.acquireReadLock();
  try {
    checkOpeness();
    modificationLock.prohibitModifications(throwException);
    synch();
    try {
      unlock();
      writeCache.setSoftlyClosed(true);
      if (configuration != null)       configuration.setSoftlyClosed(true);
    }
 catch (    IOException e) {
      modificationLock.allowModifications();
      try {
        lock();
      }
 catch (      IOException ignored) {
      }
      throw new OStorageException("Error on freeze of storage '" + name + "'",e);
    }
  }
  finally {
    stateLock.releaseReadLock();
  }
}
