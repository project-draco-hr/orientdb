{
  final List<ODistributedServerNode> nodeList;
  lock.acquireSharedLock();
  try {
    if (nodes == null)     return;
    final ODocument database=clusterDbConfigurations.get(iTransactionEntry.getRecord().getDatabase().getName());
    if (database == null)     return;
    OLogManager.instance().info(this,"Caught change " + iTransactionEntry.status + " in database '"+ iTransactionEntry.getRecord().getDatabase().getName()+ "', record: "+ iTransactionEntry.getRecord().getIdentity()+ " and distributed to all the configured cluster nodes");
    final ODocument clusters=database.field("clusters");
    final ODocument servers=(ODocument)(clusters.containsField(iTransactionEntry.clusterName) ? clusters.field(iTransactionEntry.clusterName) : clusters.field("*"));
    nodeList=new ArrayList<ODistributedServerNode>();
    if (servers.field("synch") != null)     for (    String s : ((Map<String,Object>)servers.field("synch")).keySet()) {
      nodeList.add(nodes.get(s));
    }
    if (servers.field("asynch") != null)     for (    String s : ((Map<String,Object>)servers.field("asynch")).keySet()) {
      nodeList.add(nodes.get(s));
    }
  }
  finally {
    lock.releaseSharedLock();
  }
  for (  ODistributedServerNode node : nodeList) {
    try {
      node.sendRequest(iTransactionEntry);
    }
 catch (    Exception e) {
      e.printStackTrace();
      handleNodeFailure(node);
      node.bufferChange(iTransactionEntry);
    }
  }
}
