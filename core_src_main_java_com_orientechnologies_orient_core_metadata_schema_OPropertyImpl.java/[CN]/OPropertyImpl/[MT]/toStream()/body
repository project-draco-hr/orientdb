{
  document.setInternalStatus(ORecordElement.STATUS.UNMARSHALLING);
  try {
    document.field("name",name);
    document.field("type",type.id);
    if (mandatory)     document.field("mandatory",mandatory);
    if (notNull)     document.field("notNull",notNull);
    if (min != null)     document.field("min",min);
    if (max != null)     document.field("max",max);
    if (regexp != null)     document.field("regexp",regexp);
    if (linkedType != null)     document.field("linkedType",linkedType.id);
    if (linkedClass != null || linkedClassName != null)     document.field("linkedClass",linkedClass != null ? linkedClass.getName() : linkedClassName);
    if (customFields != null && customFields.size() > 0)     document.field("customFields",customFields,OType.EMBEDDEDMAP);
  }
  finally {
    document.setInternalStatus(ORecordElement.STATUS.LOADED);
  }
  return document;
}
