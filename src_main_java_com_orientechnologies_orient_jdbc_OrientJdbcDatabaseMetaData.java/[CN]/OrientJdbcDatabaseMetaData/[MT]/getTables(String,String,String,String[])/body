{
  final Collection<OClass> classes=database.getMetadata().getSchema().getClasses();
  final List<ODocument> records=new ArrayList<ODocument>();
  for (  OClass cls : classes) {
    final String className=cls.getName();
    if (tableNamePattern == null || tableNamePattern.equals("%") || tableNamePattern.equalsIgnoreCase(className)) {
      final ODocument doc=new ODocument();
      doc.field("TABLE_CAT",catalog);
      doc.field("TABLE_SCHEM",catalog);
      String type;
      if (SYSTEM_TABLES.contains(cls.getName()))       type="SYSTEM TABLE";
 else       type="TABLE";
      doc.field("TABLE_NAME",className);
      doc.field("TABLE_TYPE",type);
      doc.field("REMARKS",(Object)null);
      doc.field("TYPE_NAME",(Object)null);
      doc.field("REF_GENERATION",(Object)null);
      records.add(doc);
    }
  }
  return new OrientJdbcResultSet(new OrientJdbcStatement(connection),records,ResultSet.TYPE_FORWARD_ONLY,ResultSet.CONCUR_READ_ONLY,ResultSet.HOLD_CURSORS_OVER_COMMIT);
}
