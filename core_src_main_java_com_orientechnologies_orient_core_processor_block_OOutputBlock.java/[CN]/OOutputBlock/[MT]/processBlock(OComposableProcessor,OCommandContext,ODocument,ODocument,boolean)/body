{
  final Object value=getRequiredField(iContext,iConfig,"value");
  Boolean nullAsEmpty=getFieldOfClass(iContext,iConfig,"nullAsEmpty",Boolean.class);
  if (nullAsEmpty == null)   nullAsEmpty=true;
  final Boolean flatMultivalues=getFieldOfClass(iContext,iConfig,"flatMultivalues",Boolean.class);
  Object result;
  if (isBlock(value))   result=delegate("value",iManager,value,iContext,iOutput,iReadOnly);
 else   result=value;
  Object source=getField(iContext,iConfig,"source");
  if (source instanceof Map<?,?>)   source=new ODocument((Map<String,Object>)source);
  if (source instanceof ODocument && result instanceof List<?>) {
    result=addDocumentFields((ODocument)source,(List<Object>)result,nullAsEmpty);
  }
 else   if (OMultiValue.isMultiValue(result) && flatMultivalues != null && flatMultivalues) {
    result=flatMultivalues(iContext,false,flatMultivalues,result);
  }
  final String field=getFieldOfClass(iContext,iConfig,"field",String.class);
  if (field != null) {
    iOutput.field(field,result);
    return iOutput;
  }
  return result;
}
