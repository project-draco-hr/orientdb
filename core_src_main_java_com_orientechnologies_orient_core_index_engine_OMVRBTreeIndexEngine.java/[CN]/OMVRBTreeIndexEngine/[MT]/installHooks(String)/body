{
  final OJVMProfiler profiler=Orient.instance().getProfiler();
  final String profilerPrefix=profiler.getDatabaseMetric(getDatabase().getName(),"index." + indexName + '.');
  final String profilerMetadataPrefix="db.*.index.*.";
  profiler.registerHookValue(profilerPrefix + "items","Index size",OProfiler.METRIC_TYPE.SIZE,new OProfiler.OProfilerHookValue(){
    public Object getValue(){
      acquireSharedLock();
      try {
        return map != null ? map.size() : "-";
      }
  finally {
        releaseSharedLock();
      }
    }
  }
,profilerMetadataPrefix + "items");
  profiler.registerHookValue(profilerPrefix + "entryPointSize","Number of entrypoints in an index",OProfiler.METRIC_TYPE.SIZE,new OProfiler.OProfilerHookValue(){
    public Object getValue(){
      return map != null ? map.getEntryPointSize() : "-";
    }
  }
,profilerMetadataPrefix + "items");
  profiler.registerHookValue(profilerPrefix + "maxUpdateBeforeSave","Maximum number of updates in a index before force saving",OProfiler.METRIC_TYPE.SIZE,new OProfiler.OProfilerHookValue(){
    public Object getValue(){
      return map != null ? map.getMaxUpdatesBeforeSave() : "-";
    }
  }
,profilerMetadataPrefix + "maxUpdateBeforeSave");
  Orient.instance().getMemoryWatchDog().addListener(watchDog);
}
