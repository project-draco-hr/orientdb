{
  boolean interactiveMode=isInteractiveMode(args);
  onBefore();
  if (interactiveMode) {
    Console console=System.console();
    if (console == null) {
      err.println("Error on reading from the console");
      return;
    }
    String consoleInput;
    while (true) {
      out.println();
      out.print("> ");
      consoleInput=console.readLine();
      if (consoleInput == null || consoleInput.length() == 0)       continue;
      if (!executeCommands(consoleInput))       break;
    }
  }
 else {
    executeCommands(getCommandLine(args));
  }
  onAfter();
}
