{
  setDataCommandInfo("Freeze cluster");
  final String dbName=channel.readString();
  final int clusterId=channel.readShort();
  checkServerAccess("database.freeze");
  final ODatabaseDocumentTx databaseDocumentTx=getDatabaseInstance(dbName,ODatabaseDocument.TYPE,"plocal",false);
  if (databaseDocumentTx != null)   connection.database=databaseDocumentTx;
  if (databaseDocumentTx != null && databaseDocumentTx.exists()) {
    OLogManager.instance().info(this,"Freezing database '%s' cluster %d",connection.database.getURL(),clusterId);
    if (databaseDocumentTx.isClosed()) {
      openDatabase(databaseDocumentTx,connection.serverUser.name,connection.serverUser.password);
    }
    databaseDocumentTx.freezeCluster(clusterId);
  }
 else {
    throw new OStorageException("Database with name '" + dbName + "' doesn't exits.");
  }
  beginResponse();
  try {
    sendOk(clientTxId);
  }
  finally {
    endResponse();
  }
}
