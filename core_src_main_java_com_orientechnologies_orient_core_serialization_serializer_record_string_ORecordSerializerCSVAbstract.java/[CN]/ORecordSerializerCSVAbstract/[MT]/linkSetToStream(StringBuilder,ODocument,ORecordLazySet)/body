{
  final Iterator<OIdentifiable> it;
  final StringBuilder buffer;
  if (iSet.getStreamedContent() != null) {
    buffer=iSet.getStreamedContent();
    OProfiler.getInstance().updateCounter("serializer.rec.str.linkSet2string.cached",+1);
    it=iSet.newItemsIterator();
  }
 else {
    buffer=new StringBuilder();
    it=iSet.rawIterator();
  }
  if (it != null && it.hasNext()) {
    while (it.hasNext()) {
      if (buffer.length() > 0)       buffer.append(OStringSerializerHelper.RECORD_SEPARATOR);
      final OIdentifiable item=it.next();
      linkToStream(buffer,iRecord,item);
    }
  }
  iSet.convertRecords2Links();
  iOutput.append(OStringSerializerHelper.COLLECTION_BEGIN);
  iOutput.append(buffer);
  iOutput.append(OStringSerializerHelper.COLLECTION_END);
  iSet.setStreamedContent(buffer);
  return iOutput;
}
