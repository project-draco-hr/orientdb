{
  if (isEnabled()) {
    ODatabaseDocumentInternal currentDB=ODatabaseRecordThreadLocal.INSTANCE.getIfDefined();
    try {
      ODatabase<?> sysDB=openSystemDatabase();
      if (sysDB != null) {
        try {
          List<ODocument> result=sysDB.<OCommandRequest>command(new OSQLSynchQuery<ODocument>("select from OUser where name = ? limit 1").setFetchPlan("roles:1")).execute(username);
          if (result != null && !result.isEmpty())           return new OSystemUser(result.get(0),dbName);
        }
  finally {
          if (sysDB != null)           sysDB.close();
        }
      }
 else {
        OLogManager.instance().error(this,"getSystemUser() System Database is not open");
      }
    }
 catch (    Exception ex) {
      OLogManager.instance().error(this,"getSystemUser() Exception: %s",ex.getMessage());
    }
 finally {
      if (currentDB != null) {
        ODatabaseRecordThreadLocal.INSTANCE.set(currentDB);
      }
 else {
        ODatabaseRecordThreadLocal.INSTANCE.remove();
      }
    }
  }
  return null;
}
