{
  final long fileId;
  OAtomicOperation atomicOperation=storage.getAtomicOperationsManager().getCurrentOperation();
  diskCache.loadPinnedPage(hashStateEntry);
  try {
    OHashIndexFileLevelMetadataPage metadataPage=new OHashIndexFileLevelMetadataPage(hashStateEntry,getChangesTree(atomicOperation,hashStateEntry),false);
    fileId=metadataPage.getFileId(fileLevel);
  }
  finally {
    diskCache.release(hashStateEntry);
  }
  OCacheEntry entry=loadPage(atomicOperation,fileId,pageIndex,false,diskCache);
  if (entry == null)   entry=addPage(atomicOperation,fileId,diskCache);
  return entry;
}
