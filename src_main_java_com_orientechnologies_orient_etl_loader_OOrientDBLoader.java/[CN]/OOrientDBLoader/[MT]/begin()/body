{
  if (!wal)   OGlobalConfiguration.USE_WAL.setValue(wal);
  ODatabaseDocumentTx documentDatabase=init();
  final OrientBaseGraph graphDatabase;
  if (documentDatabase == null) {
switch (dbType) {
case DOCUMENT:
      documentDatabase=new ODatabaseDocumentTx(dbURL);
    documentDatabase.open(dbUser,dbPassword);
  break;
case GRAPH:
final OrientGraphFactory factory=new OrientGraphFactory(dbURL);
graphDatabase=factory.setTransactional(false).get();
documentDatabase=graphDatabase.getRawGraph();
pipeline.setGraphDatabase(graphDatabase);
break;
}
pipeline.setDocumentDatabase(documentDatabase);
}
documentDatabase.declareIntent(new OIntentMassiveInsert());
}
