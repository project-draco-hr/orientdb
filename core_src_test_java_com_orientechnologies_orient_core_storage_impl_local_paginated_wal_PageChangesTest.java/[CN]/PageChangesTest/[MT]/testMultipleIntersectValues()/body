{
  OPageChanges pageChanges=new OPageChanges();
  pageChanges.addChanges(10,new byte[]{0,1,2,3},new byte[]{3,2,1,0});
  pageChanges.addChanges(11,new byte[]{4,5,6,7},new byte[]{1,2,3,10});
  pageChanges.addChanges(20,new byte[]{8,9,10,11},new byte[]{11,10,9,8});
  pageChanges.addChanges(21,new byte[]{12,13,14,15},new byte[]{9,10,11,20});
  ODirectMemory directMemory=ODirectMemoryFactory.INSTANCE.directMemory();
  long pointer=directMemory.allocate(1024);
  pageChanges.applyChanges(pointer);
  Assert.assertEquals(directMemory.get(pointer + 10,5),new byte[]{0,4,5,6,7});
  Assert.assertEquals(directMemory.get(pointer + 20,5),new byte[]{8,12,13,14,15});
  pageChanges.revertChanges(pointer);
  Assert.assertEquals(directMemory.get(pointer + 10,5),new byte[]{3,2,1,0,10});
  Assert.assertEquals(directMemory.get(pointer + 20,5),new byte[]{11,10,9,8,20});
  directMemory.free(pointer);
}
