{
  if (exclusiveLock)   modificationLock.requestModificationLock();
  try {
    if (exclusiveLock) {
      lock.acquireExclusiveLock();
    }
 else     lock.acquireSharedLock();
    try {
      Lock recordLock;
      if (exclusiveLock)       recordLock=lockManager.acquireExclusiveLock(rid);
 else       recordLock=lockManager.acquireSharedLock(rid);
      try {
        return callable.call();
      }
  finally {
        lockManager.releaseLock(recordLock);
      }
    }
 catch (    RuntimeException e) {
      throw e;
    }
catch (    Exception e) {
      throw new OException("Error on nested call in lock",e);
    }
 finally {
      if (exclusiveLock) {
        lock.releaseExclusiveLock();
      }
 else       lock.releaseSharedLock();
    }
  }
  finally {
    if (exclusiveLock)     modificationLock.releaseModificationLock();
  }
}
