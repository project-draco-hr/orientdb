{
  addUser();
  lock.acquireExclusiveLock();
  try {
    addDataSegment(OStorage.DATA_DEFAULT_NAME);
    addCluster(CLUSTER_TYPE.PHYSICAL.toString(),OMetadata.CLUSTER_INTERNAL_NAME,null,null,true);
    addCluster(CLUSTER_TYPE.PHYSICAL.toString(),OMetadata.CLUSTER_INDEX_NAME,null,null,true);
    addCluster(CLUSTER_TYPE.PHYSICAL.toString(),OMetadata.CLUSTER_MANUAL_INDEX_NAME,null,null,true);
    defaultClusterId=addCluster(CLUSTER_TYPE.PHYSICAL.toString(),CLUSTER_DEFAULT_NAME,null,null,false);
    configuration.create();
    status=STATUS.OPEN;
  }
 catch (  OStorageException e) {
    close();
    throw e;
  }
catch (  IOException e) {
    close();
    throw new OStorageException("Error on creation of storage: " + name,e);
  }
 finally {
    lock.releaseExclusiveLock();
  }
}
