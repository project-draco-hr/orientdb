{
  boolean locked=acquireExclusiveLock();
  try {
    writeCommand(OChannelBinaryProtocol.DB_CLOSE);
    network.out.flush();
    network.socket.close();
    cache.removeUser();
    cache.clear();
    open=false;
    Orient.instance().unregisterStorage(this);
  }
 catch (  Exception e) {
  }
 finally {
    releaseExclusiveLock(locked);
  }
}
