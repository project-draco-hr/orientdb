{
  lock.acquireExclusiveLock();
  try {
    if (!leader)     return;
    leader=false;
    for (    Entry<String,ODistributedServerNodeRemote> node : nodes.entrySet()) {
      node.getValue().disconnect();
    }
    nodes.clear();
    if (discoveryListener != null) {
      discoveryListener.sendShutdown();
      discoveryListener=null;
    }
  }
  finally {
    lock.releaseExclusiveLock();
  }
}
