{
  final String indexType=idx.field(OIndexInternal.CONFIG_TYPE);
  String algorithm=idx.field(OIndexInternal.ALGORITHM);
  if (algorithm.equals(ODefaultIndexFactory.MVRBTREE_ALGORITHM)) {
    algorithm=ODefaultIndexFactory.SBTREE_ALGORITHM;
    idx.field(OIndexInternal.ALGORITHM,algorithm);
  }
  String valueContainerAlgorithm=idx.field(OIndexInternal.VALUE_CONTAINER_ALGORITHM);
  if (ODefaultIndexFactory.MVRBTREE_VALUE_CONTAINER.equals(valueContainerAlgorithm)) {
    valueContainerAlgorithm=ODefaultIndexFactory.SBTREEBONSAI_VALUE_CONTAINER;
    idx.field(OIndexInternal.VALUE_CONTAINER_ALGORITHM,valueContainerAlgorithm);
  }
  ODocument metadata=idx.field(OIndexInternal.METADATA);
  if (indexType == null) {
    OLogManager.instance().error(this,"Index type is null, will process other record.");
    throw new OException("Index type is null, will process other record. Index configuration: " + idx.toString());
  }
  return OIndexes.createIndex(newDb,indexType,algorithm,valueContainerAlgorithm,metadata);
}
