{
  super(iName,iFilePath,iMode);
  File f=new File(url);
  if (f.exists() || !exists(f.getParent())) {
    storagePath=OSystemVariableResolver.resolveSystemVariables(OFileUtils.getPath(new File(url).getPath()));
  }
 else {
    storagePath=OSystemVariableResolver.resolveSystemVariables(OFileUtils.getPath(new File(url).getParent()));
  }
  variableParser=new OStorageVariableParser(storagePath);
  configuration=new OStorageConfigurationSegment(this,storagePath);
  txManager=new OStorageLocalTxExecuter(this,configuration.txSegment);
  lockManager=new OLockManager<ORID,Runnable>(OGlobalConfiguration.STORAGE_LOCK_TIMEOUT.getValueAsInteger());
  PROFILER_CREATE_RECORD="storage." + name + ".createRecord";
  PROFILER_READ_RECORD="storage." + name + ".readRecord";
  PROFILER_UPDATE_RECORD="storage." + name + ".updateRecord";
  PROFILER_DELETE_RECORD="storage." + name + ".deleteRecord";
  DELETE_MAX_RETRIES=OGlobalConfiguration.FILE_MMAP_FORCE_RETRY.getValueAsInteger();
  DELETE_WAIT_TIME=OGlobalConfiguration.FILE_MMAP_FORCE_DELAY.getValueAsInteger();
  installProfilerHooks();
}
