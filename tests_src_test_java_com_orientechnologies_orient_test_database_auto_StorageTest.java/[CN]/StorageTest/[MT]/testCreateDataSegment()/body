{
  database=new ODatabaseDocumentTx(url);
  if (!ODatabaseHelper.existsDatabase(database))   ODatabaseHelper.createDatabase(database,url);
  database.open("admin","admin");
  File tempDir=new File(System.getProperty("java.io.tmpdir") + "/binary-Segment");
  tempDir.mkdirs();
  final int segmentId=database.addDataSegment("binary",tempDir.toString());
  Assert.assertEquals(segmentId,1);
  Assert.assertEquals(database.getStorage().getDataSegmentById(1).getSize(),0);
  if (database.getStorage() instanceof OStorageLocal) {
    Assert.assertTrue(new File(tempDir.toString() + "/binary.0.oda").exists());
    Assert.assertTrue(new File(tempDir.toString() + "/binary.odh").exists());
  }
  database.setDataSegmentStrategy(new ODataSegmentStrategy(){
    public int assignDataSegmentId(    ODatabase iDatabase,    ORecord<?> iRecord){
      return 1;
    }
  }
);
  ODocument record=database.newInstance().field("name","data-segment-test").save();
  Assert.assertNotNull(record);
  Assert.assertTrue(database.getStorage().getDataSegmentById(1).getSize() > 0);
  record.delete();
}
