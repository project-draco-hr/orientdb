{
  final int metadataClusterId=getClusterIdByName(OStorage.CLUSTER_METADATA_NAME);
  metadata.getSchema().createClass("ORole",metadataClusterId);
  metadata.getSchema().createClass("OUser",metadataClusterId);
  final ORole role=metadata.getSecurity().createRole("admin",ORole.ALLOW_MODES.ALLOW_ALL_BUT);
  user=metadata.getSecurity().createUser("admin","admin",new String[]{role.getName()});
  final ORole readerRole=metadata.getSecurity().createRole("reader",ORole.ALLOW_MODES.DENY_ALL_BUT);
  readerRole.addRule(ODatabaseSecurityResources.DATABASE,ORole.OPERATIONS.READ);
  readerRole.addRule(ODatabaseSecurityResources.CLUSTER + ".metadata",ORole.OPERATIONS.NONE);
  readerRole.addRule(ODatabaseSecurityResources.ALL_CLASSES,ORole.OPERATIONS.READ);
  readerRole.addRule(ODatabaseSecurityResources.ALL_CLUSTERS,ORole.OPERATIONS.READ);
  readerRole.addRule(ODatabaseSecurityResources.QUERY,ORole.OPERATIONS.READ);
  readerRole.addRule(ODatabaseSecurityResources.COMMAND,ORole.OPERATIONS.READ);
  metadata.getSecurity().createUser("reader","reader",new String[]{readerRole.getName()});
  final ORole writerRole=metadata.getSecurity().createRole("writer",ORole.ALLOW_MODES.DENY_ALL_BUT);
  writerRole.addRule(ODatabaseSecurityResources.DATABASE,ORole.OPERATIONS.ALL);
  writerRole.addRule(ODatabaseSecurityResources.CLUSTER + ".metadata",ORole.OPERATIONS.NONE);
  writerRole.addRule(ODatabaseSecurityResources.ALL_CLASSES,ORole.OPERATIONS.ALL);
  writerRole.addRule(ODatabaseSecurityResources.ALL_CLUSTERS,ORole.OPERATIONS.ALL);
  writerRole.addRule(ODatabaseSecurityResources.QUERY,ORole.OPERATIONS.READ);
  writerRole.addRule(ODatabaseSecurityResources.COMMAND,ORole.OPERATIONS.ALL);
  metadata.getSecurity().createUser("writer","writer",new String[]{writerRole.getName()});
  metadata.getSecurity().save();
}
