{
  if (valueContainerAlgorithm == null) {
    if (OClass.INDEX_TYPE.NOTUNIQUE.toString().equals(indexType) || OClass.INDEX_TYPE.NOTUNIQUE_HASH_INDEX.toString().equals(indexType) || OClass.INDEX_TYPE.FULLTEXT_HASH_INDEX.toString().equals(indexType)|| OClass.INDEX_TYPE.FULLTEXT.toString().equals(indexType))     valueContainerAlgorithm=ODefaultIndexFactory.MVRBTREE_VALUE_CONTAINER;
 else     valueContainerAlgorithm=ODefaultIndexFactory.NONE_VALUE_CONTAINER;
  }
  OStorage storage=database.getStorage();
  OIndexEngine indexEngine;
  final String storageType=storage.getType();
  if (storageType.equals("memory"))   indexEngine=new OMemoryHashMapIndexEngine();
 else   if (storageType.equals("local") || storageType.equals("plocal"))   indexEngine=new OLocalHashTableIndexEngine();
 else   if (storageType.equals("distributed"))   indexEngine=new OLocalHashTableIndexEngine();
 else   if (storageType.equals("remote"))   indexEngine=new ORemoteIndexEngine();
 else   throw new OIndexException("Unsupported storage type : " + storageType);
  if (OClass.INDEX_TYPE.UNIQUE_HASH_INDEX.toString().equals(indexType))   return new OIndexUnique(indexType,algorithm,indexEngine,valueContainerAlgorithm);
 else   if (OClass.INDEX_TYPE.NOTUNIQUE_HASH_INDEX.toString().equals(indexType))   return new OIndexNotUnique(indexType,algorithm,indexEngine,valueContainerAlgorithm);
 else   if (OClass.INDEX_TYPE.FULLTEXT_HASH_INDEX.toString().equals(indexType))   return new OIndexFullText(indexType,algorithm,indexEngine,valueContainerAlgorithm);
 else   if (OClass.INDEX_TYPE.DICTIONARY_HASH_INDEX.toString().equals(indexType))   return new OIndexDictionary(indexType,algorithm,indexEngine,valueContainerAlgorithm);
  throw new OConfigurationException("Unsupported type : " + indexType);
}
