{
  final StringBuilder buffer=new StringBuilder(128);
  boolean spaced=iRemoveLeadingSpaces;
  for (int i=0; i < iSource.length(); ++i) {
    final char c=iSource.charAt(i);
    if (c != ' ') {
      spaced=false;
      buffer.append(c);
    }
 else     if (!spaced) {
      spaced=true;
      buffer.append(c);
    }
  }
  final int len=buffer.length();
  if (iRemoveTailingSpaces && buffer.charAt(len - 1) == ' ')   buffer.setLength(len - 1);
  return buffer.toString();
}
