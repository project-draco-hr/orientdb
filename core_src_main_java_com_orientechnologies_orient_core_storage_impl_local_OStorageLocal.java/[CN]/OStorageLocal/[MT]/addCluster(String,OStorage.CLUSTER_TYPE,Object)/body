{
  checkOpeness();
  try {
    iClusterName=iClusterName != null ? iClusterName.toLowerCase() : null;
switch (iClusterType) {
case PHYSICAL:
{
        final String clusterFileName=(String)(iParameters.length < 1 ? storagePath + "/" + iClusterName : iParameters[0]);
        final int startSize=(iParameters.length < 2 ? -1 : (Integer)iParameters[1]);
        return addPhysicalCluster(iClusterName,clusterFileName,startSize);
      }
case LOGICAL:
{
      final int physicalClusterId=(iParameters.length < 1 ? getClusterIdByName(OStorage.CLUSTER_INTERNAL_NAME) : (Integer)iParameters[0]);
      return addLogicalCluster(iClusterName,physicalClusterId);
    }
case MEMORY:
  return addMemoryCluster(iClusterName);
default :
OLogManager.instance().exception("Cluster type '" + iClusterType + "' is not supported. Supported types are: "+ Arrays.toString(TYPES),null,OStorageException.class);
}
}
 catch (Exception e) {
OLogManager.instance().exception("Error in creation of new cluster '" + iClusterName + "' of type: "+ iClusterType,e,OStorageException.class);
}
return -1;
}
