{
  if (iMax < 0)   iMax=Integer.MAX_VALUE;
  final byte[] buf=new byte[1024];
  int byteRead=0;
  int byteTotal=0;
  while ((byteRead=in.read(buf,0,Math.min(buf.length,iMax - byteTotal))) > 0) {
    out.write(buf,0,byteRead);
    byteTotal+=byteRead;
  }
  return byteTotal;
}
