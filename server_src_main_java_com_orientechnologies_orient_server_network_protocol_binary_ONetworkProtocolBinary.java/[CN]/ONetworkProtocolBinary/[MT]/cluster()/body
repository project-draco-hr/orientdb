{
  setDataCommandInfo("Cluster status");
  final ODocument req=new ODocument(channel.readBytes());
  final ODistributedServerManager manager=OServerMain.server().getHandler(ODistributedServerManager.class);
  ODocument response=null;
  if (!manager.isLeader())   throw new IllegalArgumentException("Current node is not the leader. Repeat this command against the leader node");
  final String operation=req.field("operation");
  if (operation == null)   throw new IllegalArgumentException("Cluster operation is null");
  if (operation.equals("status"))   response=manager.getLeader().getClusteredConfiguration();
 else   if (operation.equals("addNode")) {
    final String node=req.field("node");
    final String[] nodeParts=node.split(":");
    manager.getLeader().connect2Peer(new String[]{nodeParts[0]},Integer.parseInt(nodeParts[1]));
  }
 else   if (operation.equals("removeNode")) {
    final ORemotePeer peerNode=manager.getLeader().getPeerNode((String)req.field("node"));
    if (peerNode != null)     manager.getLeader().removePeer(peerNode);
  }
 else   throw new IllegalArgumentException("Cluster operation '" + operation + "' is not supported");
  sendResponse(response);
}
