{
  iRequest.data.commandInfo="Get static content";
  iRequest.data.commandDetail=iRequest.url;
  if (wwwPath == null) {
    wwwPath=iRequest.configuration.getValueAsString("orientdb.www.path","src/site");
    final File wwwPathDirectory=new File(wwwPath);
    if (!wwwPathDirectory.exists())     OLogManager.instance().warn(this,"orientdb.www.path variable points to '%s' but it doesn't exists",wwwPath);
    if (!wwwPathDirectory.isDirectory())     OLogManager.instance().warn(this,"orientdb.www.path variable points to '%s' but it isn't a directory",wwwPath);
  }
  if (cacheContents == null && OGlobalConfiguration.SERVER_CACHE_FILE_STATIC.getValueAsBoolean())   cacheContents=new HashMap<String,OStaticContentCachedEntry>();
  InputStream is=null;
  long contentSize=0;
  String type=null;
  try {
    final String url=getResource(iRequest);
    String filePath;
    if (url.startsWith("/www"))     filePath=wwwPath + url.substring("/www".length(),url.length());
 else     filePath=wwwPath + url;
    if (cacheContents != null) {
synchronized (cacheContents) {
        final OStaticContentCachedEntry cachedEntry=cacheContents.get(filePath);
        if (cachedEntry != null) {
          is=new ByteArrayInputStream(cachedEntry.content);
          contentSize=cachedEntry.size;
          type=cachedEntry.type;
        }
      }
    }
    if (is == null) {
      File inputFile=new File(filePath);
      if (!inputFile.exists()) {
        OLogManager.instance().debug(this,"Static resource not found: %s",filePath);
        sendBinaryContent(iRequest,404,"File not found",null,null,0);
        return false;
      }
      if (inputFile.isDirectory()) {
        inputFile=new File(filePath + "/index.htm");
        if (inputFile.exists())         filePath=url + "/index.htm";
 else {
          inputFile=new File(url + "/index.html");
          if (inputFile.exists())           filePath=url + "/index.html";
        }
      }
      if (filePath.endsWith(".htm") || filePath.endsWith(".html"))       type="text/html";
 else       if (filePath.endsWith(".png"))       type="image/png";
 else       if (filePath.endsWith(".jpeg"))       type="image/jpeg";
 else       if (filePath.endsWith(".js"))       type="application/x-javascript";
 else       if (filePath.endsWith(".css"))       type="text/css";
 else       if (filePath.endsWith(".ico"))       type="image/x-icon";
 else       if (filePath.endsWith(".otf"))       type="font/opentype";
 else       type="text/plain";
      is=new BufferedInputStream(new FileInputStream(inputFile));
      contentSize=inputFile.length();
      if (cacheContents != null) {
        final byte[] buffer=new byte[(int)contentSize];
        for (int i=0; i < contentSize; ++i)         buffer[i]=(byte)is.read();
        OStaticContentCachedEntry cachedEntry=new OStaticContentCachedEntry();
        cachedEntry.content=buffer;
        cachedEntry.size=contentSize;
        cachedEntry.type=type;
        cacheContents.put(url,cachedEntry);
        is=new ByteArrayInputStream(cachedEntry.content);
      }
    }
    sendBinaryContent(iRequest,OHttpUtils.STATUS_OK_CODE,OHttpUtils.STATUS_OK_DESCRIPTION,type,is,contentSize);
  }
 catch (  IOException e) {
    e.printStackTrace();
  }
 finally {
    if (is != null)     try {
      is.close();
    }
 catch (    IOException e) {
    }
  }
  return false;
}
