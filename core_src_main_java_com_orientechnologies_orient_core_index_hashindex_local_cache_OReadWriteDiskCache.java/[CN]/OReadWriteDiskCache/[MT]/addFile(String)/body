{
  cacheLock.acquireWriteLock();
  try {
    long fileId=writeCache.addFile(fileName);
    filePages.put(fileId,Collections.newSetFromMap(new ConcurrentHashMap<Long,Boolean>()));
    return fileId;
  }
  finally {
    cacheLock.releaseWriteLock();
  }
}
