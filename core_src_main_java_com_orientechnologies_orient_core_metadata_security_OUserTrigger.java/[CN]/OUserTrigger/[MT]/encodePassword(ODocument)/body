{
  if (iDocument.field("name") == null)   throw new OSecurityException("User name not found");
  final String password=(String)iDocument.field("password");
  if (password == null)   throw new OSecurityException("User '" + iDocument.field("name") + "' has no password");
  if (!password.startsWith(OSecurityManager.ALGORITHM_PREFIX)) {
    iDocument.field("password",OUser.encryptPassword(password));
    return true;
  }
  return false;
}
