{
  this.serverInstance=serverInstance;
  this.wrapped=wrapped;
  for (  String clusterName : dhtConfiguration.getUndistributableClusters()) {
    undistributedClusters.add(wrapped.getClusterIdByName(clusterName));
  }
  final int cl=Runtime.getRuntime().availableProcessors() * 4;
  distributedQueryExecutors=new ThreadPoolExecutor(0,cl,0L,TimeUnit.MILLISECONDS,new ArrayBlockingQueue<Runnable>(cl),new ThreadFactory(){
    private final AtomicInteger i=new AtomicInteger(0);
    @Override public Thread newThread(    Runnable r){
      final Thread t=new Thread(Thread.currentThread().getThreadGroup(),r,"DistributedQueryExecutor-" + i.getAndIncrement());
      t.setDaemon(true);
      t.setPriority(Thread.NORM_PRIORITY);
      return t;
    }
  }
);
}
