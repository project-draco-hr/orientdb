{
  this.pageSize=pageSize;
  this.zeroPage=ByteBuffer.allocateDirect(pageSize).order(ByteOrder.nativeOrder());
  if (preallocatePages > 0) {
    if (maxChunkSize < 0) {
      maxChunkSize=Integer.MAX_VALUE;
    }
    int pagesPerArea=(maxChunkSize / pageSize);
    pagesPerArea=closestPowerOfTwo(pagesPerArea);
    while ((long)pagesPerArea * pageSize > maxChunkSize) {
      pagesPerArea=pagesPerArea >>> 1;
    }
    maxPagesPerSingleArea=pagesPerArea;
    final int arraySize=(int)((preallocatePages + maxPagesPerSingleArea - 1) / maxPagesPerSingleArea);
    preallocatedAreas=new AtomicReferenceArray<BufferHolder>(arraySize);
    this.preallocatedPages=preallocatePages;
  }
 else {
    preallocatedAreas=null;
    maxPagesPerSingleArea=-1;
    this.preallocatedPages=-1;
  }
}
