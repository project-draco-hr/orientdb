{
  try {
    if (!open)     return;
    try {
      beginRequest(OChannelBinaryProtocol.REQUEST_DB_CLOSE);
    }
  finally {
      endRequest();
    }
    network.flush();
    serviceThread.sendShutdown();
    serviceThread.interrupt();
    network.close();
    level2cache.shutdown();
    open=false;
    Orient.instance().unregisterStorage(this);
  }
 catch (  Exception e) {
  }
}
