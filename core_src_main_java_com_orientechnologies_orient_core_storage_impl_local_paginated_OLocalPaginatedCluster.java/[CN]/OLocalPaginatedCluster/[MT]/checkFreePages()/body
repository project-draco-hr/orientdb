{
  long filledUpTo=diskCache.getFilledUpTo(fileId);
  for (long i=0; i < filledUpTo; i++) {
    OCachePointer pointer=diskCache.load(fileId,i);
    int freePageIndex;
    try {
      final OLocalPage page=new OLocalPage(pointer.getDataPointer(),false,OLocalPage.TrackMode.NONE);
      freePageIndex=calculateFreePageIndex(page);
      if (freePageIndex < 0)       continue;
    }
  finally {
      diskCache.release(fileId,i);
    }
    if (!findInFreeList(freePageIndex,i))     return false;
  }
  return true;
}
