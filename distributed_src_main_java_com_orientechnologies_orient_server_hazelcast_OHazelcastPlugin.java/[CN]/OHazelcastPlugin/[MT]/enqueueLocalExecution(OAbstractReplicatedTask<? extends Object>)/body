{
  if (!checkOperationSequence(iTask))   return null;
  final OStorageSynchronizer dbSynchronizer=iTask.getDatabaseSynchronizer();
  waitForMyTurnInQueue(iTask);
  try {
    ODistributedServerLog.debug(this,iTask.getNodeSource(),iTask.getNodeDestination(),DIRECTION.IN,"pop operation=%d:%d",iTask.getRunId(),iTask.getOperationSerial());
    final long operationLogOffset=logOperation2Journal(dbSynchronizer,iTask);
    try {
      final Object result=iTask.executeOnLocalNode();
      updateJournal(iTask,dbSynchronizer,operationLogOffset,true);
      return result;
    }
 catch (    Exception e) {
      updateJournal(iTask,dbSynchronizer,operationLogOffset,false);
      throw e;
    }
  }
  finally {
    updateQueue(iTask);
  }
}
