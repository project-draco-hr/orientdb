{
  type=iType;
  watchDog=new Listener(){
    public void memoryUsageLow(    final TYPE iType,    final long usedMemory,    final long maxMemory){
      if (iType == TYPE.JVM) {
        if (map != null) {
          acquireExclusiveLock();
          try {
            OLogManager.instance().warn(this,"Starting optimization of Index with %d items...",map.size());
            map.optimize(true);
          }
  finally {
            releaseExclusiveLock();
          }
        }
      }
    }
  }
;
  Orient.instance().getMemoryWatchDog().addListener(watchDog);
}
