{
  final ODirectMemory directMemory=ODirectMemoryFactory.INSTANCE.directMemory();
  if (OGlobalConfiguration.USE_WAL.getValueAsBoolean()) {
    writeAheadLog=new OWriteAheadLog(this);
    final int fuzzyCheckpointDelay=OGlobalConfiguration.WAL_FUZZY_CHECKPOINT_INTERVAL.getValueAsInteger();
    fuzzyCheckpointExecutor.scheduleWithFixedDelay(new Runnable(){
      @Override public void run(){
        try {
          makeFuzzyCheckpoint();
        }
 catch (        Throwable e) {
          OLogManager.instance().error(this,"Error during background fuzzy checkpoint creation for storage " + name,e);
        }
      }
    }
,fuzzyCheckpointDelay,fuzzyCheckpointDelay,TimeUnit.SECONDS);
  }
 else   writeAheadLog=null;
  diskCache=new O2QCache(OGlobalConfiguration.DISK_CACHE_SIZE.getValueAsLong() * ONE_KB * ONE_KB,OGlobalConfiguration.DISK_CACHE_WRITE_QUEUE_LENGTH.getValueAsInteger(),directMemory,writeAheadLog,OGlobalConfiguration.DISK_CACHE_PAGE_SIZE.getValueAsInteger() * ONE_KB,this,false);
}
