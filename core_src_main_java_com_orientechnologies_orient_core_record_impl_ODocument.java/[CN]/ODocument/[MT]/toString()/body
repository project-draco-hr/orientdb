{
  final boolean saveDirtyStatus=_dirty;
  final boolean oldUpdateContent=_contentChanged;
  try {
    final StringBuilder buffer=new StringBuilder(128);
    checkForFields();
    if (_clazz != null)     buffer.append(_clazz.getStreamableName());
    if (_recordId != null) {
      if (_recordId.isValid())       buffer.append(_recordId);
    }
    boolean first=true;
    for (    Entry<String,Object> f : _fieldValues.entrySet()) {
      buffer.append(first ? '{' : ',');
      buffer.append(f.getKey());
      buffer.append(':');
      if (f.getValue() == null)       buffer.append("null");
 else       if (f.getValue() instanceof Collection<?> || f.getValue().getClass().isArray()) {
        buffer.append('[');
        buffer.append(OMultiValue.getSize(f.getValue()));
        buffer.append(']');
      }
 else       if (f.getValue() instanceof ORecord<?>) {
        final ORecord<?> record=(ORecord<?>)f.getValue();
        if (record.getIdentity().isValid())         record.getIdentity().toString(buffer);
 else         buffer.append(record.toString());
      }
 else       buffer.append(f.getValue());
      if (first)       first=false;
    }
    if (!first)     buffer.append('}');
    if (_recordId != null && _recordId.isValid()) {
      buffer.append(" v");
      buffer.append(_recordVersion);
    }
    return buffer.toString();
  }
  finally {
    _dirty=saveDirtyStatus;
    _contentChanged=oldUpdateContent;
  }
}
