{
  ODatabaseDocumentTx db=null;
  try {
    db=(ODatabaseDocumentTx)server.openDatabase("graph",iDatabaseName,iAuthenticationParts.get(0),iAuthenticationParts.get(1));
    if (db.getUser() == null)     return false;
    iRequest.data.currentUserId=db.getUser().getDocument().getIdentity().toString();
    iRequest.sessionId=OHttpSessionManager.getInstance().createSession(iDatabaseName,iAuthenticationParts.get(0));
    iResponse.sessionId=iRequest.sessionId;
    return true;
  }
 catch (  OSecurityAccessException e) {
  }
catch (  OLockException e) {
    OLogManager.instance().error(this,"Cannot access to the database '" + iDatabaseName + "'",ODatabaseException.class,e);
  }
 finally {
    if (db != null)     db.close();
 else     sendAuthorizationRequest(iRequest,iResponse,iDatabaseName);
  }
  return false;
}
