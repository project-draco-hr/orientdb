{
  final Map<OIdentifiable,OModifiableInteger> newChangedValues=new HashMap<OIdentifiable,OModifiableInteger>();
  for (  Map.Entry<OIdentifiable,OModifiableInteger> entry : changedValues.entrySet()) {
    OIdentifiable identifiable=entry.getKey();
    if (identifiable instanceof ORecord) {
      ORID identity=identifiable.getIdentity();
      ORecord record=(ORecord)identifiable;
      if (identity.isNew() || record.isDirty()) {
        record.save();
        identity=record.getIdentity();
      }
      newChangedValues.put(identity,entry.getValue());
    }
  }
  changedValues.clear();
  changedValues.putAll(newChangedValues);
  return true;
}
