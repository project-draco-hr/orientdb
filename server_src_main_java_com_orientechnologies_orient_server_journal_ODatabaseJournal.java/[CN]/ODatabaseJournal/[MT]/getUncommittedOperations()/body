{
  final List<ORecordId> uncommittedRecords=new ArrayList<ORecordId>();
  long fileOffset=file.getFilledUpTo();
  while (fileOffset > 0) {
    if (getOperationStatus(fileOffset))     break;
    final OAbstractDistributedTask<?> op=getOperation(fileOffset);
    OLogManager.instance().warn(this,"DISTRIBUTED Found uncommitted operation %s",op);
    if (op instanceof OAbstractRecordDistributedTask<?>)     uncommittedRecords.add(((OAbstractRecordDistributedTask<?>)op).getRid());
    fileOffset=getPreviousOperation(fileOffset);
  }
  return uncommittedRecords;
}
