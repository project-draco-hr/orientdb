{
  Orient.instance().registerListener(this);
  commitTask=new TimerTask(){
    @Override public void run(){
      if (Boolean.FALSE.equals(closed.get())) {
        commit();
      }
    }
  }
;
  Orient.instance().scheduleTask(commitTask,10000,10000);
  this.index=indexDefinition;
  this.indexName=indexName;
  this.automatic=isAutomatic;
  this.metadata=metadata;
  OluceneAnalyzerFactory fc=new OluceneAnalyzerFactory();
  indexAnalyzer=fc.createAnalyzer(indexDefinition,OluceneAnalyzerFactory.AnalyzerKind.INDEX,metadata);
  queryAnalyzer=fc.createAnalyzer(indexDefinition,OluceneAnalyzerFactory.AnalyzerKind.QUERY,metadata);
  try {
    this.index=indexDefinition;
    checkCollectionIndex(indexDefinition);
    reOpen(metadata);
  }
 catch (  IOException e) {
    OLogManager.instance().error(this,"Error on initializing Lucene index",e);
  }
}
