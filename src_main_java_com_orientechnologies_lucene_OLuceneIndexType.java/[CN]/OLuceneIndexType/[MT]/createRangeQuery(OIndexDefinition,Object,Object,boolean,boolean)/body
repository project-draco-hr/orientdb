{
  Query query=null;
  if (fromValue instanceof Number || toValue instanceof Number) {
    String idx=index.getFields().iterator().next();
    Number from=(Number)fromValue;
    Number to=(Number)toValue;
    if (from instanceof Long || to instanceof Long) {
      return NumericRangeQuery.newLongRange(idx,from != null ? from.longValue() : 0,to != null ? to.longValue() : Long.MAX_VALUE,includeFrom,includeTo);
    }
 else     if (from instanceof Double || to instanceof Double) {
      return NumericRangeQuery.newDoubleRange(idx,from != null ? from.doubleValue() : 0,to != null ? to.doubleValue() : Double.MAX_VALUE,includeFrom,includeTo);
    }
 else     if (from instanceof Float || to instanceof Float) {
      return NumericRangeQuery.newFloatRange(idx,from != null ? from.floatValue() : 0,to != null ? to.floatValue() : Float.MAX_VALUE,includeFrom,includeTo);
    }
 else {
      return NumericRangeQuery.newIntRange(idx,from != null ? from.intValue() : 0,to != null ? to.intValue() : Integer.MAX_VALUE,includeFrom,includeTo);
    }
  }
 else   if (fromValue instanceof Date && toValue instanceof Date) {
    String idx=index.getFields().iterator().next();
    query=NumericRangeQuery.newLongRange(idx,((Date)fromValue).getTime(),((Date)toValue).getTime(),includeFrom,includeTo);
  }
  return query;
}
