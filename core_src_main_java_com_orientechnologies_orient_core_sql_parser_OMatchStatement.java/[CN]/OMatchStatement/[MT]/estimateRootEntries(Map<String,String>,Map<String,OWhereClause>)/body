{
  Set<String> allAliases=new HashSet<String>();
  allAliases.addAll(aliasClasses.keySet());
  allAliases.addAll(aliasFilters.keySet());
  OSchema schema=getDatabase().getMetadata().getSchema();
  Map<String,Long> result=new HashMap<String,Long>();
  for (  String alias : allAliases) {
    String className=aliasClasses.get(alias);
    if (className == null) {
      continue;
    }
    if (!schema.existsClass(className)) {
      throw new OCommandExecutionException("class not defined: " + className);
    }
    OClass oClass=schema.getClass(alias);
    long upperBound;
    OWhereClause filter=aliasFilters.get(alias);
    if (filter != null) {
      upperBound=filter.estimate(oClass);
    }
 else {
      upperBound=oClass.count();
    }
    result.put(alias,upperBound);
  }
  return result;
}
