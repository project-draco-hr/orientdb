{
  lock.acquireExclusiveLock();
  try {
    final int varSize=file.readInt(iOffsetEndOperation - OFFSET_BACK_SIZE);
    final long offset=iOffsetEndOperation - OFFSET_BACK_SIZE - varSize- OFFSET_VARDATA;
    ODistributedServerLog.debug(this,cluster.getLocalNodeId(),null,DIRECTION.NONE,"update journal db '%s' on operation #%d.%d rid %s",storage.getName(),file.readLong(iOffsetEndOperation - OFFSET_BACK_RUNID),file.readLong(iOffsetEndOperation - OFFSET_BACK_OPERATID),iRid);
    file.write(offset + OFFSET_STATUS,new byte[]{(byte)iStatus.ordinal()});
    if (iRid != null)     file.writeLong(offset + OFFSET_VARDATA + OBinaryProtocol.SIZE_SHORT,iRid.clusterPosition.longValue());
    file.synch();
  }
  finally {
    lock.releaseExclusiveLock();
  }
}
