{
  checkOpeness();
  if (!rid.isPersistent())   throw new IllegalArgumentException("Cannot read record " + rid + " since the position is invalid in database '"+ name+ '\'');
  clusterSegment.getExternalModificationLock().requestModificationLock();
  try {
    if (atomicLock)     lock.acquireSharedLock();
    try {
      lockManager.acquireLock(Thread.currentThread(),rid,OLockManager.LOCK.SHARED);
      try {
        return clusterSegment.readRecord(rid.clusterPosition);
      }
  finally {
        lockManager.releaseLock(Thread.currentThread(),rid,OLockManager.LOCK.SHARED);
      }
    }
 catch (    IOException e) {
      OLogManager.instance().error(this,"Error on reading record " + rid + " (cluster: "+ clusterSegment+ ')',e);
      return null;
    }
 finally {
      if (atomicLock)       lock.releaseSharedLock();
    }
  }
  finally {
    clusterSegment.getExternalModificationLock().releaseModificationLock();
  }
}
