{
  long total=0;
  exportImportHashTable=(OIndex<OIdentifiable>)database.getMetadata().getIndexManager().createIndex(EXPORT_IMPORT_MAP_NAME,OClass.INDEX_TYPE.DICTIONARY_HASH_INDEX.toString(),new OSimpleKeyIndexDefinition(OType.LINK),null,null);
  jsonReader.readNext(OJSONReader.BEGIN_COLLECTION);
  long totalRecords=0;
  System.out.print("\nImporting records...");
  ORID rid;
  int lastClusterId=-1;
  long clusterRecords=0;
  while (jsonReader.lastChar() != ']') {
    rid=importRecord();
    if (rid != null) {
      ++clusterRecords;
      if (lastClusterId == -1)       lastClusterId=rid.getClusterId();
 else       if (rid.getClusterId() != lastClusterId || jsonReader.lastChar() == ']') {
        System.out.print("\n- Imported records into cluster '" + database.getClusterNameById(lastClusterId) + "' (id="+ lastClusterId+ "): "+ clusterRecords+ " records");
        clusterRecords=0;
        lastClusterId=rid.getClusterId();
      }
      ++totalRecords;
    }
    record=null;
  }
  rewriteLinksInImportedDocuments();
  listener.onMessage("\n\nDone. Imported " + totalRecords + " records\n");
  jsonReader.readNext(OJSONReader.COMMA_SEPARATOR);
  return total;
}
