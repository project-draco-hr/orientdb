{
  if (!isEnabled() || iRID.getClusterId() == excludedCluster)   return null;
  final ORecordInternal<?> record;
  lock.lock();
  try {
    record=underlying.remove(iRID);
    if (record == null || record.isDirty())     return null;
    if (strategy == STRATEGY.COPY_RECORD)     underlying.put((ORecordInternal<?>)record.flatCopy());
  }
  finally {
    lock.unlock();
  }
  return record;
}
