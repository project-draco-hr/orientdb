{
  try {
    acquireExclusiveLock();
    long offset=holeSegment.popLastEntryPosition();
    final int[] pos;
    if (offset > -1)     pos=getRelativePosition(offset);
 else {
      pos=allocateSpace(RECORD_SIZE);
      offset=getAbsolutePosition(pos);
    }
    OFile file=files[pos[0]];
    int p=pos[1];
    file.writeShort(p,(short)iDataSegmentId);
    file.writeLong(p+=OConstants.SIZE_SHORT,iPosition);
    file.writeByte(p+=OConstants.SIZE_LONG,iRecordType);
    file.writeInt(p+=OConstants.SIZE_BYTE,0);
    return offset / RECORD_SIZE;
  }
  finally {
    releaseExclusiveLock();
  }
}
