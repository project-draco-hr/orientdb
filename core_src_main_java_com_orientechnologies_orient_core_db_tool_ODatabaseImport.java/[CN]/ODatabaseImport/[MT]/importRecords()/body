{
  long total=0;
  database.getMetadata().getIndexManager().dropIndex(EXPORT_IMPORT_MAP_NAME);
  exportImportHashTable=(OIndex<OIdentifiable>)database.getMetadata().getIndexManager().createIndex(EXPORT_IMPORT_MAP_NAME,OClass.INDEX_TYPE.DICTIONARY_HASH_INDEX.toString(),new OSimpleKeyIndexDefinition(OType.LINK),null,null);
  jsonReader.readNext(OJSONReader.BEGIN_COLLECTION);
  long totalRecords=0;
  System.out.print("\nImporting records...");
  ORID rid;
  int lastClusterId=-1;
  long clusterRecords=0;
  while (jsonReader.lastChar() != ']') {
    rid=importRecord();
    if (rid != null) {
      ++clusterRecords;
      if (lastClusterId == -1) {
        lastClusterId=rid.getClusterId();
        System.out.print("\n- Importing records into cluster '" + database.getClusterNameById(lastClusterId) + "' (id="+ lastClusterId+ "): ");
      }
 else       if (rid.getClusterId() != lastClusterId || jsonReader.lastChar() == ']') {
        System.out.print(" = " + clusterRecords + " records");
        clusterRecords=0;
        lastClusterId=rid.getClusterId();
        System.out.print("\n- Importing records into cluster '" + database.getClusterNameById(lastClusterId) + "' (id="+ lastClusterId+ "): ");
      }
 else       if (clusterRecords % 10000 == 0)       System.out.print(".");
      ++totalRecords;
    }
    record=null;
  }
  if (migrateLinks)   migrateLinksInImportedDocuments();
  listener.onMessage("\n\nDone. Imported " + totalRecords + " records\n");
  jsonReader.readNext(OJSONReader.COMMA_SEPARATOR);
  return total;
}
