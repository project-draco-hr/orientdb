{
  final OIndexDefinition indexDefinition=idx.getDefinition();
  if (indexDefinition == null || indexDefinition.getClassName() == null)   return;
  final Map<OMultiKey,Set<OIndex<?>>> map=classPropertyIndex.get(indexDefinition.getClassName().toLowerCase());
  if (map == null) {
    return;
  }
  final int paramCount=indexDefinition.getParamCount();
  for (int i=1; i <= paramCount; i++) {
    final List<String> fields=normalizeFieldNames(indexDefinition.getFields().subList(0,i));
    final OMultiKey multiKey=new OMultiKey(fields);
    final Set<OIndex<?>> indexSet=map.get(multiKey);
    if (indexSet == null)     continue;
    indexSet.remove(idx);
    if (indexSet.isEmpty()) {
      map.remove(multiKey);
    }
  }
  if (map.isEmpty())   classPropertyIndex.remove(indexDefinition.getClassName().toLowerCase());
}
