{
  Set<OIdentifiable> result=new HashSet<OIdentifiable>();
  Shape shape=factory.makeShape(key,ctx);
  if (shape == null)   return null;
  SpatialArgs args=new SpatialArgs(SpatialOperation.IsWithin,shape);
  IndexSearcher searcher=getSearcher();
  Integer limit=null;
  if (context != null) {
    limit=(Integer)context.getVariable("$limit");
  }
  int limitDoc=(limit != null && limit > 0) ? limit : Integer.MAX_VALUE;
  Filter filter=strategy.makeFilter(args);
  TopDocs topDocs=searcher.search(new MatchAllDocsQuery(),filter,limitDoc);
  ScoreDoc[] scoreDocs=topDocs.scoreDocs;
  for (  ScoreDoc s : scoreDocs) {
    Document doc=searcher.doc(s.doc);
    result.add(new ORecordId(doc.get(RID)));
  }
  return result;
}
