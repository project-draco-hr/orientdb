{
  final OClass cls=iDocument.getSchemaClass();
  if (cls != null && cls.isSubClassOf(OSecurityShared.RESTRICTED_CLASSNAME)) {
    Set<OIdentifiable> allowed=iDocument.field(OSecurityShared.ALLOW_ALL_FIELD);
    if (allowed == null) {
      allowed=new HashSet<OIdentifiable>();
      iDocument.field(OSecurityShared.ALLOW_ALL_FIELD,allowed);
    }
    allowed.add(ODatabaseRecordThreadLocal.INSTANCE.get().getUser().getDocument().getIdentity());
    return RESULT.RECORD_CHANGED;
  }
  return RESULT.RECORD_NOT_CHANGED;
}
