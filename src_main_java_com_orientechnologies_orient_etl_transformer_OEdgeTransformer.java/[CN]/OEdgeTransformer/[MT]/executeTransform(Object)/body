{
  final OrientVertex vertex;
  if (input instanceof OIdentifiable)   vertex=graph.getVertex(input);
 else   if (input instanceof OrientVertex)   vertex=(OrientVertex)input;
 else   throw new OTransformException("Input type '" + input + "' is not supported");
  Object joinValue=vertex.getProperty(joinFieldName);
  Object result=lookup(joinValue);
  if (result == null) {
switch (unresolvedLinkAction) {
case CREATE:
      if (lookup != null) {
        final String[] lookupParts=lookup.split("\\.");
        final OrientVertex linkedV=graph.addTemporaryVertex(lookupParts[0]);
        linkedV.setProperty(lookupParts[1],joinValue);
        linkedV.save();
        result=linkedV;
      }
 else       throw new OConfigurationException("Cannot create linked document because target class is unknown. Use 'lookup' field");
    break;
case ERROR:
  processor.getStats().incrementErrors();
log("%s: ERROR Cannot resolve join for value '%s'",getName(),joinValue);
break;
case WARNING:
processor.getStats().incrementWarnings();
log("%s: WARN Cannot resolve join for value '%s'",getName(),joinValue);
break;
case SKIP:
return null;
case HALT:
throw new OETLProcessHaltedException("Cannot resolve join for value '" + joinValue + "'");
}
if (result != null) {
final OrientVertex targetVertex=graph.getVertex(result);
if (directionOut) vertex.addEdge(edgeClass,targetVertex);
 else targetVertex.addEdge(edgeClass,vertex);
}
}
return input;
}
