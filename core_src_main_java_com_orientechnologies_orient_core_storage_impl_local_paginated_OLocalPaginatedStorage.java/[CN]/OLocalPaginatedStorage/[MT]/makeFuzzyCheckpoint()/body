{
  if (writeAheadLog == null)   return;
  try {
    lock.acquireExclusiveLock();
    try {
      writeAheadLog.logFuzzyCheckPointStart();
      diskCache.forceSyncStoredChanges();
      diskCache.logDirtyPagesTable();
      for (      OLocalPaginatedCluster cluster : clusters)       if (cluster != null)       cluster.flushClusterState();
      writeAheadLog.logFuzzyCheckPointEnd();
      writeAheadLog.flush();
    }
  finally {
      lock.releaseExclusiveLock();
    }
  }
 catch (  IOException ioe) {
    throw new OStorageException("Error during fuzzy checkpoint creation for storage " + name,ioe);
  }
}
