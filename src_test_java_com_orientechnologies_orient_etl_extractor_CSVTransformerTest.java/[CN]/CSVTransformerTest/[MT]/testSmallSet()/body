{
  String content="name,surname,id";
  for (int i=0; i < names.length; ++i)   content+="\n" + names[i] + ","+ surnames[i]+ ","+ i;
  OETLProcessor proc=getProcessor("{source: { content: { value: '" + content + "' } }, extractor : { row: {} }, transformers: [{ csv: {} }], loader: { test: {} } }").execute();
  assertEquals(((TestLoader)proc.getLoader()).getResult().size(),names.length);
  int i=0;
  for (  Object o : ((TestLoader)proc.getLoader()).getResult()) {
    ODocument doc=(ODocument)o;
    assertEquals(doc.fields(),3);
    assertEquals(doc.field("name"),names[i]);
    assertEquals(doc.field("surname"),surnames[i]);
    assertEquals(doc.field("id"),i);
    i++;
  }
}
