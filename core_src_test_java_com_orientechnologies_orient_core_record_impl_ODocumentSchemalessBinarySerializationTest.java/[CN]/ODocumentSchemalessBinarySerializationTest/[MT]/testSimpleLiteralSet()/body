{
  ODatabaseRecordThreadLocal.INSTANCE.set(null);
  ODocument document=new ODocument();
  Set<String> strings=new HashSet<String>();
  strings.add("a");
  strings.add("b");
  strings.add("c");
  document.field("listStrings",strings);
  Set<Short> shorts=new HashSet<Short>();
  shorts.add((short)1);
  shorts.add((short)2);
  shorts.add((short)3);
  document.field("shorts",shorts);
  Set<Long> longs=new HashSet<Long>();
  longs.add((long)1);
  longs.add((long)2);
  longs.add((long)3);
  document.field("longs",longs);
  Set<Integer> ints=new HashSet<Integer>();
  ints.add(1);
  ints.add(2);
  ints.add(3);
  document.field("integers",ints);
  Set<Float> floats=new HashSet<Float>();
  floats.add(1.1f);
  floats.add(2.2f);
  floats.add(3.3f);
  document.field("floats",floats);
  Set<Double> doubles=new HashSet<Double>();
  doubles.add(1.1);
  doubles.add(2.2);
  doubles.add(3.3);
  document.field("doubles",doubles);
  Set<Date> dates=new HashSet<Date>();
  dates.add(new Date());
  Thread.sleep(1);
  dates.add(new Date());
  Thread.sleep(1);
  dates.add(new Date());
  document.field("dates",dates);
  Set<Byte> bytes=new HashSet<Byte>();
  bytes.add((byte)0);
  bytes.add((byte)1);
  bytes.add((byte)3);
  document.field("bytes",bytes);
  Set<Character> chars=new HashSet<Character>();
  chars.add('A');
  chars.add('B');
  chars.add('C');
  Set<Boolean> booleans=new HashSet<Boolean>();
  booleans.add(true);
  booleans.add(false);
  booleans.add(false);
  document.field("booleans",booleans);
  Set listMixed=new HashSet();
  listMixed.add(true);
  listMixed.add(1);
  listMixed.add((long)5);
  listMixed.add((short)2);
  listMixed.add(4.0f);
  listMixed.add(7.0D);
  listMixed.add("hello");
  listMixed.add(new Date());
  listMixed.add((byte)10);
  listMixed.add(new ORecordId(10,new OClusterPositionLong(20)));
  document.field("listMixed",listMixed);
  byte[] res=serializer.toStream(document,false);
  ODocument extr=(ODocument)serializer.fromStream(res,new ODocument(),new String[]{});
  assertEquals(extr.fields(),document.fields());
  assertEquals(extr.field("listStrings"),document.field("listStrings"));
  assertEquals(extr.field("integers"),document.field("integers"));
  assertEquals(extr.field("doubles"),document.field("doubles"));
  assertEquals(extr.field("dates"),document.field("dates"));
  assertEquals(extr.field("bytes"),document.field("bytes"));
  assertEquals(extr.field("booleans"),document.field("booleans"));
  assertEquals(extr.field("listMixed"),document.field("listMixed"));
}
