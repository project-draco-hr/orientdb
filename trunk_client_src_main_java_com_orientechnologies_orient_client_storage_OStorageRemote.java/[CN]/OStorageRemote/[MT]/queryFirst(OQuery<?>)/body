{
  checkDatabase();
  if (!(iQuery instanceof OSerializableStream))   throw new OQueryExecutionException("Can't serialize the query to being executed to the server side.");
  OSerializableStream query=(OSerializableStream)iQuery;
  do {
    boolean locked=acquireExclusiveLock();
    try {
      if (iQuery instanceof OSQLQuery<?>) {
        network.writeByte(OChannelBinaryProtocol.QUERY_FIRST);
        network.writeBytes(query.toStream());
        network.flush();
        readStatus();
        ORecordSchemaAware<?> record=((ORecordSchemaAware<?>)((OQueryInternal<?>)iQuery).getRecordClass().newInstance());
        return (ORecordSchemaAware<?>)record.fill(iQuery.getDatabase(),network.readShort(),network.readShort(),network.readLong(),network.readInt()).fromStream(network.readBytes());
      }
    }
 catch (    Exception e) {
      if (handleException("Error on executing query: " + ((OSQLQuery<?>)iQuery).text(),e))       break;
    }
 finally {
      releaseExclusiveLock(locked);
    }
  }
 while (true);
  return null;
}
