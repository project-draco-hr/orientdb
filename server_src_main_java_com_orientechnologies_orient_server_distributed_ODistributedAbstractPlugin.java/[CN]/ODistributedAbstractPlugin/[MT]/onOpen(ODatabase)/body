{
  final String dbDirectory=serverInstance.getDatabaseDirectory();
  final String dbUrl=OSystemVariableResolver.resolveSystemVariables(iDatabase.getURL());
  if (!dbUrl.substring(dbUrl.indexOf(":") + 1).startsWith(dbDirectory))   return;
synchronized (cachedDatabaseConfiguration) {
    final ODistributedConfiguration cfg=getDatabaseConfiguration(iDatabase.getName());
    if (cfg == null)     return;
    if (cfg.isReplicationActive(null)) {
      if (iDatabase instanceof ODatabaseComplex<?> && !(iDatabase.getStorage() instanceof ODistributedStorage))       ((ODatabaseComplex<?>)iDatabase).replaceStorage(new ODistributedStorage(serverInstance,(OStorageEmbedded)((ODatabaseComplex<?>)iDatabase).getStorage()));
    }
  }
}
