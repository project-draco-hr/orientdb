{
  if (iTargetVertex == null)   throw new IllegalArgumentException("Missed the target vertex");
  final OGraphEdge edge=new OGraphEdge(database,iClassName,this,iTargetVertex);
  getOutEdges().add(edge);
  List<ODocument> recordEdges=((List<ODocument>)document.field(FIELD_OUT_EDGES));
  if (recordEdges == null) {
    recordEdges=new ArrayList<ODocument>();
    document.field(FIELD_OUT_EDGES,recordEdges);
  }
  recordEdges.add(edge.getDocument());
  document.setDirty();
  iTargetVertex.getInEdges().add(edge);
  recordEdges=((List<ODocument>)iTargetVertex.getDocument().field(FIELD_IN_EDGES));
  if (recordEdges == null) {
    recordEdges=new ArrayList<ODocument>();
    iTargetVertex.getDocument().field(FIELD_IN_EDGES,recordEdges);
  }
  recordEdges.add(edge.getDocument());
  iTargetVertex.getDocument().setDirty();
  return edge;
}
