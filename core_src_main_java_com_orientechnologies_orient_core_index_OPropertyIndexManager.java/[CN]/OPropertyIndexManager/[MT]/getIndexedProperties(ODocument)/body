{
  final ORecordSchemaAware<?> record=iRecord;
  final OClass cls=record.getSchemaClass();
  if (cls == null)   return null;
  OPropertyIndex index;
  Object fieldValue;
  Map<OProperty,Object> indexedProperties=null;
  for (  OProperty prop : cls.properties()) {
    index=prop.getIndex();
    if (index != null) {
      if (prop.getType() == OType.LINK)       fieldValue=record.field(prop.getName(),OType.LINK);
 else       fieldValue=record.field(prop.getName());
      if (fieldValue != null) {
        if (indexedProperties == null)         indexedProperties=new HashMap<OProperty,Object>();
        indexedProperties.put(prop,fieldValue);
      }
    }
  }
  return indexedProperties;
}
