{
  checkForRebuild();
  if (operationDocument == null)   return;
  acquireExclusiveLock();
  try {
    final IndexTxSnapshot indexTxSnapshot=txSnapshot.get();
    final Boolean clearAll=operationDocument.field("clear");
    if (clearAll != null && clearAll)     clearSnapshot(indexTxSnapshot);
    final Collection<ODocument> entries=operationDocument.field("entries");
    final Map<Object,Object> snapshot=indexTxSnapshot.indexSnapshot;
    for (    final ODocument entry : entries)     applyIndexTxEntry(snapshot,entry);
    final ODocument nullIndexEntry=operationDocument.field("nullEntries");
    applyIndexTxEntry(snapshot,nullIndexEntry);
  }
  finally {
    releaseExclusiveLock();
  }
}
