{
  if (document != null)   return;
  document=iSource;
  try {
    final Number modeField=document.field("mode");
    mode=modeField == null ? ALLOW_MODES.DENY_ALL_BUT : modeField.byteValue() == STREAM_ALLOW ? ALLOW_MODES.ALLOW_ALL_BUT : ALLOW_MODES.DENY_ALL_BUT;
  }
 catch (  Exception ex) {
    OLogManager.instance().error(this,"illegal mode " + ex.getMessage());
    mode=ALLOW_MODES.DENY_ALL_BUT;
  }
  final OIdentifiable role=document.field("inheritedRole");
  parentRole=role != null ? document.getDatabase().getMetadata().getSecurity().getRole(role) : null;
  final Map<String,Number> storedRules=document.field("rules");
  if (storedRules != null)   for (  Entry<String,Number> a : storedRules.entrySet()) {
    rules.put(a.getKey().toLowerCase(),a.getValue().byteValue());
  }
  if (getName().equals("admin") && !hasRule(ODatabaseSecurityResources.BYPASS_RESTRICTED))   addRule(ODatabaseSecurityResources.BYPASS_RESTRICTED,ORole.PERMISSION_ALL).save();
}
