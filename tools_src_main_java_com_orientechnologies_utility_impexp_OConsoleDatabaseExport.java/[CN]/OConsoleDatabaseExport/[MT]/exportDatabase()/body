{
  try {
    exportInfo();
    exportAllClusters();
    exportSchema();
    exportRecords();
    exportDictionary();
    listener.onMessage("\nExport of database completed.");
    writer.flush();
  }
 catch (  Exception e) {
    throw new ODatabaseExportException("Error on exporting database '" + database.getName() + " to: "+ fileName,e);
  }
 finally {
    close();
  }
  return this;
}
