{
  iRequest.getDatabase().checkSecurity(ODatabaseSecurityResources.COMMAND,ORole.PERMISSION_CREATE);
  init(iRequest.getDatabase(),iRequest.getText());
  privilege=ORole.PERMISSION_NONE;
  resource=null;
  role=null;
  StringBuilder word=new StringBuilder();
  int oldPos=0;
  int pos=OSQLHelper.nextWord(text,textUpperCase,oldPos,word,true);
  if (pos == -1 || !word.toString().equals(KEYWORD_GRANT))   throw new OCommandSQLParsingException("Keyword " + KEYWORD_GRANT + " not found",text,oldPos);
  pos=OSQLHelper.nextWord(text,textUpperCase,pos,word,true);
  if (pos == -1)   throw new OCommandSQLParsingException("Invalid privilege",text,oldPos);
  parsePrivilege(word,oldPos);
  pos=OSQLHelper.nextWord(text,textUpperCase,pos,word,true);
  if (pos == -1 || !word.toString().equals(KEYWORD_ON))   throw new OCommandSQLParsingException("Keyword " + KEYWORD_ON + " not found",text,oldPos);
  pos=OSQLHelper.nextWord(text,text,pos,word,true);
  if (pos == -1)   throw new OCommandSQLParsingException("Invalid resource",text,oldPos);
  resource=word.toString();
  pos=OSQLHelper.nextWord(text,textUpperCase,pos,word,true);
  if (pos == -1 || !word.toString().equals(KEYWORD_TO))   throw new OCommandSQLParsingException("Keyword " + KEYWORD_TO + " not found",text,oldPos);
  pos=OSQLHelper.nextWord(text,text,pos,word,true);
  if (pos == -1)   throw new OCommandSQLParsingException("Invalid role",text,oldPos);
  final String roleName=word.toString();
  role=database.getMetadata().getSecurity().getRole(roleName);
  if (role == null)   throw new OCommandSQLParsingException("Invalid role: " + roleName);
  return this;
}
