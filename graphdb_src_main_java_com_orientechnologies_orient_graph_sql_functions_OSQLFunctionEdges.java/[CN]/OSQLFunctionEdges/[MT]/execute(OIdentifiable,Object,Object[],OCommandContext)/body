{
  final OrientBaseGraph graph=OGraphCommandExecutorSQLFactory.getGraph();
  final Direction direction=Direction.valueOf(OStringSerializerHelper.getStringContent(iParameters[0].toString().toUpperCase()));
  final String[] labels;
  if (iParameters.length > 1 && iParameters[1] != null)   labels=OMultiValue.array(iParameters[1],String.class);
 else   labels=null;
  if (iCurrentRecord == null) {
    return OSQLEngine.foreachRecord(new OCallable<Object,OIdentifiable>(){
      @Override public Object call(      final OIdentifiable iArgument){
        return getEdges(graph,iArgument,direction,labels);
      }
    }
,iCurrentResult,iContext);
  }
 else   return getEdges(graph,iCurrentRecord.getRecord(),direction,labels);
}
