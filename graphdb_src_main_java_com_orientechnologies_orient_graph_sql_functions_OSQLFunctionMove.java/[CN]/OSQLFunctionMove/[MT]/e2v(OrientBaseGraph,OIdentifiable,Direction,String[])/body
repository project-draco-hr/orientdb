{
  final ODocument rec=iRecord.getRecord();
  if (ODocumentInternal.getImmutableSchemaClass(rec) != null)   if (ODocumentInternal.getImmutableSchemaClass(rec).isSubClassOf(OrientEdgeType.CLASS_NAME)) {
    final OrientEdge edge=graph.getEdge(rec);
    if (edge != null) {
      if (Direction.BOTH.equals(iDirection)) {
        Set<Vertex> result=new HashSet<Vertex>();
        result.add(edge.getVertex(Direction.OUT));
        result.add(edge.getVertex(Direction.IN));
        return result;
      }
 else {
        final OrientVertex out=(OrientVertex)edge.getVertex(iDirection);
        return out;
      }
    }
  }
  return null;
}
