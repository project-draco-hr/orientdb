{
  OClass cls=ODatabaseRecordThreadLocal.INSTANCE.get().getMetadata().getSchema().getClass(DISTRIBUTED_CONFLICT_CLASS);
  if (cls == null) {
    cls=ODatabaseRecordThreadLocal.INSTANCE.get().getMetadata().getSchema().createClass(DISTRIBUTED_CONFLICT_CLASS);
    cls.createProperty("record",OType.LINK).createIndex(INDEX_TYPE.UNIQUE);
  }
  final ODocument doc=new ODocument(DISTRIBUTED_CONFLICT_CLASS);
  doc.field("operation",iOperation);
  doc.field("date",new Date());
  doc.field("record",iRecord.getIdentity());
  return doc;
}
