{
  ODatabaseRecordThreadLocal.INSTANCE.set(iDatabase);
  this.url=iDatabase.getURL();
synchronized (this) {
    OrientGraphContext context=threadContext.get();
    if (context == null || !context.rawGraph.getName().equals(iDatabase.getName()) || context.rawGraph.isClosed()) {
      removeContext();
      context=new OrientGraphContext();
      context.rawGraph=iDatabase;
      threadContext.set(context);
      contexts.add(context);
    }
  }
  return this;
}
