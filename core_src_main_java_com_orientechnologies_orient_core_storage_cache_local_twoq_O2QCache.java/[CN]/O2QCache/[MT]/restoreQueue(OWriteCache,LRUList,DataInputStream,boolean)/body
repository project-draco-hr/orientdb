{
  final OModifiableBoolean cacheHit=new OModifiableBoolean();
  long fileId=dataInputStream.readLong();
  while (fileId >= 0) {
    final long pageIndex=dataInputStream.readLong();
    try {
      final OCacheEntry cacheEntry;
      if (loadPages) {
        if (!writeCache.isOpen(fileId))         writeCache.openFile(fileId);
        final OCachePointer[] pointers=writeCache.load(fileId,pageIndex,1,false,cacheHit);
        if (pointers.length == 0)         continue;
        final OCachePointer cachePointer=pointers[0];
        cacheEntry=new OCacheEntry(fileId,pageIndex,cachePointer,false);
      }
 else {
        cacheEntry=new OCacheEntry(fileId,pageIndex,null,false);
      }
      queue.putToMRU(cacheEntry);
    }
  finally {
      fileId=dataInputStream.readLong();
    }
  }
}
