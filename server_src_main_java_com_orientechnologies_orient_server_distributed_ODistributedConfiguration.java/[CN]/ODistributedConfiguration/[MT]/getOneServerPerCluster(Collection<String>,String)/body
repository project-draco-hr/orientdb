{
synchronized (configuration) {
    if (iClusterNames == null || iClusterNames.isEmpty())     iClusterNames=Collections.singleton("*");
    final Set<String> partitions=new HashSet<String>(iClusterNames.size());
    for (    String p : iClusterNames) {
      final List<String> serverList=getClusterConfiguration(p).field("servers");
      if (serverList != null) {
        boolean found=false;
        for (        String s : serverList)         if (s.equals(iLocalNode)) {
          partitions.add(s);
          found=true;
          break;
        }
        if (!found)         for (        String s : serverList)         if (partitions.contains(s)) {
          found=true;
          break;
        }
        if (!found)         for (        String s : serverList)         if (!s.equals(NEW_NODE_TAG)) {
          partitions.add(s);
          break;
        }
      }
    }
    return partitions;
  }
}
