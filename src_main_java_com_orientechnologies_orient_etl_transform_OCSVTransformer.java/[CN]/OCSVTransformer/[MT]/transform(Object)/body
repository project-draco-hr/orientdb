{
  if (input == null)   return null;
  final List<String> fields=OStringSerializerHelper.smartSplit(input.toString(),new char[]{separator},0,-1,false,false,false,false);
  if (columns == null) {
    if (!columnsOnFirstLine)     throw new OTransformException("CSV: columnsOnFirstLine=false and no columns declared");
    columns=fields;
    return null;
  }
  final ODocument doc=new ODocument();
  for (int i=0; i < columns.size(); ++i)   doc.field(columns.get(i),fields.get(i));
  return doc;
}
